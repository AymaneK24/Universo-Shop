import './polyfills.server.mjs';
import{$ as dd,$a as iv,A as Se,B as Ne,Ba as Yy,C as Vt,D as ve,Da as fd,E as Bt,Ea as Xy,F as Qe,G as so,Ga as pd,H as oo,Ha as mo,I as ao,Ia as hr,J as gt,Ja as Jy,K as yt,Ka as md,L as ii,M as Bi,Ma as $a,N as Ui,Na as St,O as Zt,Oa as fr,P as lo,Pa as Zy,Q as si,Qa as ev,R as dr,Ra as pr,S as Wy,Sa as gd,T as V,Ta as tv,U as Q,Ua as nv,V as co,W as oi,X as kt,Xa as rv,Y as we,Z as ud,_ as ie,a as yn,aa as ai,ab as sv,b as Ua,ba as b,c as ni,ca as E,cb as Ye,d as Vy,da as j,db as Cn,e as By,ea as en,eb as Sn,f as ur,fa as he,fb as yd,g as ri,ga as Ie,gb as Ut,h as Rt,ha as qi,i as $n,ia as w,j as Wn,ja as We,k as qa,ka as le,l as Uy,la as Hy,m as qy,ma as uo,n as ad,na as ho,o as zy,oa as fo,p as jy,pa as _n,q as Gy,qa as _e,r as ld,ra as ja,s as Jt,sa as Ky,t as cd,ta as Ga,u as $y,ua as hd,v as za,va as po,w as vn,x as st,xa as Qy,y as Lt,z as Oe}from"./chunk-72TWK2C6.mjs";import{a as ov,b as vd,c as av,d as lv,e as _d,f as cv,g as uv,h as Hn,i as go,j as Kn,k as Wa,l as yo,m as dv,n as hv,o as Ha,p as Ka,q as He,r as YT,s as Cd,t as Sd,u as bd,v as Qa,w as Ed,x as wd,y as tn}from"./chunk-PIQHMBDN.mjs";import{a as mt,b as xt,c as pe,f as D,h as od,j as R}from"./chunk-EXD34EPT.mjs";var fe=D(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=qt.DEFAULT_MAX_SEND_MESSAGE_LENGTH=qt.Propagate=qt.LogVerbosity=qt.Status=void 0;var p0=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n}(p0||(qt.Status=p0={})),m0=function(n){return n[n.DEBUG=0]="DEBUG",n[n.INFO=1]="INFO",n[n.ERROR=2]="ERROR",n[n.NONE=3]="NONE",n}(m0||(qt.LogVerbosity=m0={})),g0=function(n){return n[n.DEADLINE=1]="DEADLINE",n[n.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",n[n.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",n[n.CANCELLATION=8]="CANCELLATION",n[n.DEFAULTS=65535]="DEFAULTS",n}(g0||(qt.Propagate=g0={}));qt.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;qt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var Hd=D((Wq,q1)=>{q1.exports={name:"@grpc/grpc-js",version:"1.9.15",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var Fe=D(vt=>{"use strict";var Kd,Qd,Yd,Xd;Object.defineProperty(vt,"__esModule",{value:!0});vt.isTracerEnabled=vt.trace=vt.log=vt.setLoggerVerbosity=vt.setLogger=vt.getLogger=void 0;var Sr=fe(),z1=pe("process"),j1=Hd().version,G1={error:(n,...e)=>{console.error("E "+n,...e)},info:(n,...e)=>{console.error("I "+n,...e)},debug:(n,...e)=>{console.error("D "+n,...e)}},fi=G1,Xi=Sr.LogVerbosity.ERROR,$1=(Qd=(Kd=process.env.GRPC_NODE_VERBOSITY)!==null&&Kd!==void 0?Kd:process.env.GRPC_VERBOSITY)!==null&&Qd!==void 0?Qd:"";switch($1.toUpperCase()){case"DEBUG":Xi=Sr.LogVerbosity.DEBUG;break;case"INFO":Xi=Sr.LogVerbosity.INFO;break;case"ERROR":Xi=Sr.LogVerbosity.ERROR;break;case"NONE":Xi=Sr.LogVerbosity.NONE;break;default:}var W1=()=>fi;vt.getLogger=W1;var H1=n=>{fi=n};vt.setLogger=H1;var K1=n=>{Xi=n};vt.setLoggerVerbosity=K1;var Q1=(n,...e)=>{let t;if(n>=Xi){switch(n){case Sr.LogVerbosity.DEBUG:t=fi.debug;break;case Sr.LogVerbosity.INFO:t=fi.info;break;case Sr.LogVerbosity.ERROR:t=fi.error;break}t||(t=fi.error),t&&t.bind(fi)(...e)}};vt.log=Q1;var Y1=(Xd=(Yd=process.env.GRPC_NODE_TRACE)!==null&&Yd!==void 0?Yd:process.env.GRPC_TRACE)!==null&&Xd!==void 0?Xd:"",Jd=new Set,y0=new Set;for(let n of Y1.split(","))n.startsWith("-")?y0.add(n.substring(1)):Jd.add(n);var X1=Jd.has("all");function J1(n,e,t){v0(e)&&(0,vt.log)(n,new Date().toISOString()+" | v"+j1+" "+z1.pid+" | "+e+" | "+t)}vt.trace=J1;function v0(n){return!y0.has(n)&&(X1||Jd.has(n))}vt.isTracerEnabled=v0});var vl=D(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.getErrorCode=Ji.getErrorMessage=void 0;function Z1(n){return n instanceof Error?n.message:String(n)}Ji.getErrorMessage=Z1;function eI(n){return typeof n=="object"&&n!==null&&"code"in n&&typeof n.code=="number"?n.code:null}Ji.getErrorCode=eI});var wt=D(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.Metadata=void 0;var tI=Fe(),nI=fe(),rI=vl(),iI=/^[0-9a-z_.-]+$/,sI=/^[ -~]*$/;function oI(n){return iI.test(n)}function aI(n){return sI.test(n)}function C0(n){return n.endsWith("-bin")}function lI(n){return!n.startsWith("grpc-")}function _l(n){return n.toLowerCase()}function _0(n,e){if(!oI(n))throw new Error('Metadata key "'+n+'" contains illegal characters');if(e!=null)if(C0(n)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!aI(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var Zd=class n{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){e=_l(e),_0(e,t),this.internalRepr.set(e,[t])}add(e,t){e=_l(e),_0(e,t);let r=this.internalRepr.get(e);r===void 0?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=_l(e),this.internalRepr.delete(e)}get(e){return e=_l(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let i=r[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new n(this.options),t=e.internalRepr;for(let[r,i]of this.internalRepr){let s=i.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);t.set(r,s)}return e}merge(e){for(let[t,r]of e.internalRepr){let i=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(cI);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new n;for(let r of Object.keys(e)){if(r.charAt(0)===":")continue;let i=e[r];try{C0(r)?Array.isArray(i)?i.forEach(s=>{t.add(r,Buffer.from(s,"base64"))}):i!==void 0&&(lI(r)?i.split(",").forEach(s=>{t.add(r,Buffer.from(s.trim(),"base64"))}):t.add(r,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{t.add(r,s)}):i!==void 0&&t.add(r,i)}catch(s){let o=`Failed to add metadata entry ${r}: ${i}. ${(0,rI.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,tI.log)(nI.LogVerbosity.ERROR,o)}}return t}};Cl.Metadata=Zd;var cI=n=>Buffer.isBuffer(n)?n.toString("base64"):n});var ih=D(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.CallCredentials=void 0;var rh=wt();function uI(n){return"getRequestHeaders"in n&&typeof n.getRequestHeaders=="function"}var Zi=class n{static createFromMetadataGenerator(e){return new th(e)}static createFromGoogleCredential(e){return n.createFromMetadataGenerator((t,r)=>{let i;uI(e)?i=e.getRequestHeaders(t.service_url):i=new Promise((s,o)=>{e.getRequestMetadata(t.service_url,(a,l)=>{if(a){o(a);return}if(!l){o(new Error("Headers not set by metadata plugin"));return}s(l)})}),i.then(s=>{let o=new rh.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);r(null,o)},s=>{r(s)})})}static createEmpty(){return new nh}};Sl.CallCredentials=Zi;var eh=class n extends Zi{constructor(e){super(),this.creds=e}generateMetadata(e){return R(this,null,function*(){let t=new rh.Metadata,r=yield Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of r)t.merge(i);return t})}compose(e){return new n(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof n?this.creds.every((t,r)=>t._equals(e.creds[r])):!1}},th=class n extends Zi{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?t(s):r(i)})})}compose(e){return new eh([this,e])}_equals(e){return this===e?!0:e instanceof n?this.metadataGenerator===e.metadataGenerator:!1}},nh=class n extends Zi{generateMetadata(e){return Promise.resolve(new rh.Metadata)}compose(e){return e}_equals(e){return e instanceof n}}});var oh=D(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.getDefaultRootsData=es.CIPHER_SUITES=void 0;var dI=pe("fs");es.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var S0=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,sh=null;function hI(){return S0?(sh===null&&(sh=dI.readFileSync(S0)),sh):null}es.getDefaultRootsData=hI});var wl=D(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.ChannelCredentials=void 0;var fI=pe("tls"),pI=ih(),b0=oh();function ah(n,e){if(n&&!(n instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var ts=class{constructor(e){this.callCredentials=e||pI.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,i){var s;if(ah(e,"Root certificate"),ah(t,"Private key"),ah(r,"Certificate chain"),t&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,fI.createSecureContext)({ca:(s=e??(0,b0.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:t??void 0,cert:r??void 0,ciphers:b0.CIPHER_SUITES});return new bl(o,i??{})}static createFromSecureContext(e,t){return new bl(e,t??{})}static createInsecure(){return new lh}};El.ChannelCredentials=ts;var lh=class n extends ts{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof n}},bl=class n extends ts{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},t?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){let t=this.callCredentials.compose(e);return new ch(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},ch=class n extends ts{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new n(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof n?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var Er=D(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.validateLoadBalancingConfig=ot.getFirstUsableConfig=ot.isLoadBalancerNameRegistered=ot.createLoadBalancer=ot.registerDefaultLoadBalancerType=ot.registerLoadBalancerType=ot.createChildChannelControlHelper=void 0;function mI(n,e){var t,r,i,s,o,a,l,c,u,p;return{createSubchannel:(r=(t=e.createSubchannel)===null||t===void 0?void 0:t.bind(e))!==null&&r!==void 0?r:n.createSubchannel.bind(n),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:n.updateState.bind(n),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:n.requestReresolution.bind(n),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:n.addChannelzChild.bind(n),removeChannelzChild:(p=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&p!==void 0?p:n.removeChannelzChild.bind(n)}}ot.createChildChannelControlHelper=mI;var br={},uh=null;function gI(n,e,t){br[n]={LoadBalancer:e,LoadBalancingConfig:t}}ot.registerLoadBalancerType=gI;function yI(n){uh=n}ot.registerDefaultLoadBalancerType=yI;function vI(n,e){let t=n.getLoadBalancerName();return t in br?new br[t].LoadBalancer(e):null}ot.createLoadBalancer=vI;function _I(n){return n in br}ot.isLoadBalancerNameRegistered=_I;function CI(n,e=!1){for(let t of n)if(t.getLoadBalancerName()in br)return t;return e&&uh?new br[uh].LoadBalancingConfig:null}ot.getFirstUsableConfig=CI;function SI(n){if(!(n!==null&&typeof n=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(n);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let t=e[0];if(t in br)return br[t].LoadBalancingConfig.createFromJson(n[t]);throw new Error(`Unrecognized load balancing config name ${t}`)}ot.validateLoadBalancingConfig=SI});var dh=D(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.extractAndSelectServiceConfig=wr.validateServiceConfig=wr.validateRetryThrottling=void 0;var bI=pe("os"),Tl=fe(),EI=Er(),Al=/^\d+(\.\d{1,9})?s$/,wI="node";function TI(n){if("service"in n&&n.service!==""){if(typeof n.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof n.service}`);if("method"in n&&n.method!==""){if(typeof n.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof n.service}`);return{service:n.service,method:n.method}}else return{service:n.service}}else{if("method"in n&&n.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function AI(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in n)||typeof n.initialBackoff!="string"||!Al.test(n.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in n)||typeof n.maxBackoff!="string"||!Al.test(n.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in n)||typeof n.backoffMultiplier!="number"||n.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in n&&Array.isArray(n.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(n.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of n.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(Tl.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(Tl.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:n.maxAttempts,initialBackoff:n.initialBackoff,maxBackoff:n.maxBackoff,backoffMultiplier:n.backoffMultiplier,retryableStatusCodes:n.retryableStatusCodes}}function II(n){if(!("maxAttempts"in n)||!Number.isInteger(n.maxAttempts)||n.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in n&&(typeof n.hedgingDelay!="string"||!Al.test(n.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in n&&Array.isArray(n.nonFatalStatusCodes))for(let t of n.nonFatalStatusCodes)if(typeof t=="number"){if(!Object.values(Tl.Status).includes(t))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof t=="string"){if(!Object.values(Tl.Status).includes(t.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:n.maxAttempts};return n.hedgingDelay&&(e.hedgingDelay=n.hedgingDelay),n.nonFatalStatusCodes&&(e.nonFatalStatusCodes=n.nonFatalStatusCodes),e}function DI(n){var e;let t={name:[]};if(!("name"in n)||!Array.isArray(n.name))throw new Error("Invalid method config: invalid name array");for(let r of n.name)t.name.push(TI(r));if("waitForReady"in n){if(typeof n.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");t.waitForReady=n.waitForReady}if("timeout"in n)if(typeof n.timeout=="object"){if(!("seconds"in n.timeout)||typeof n.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in n.timeout)||typeof n.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");t.timeout=n.timeout}else if(typeof n.timeout=="string"&&Al.test(n.timeout)){let r=n.timeout.substring(0,n.timeout.length-1).split(".");t.timeout={seconds:r[0]|0,nanos:((e=r[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in n){if(typeof n.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxRequestBytes=n.maxRequestBytes}if("maxResponseBytes"in n){if(typeof n.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");t.maxResponseBytes=n.maxResponseBytes}if("retryPolicy"in n){if("hedgingPolicy"in n)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");t.retryPolicy=AI(n.retryPolicy)}else"hedgingPolicy"in n&&(t.hedgingPolicy=II(n.hedgingPolicy));return t}function E0(n){if(!("maxTokens"in n)||typeof n.maxTokens!="number"||n.maxTokens<=0||n.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in n)||typeof n.tokenRatio!="number"||n.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+n.maxTokens.toFixed(3),tokenRatio:+n.tokenRatio.toFixed(3)}}wr.validateRetryThrottling=E0;function w0(n){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in n)if(typeof n.loadBalancingPolicy=="string")e.loadBalancingPolicy=n.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in n)if(Array.isArray(n.loadBalancingConfig))for(let r of n.loadBalancingConfig)e.loadBalancingConfig.push((0,EI.validateLoadBalancingConfig)(r));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in n&&Array.isArray(n.methodConfig))for(let r of n.methodConfig)e.methodConfig.push(DI(r));"retryThrottling"in n&&(e.retryThrottling=E0(n.retryThrottling));let t=[];for(let r of e.methodConfig)for(let i of r.name){for(let s of t)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);t.push(i)}return e}wr.validateServiceConfig=w0;function xI(n){if(!("serviceConfig"in n))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:w0(n.serviceConfig)};if("clientLanguage"in n)if(Array.isArray(n.clientLanguage)){e.clientLanguage=[];for(let r of n.clientLanguage)if(typeof r=="string")e.clientLanguage.push(r);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in n)if(Array.isArray(n.clientHostname)){e.clientHostname=[];for(let r of n.clientHostname)if(typeof r=="string")e.clientHostname.push(r);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in n)if(typeof n.percentage=="number"&&0<=n.percentage&&n.percentage<=100)e.percentage=n.percentage;else throw new Error("Invalid service config choice: invalid percentage");let t=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let r in n)if(!t.includes(r))throw new Error(`Invalid service config choice: unexpected field ${r}`);return e}function RI(n,e){if(!Array.isArray(n))throw new Error("Invalid service config list");for(let t of n){let r=xI(t);if(!(typeof r.percentage=="number"&&e>r.percentage)){if(Array.isArray(r.clientHostname)){let i=!1;for(let s of r.clientHostname)s===bI.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(r.clientLanguage)){let i=!1;for(let s of r.clientLanguage)s===wI&&(i=!0);if(!i)continue}return r.serviceConfig}}throw new Error("No matching service config found")}function kI(n,e){for(let t of n)if(t.length>0&&t[0].startsWith("grpc_config=")){let r=t.join("").substring(12),i=JSON.parse(r);return RI(i,e)}return null}wr.extractAndSelectServiceConfig=kI});var zt=D(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.ConnectivityState=void 0;var T0=function(n){return n[n.IDLE=0]="IDLE",n[n.CONNECTING=1]="CONNECTING",n[n.READY=2]="READY",n[n.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",n[n.SHUTDOWN=4]="SHUTDOWN",n}(T0||(Il.ConnectivityState=T0={}))});var Ot=D(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.uriToString=Tr.splitHostPort=Tr.parseUri=void 0;var OI=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function MI(n){let e=OI.exec(n);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}Tr.parseUri=MI;var A0=/^\d+$/;function PI(n){if(n.startsWith("[")){let e=n.indexOf("]");if(e===-1)return null;let t=n.substring(1,e);if(t.indexOf(":")===-1)return null;if(n.length>e+1)if(n[e+1]===":"){let r=n.substring(e+2);return A0.test(r)?{host:t,port:+r}:null}else return null;else return{host:t}}else{let e=n.split(":");return e.length===2?A0.test(e[1])?{host:e[0],port:+e[1]}:null:{host:n}}}Tr.splitHostPort=PI;function NI(n){let e="";return n.scheme!==void 0&&(e+=n.scheme+":"),n.authority!==void 0&&(e+="//"+n.authority+"/"),e+=n.path,e}Tr.uriToString=NI});var wn=D(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.mapUriDefaultScheme=jt.getDefaultAuthority=jt.createResolver=jt.registerDefaultScheme=jt.registerResolver=void 0;var fh=Ot(),ns={},hh=null;function FI(n,e){ns[n]=e}jt.registerResolver=FI;function LI(n){hh=n}jt.registerDefaultScheme=LI;function VI(n,e,t){if(n.scheme!==void 0&&n.scheme in ns)return new ns[n.scheme](n,e,t);throw new Error(`No resolver could be created for target ${(0,fh.uriToString)(n)}`)}jt.createResolver=VI;function BI(n){if(n.scheme!==void 0&&n.scheme in ns)return ns[n.scheme].getDefaultAuthority(n);throw new Error(`Invalid target ${(0,fh.uriToString)(n)}`)}jt.getDefaultAuthority=BI;function UI(n){return n.scheme===void 0||!(n.scheme in ns)?hh!==null?{scheme:hh,authority:void 0,path:(0,fh.uriToString)(n)}:null:n}jt.mapUriDefaultScheme=UI});var Ir=D(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.QueuePicker=Ar.UnavailablePicker=Ar.PickResultType=void 0;var qI=wt(),zI=fe(),Dl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.QUEUE=1]="QUEUE",n[n.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",n[n.DROP=3]="DROP",n}(Dl||(Ar.PickResultType=Dl={})),ph=class{constructor(e){this.status=Object.assign({code:zI.Status.UNAVAILABLE,details:"No connection established",metadata:new qI.Metadata},e)}pick(e){return{pickResultType:Dl.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Ar.UnavailablePicker=ph;var mh=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:Dl.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Ar.QueuePicker=mh});var xo=D(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});xl.BackoffTimeout=void 0;var jI=1e3,GI=1.6,$I=12e4,WI=.2;function HI(n,e){return Math.random()*(e-n)+n}var gh=class{constructor(e,t){this.callback=e,this.initialDelay=jI,this.multiplier=GI,this.maxDelay=$I,this.jitter=WI,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(r=(t=this.timerId).unref)===null||r===void 0||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+HI(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,(t=(e=this.timerId).ref)===null||t===void 0||t.call(e)}unref(){var e,t;this.hasRef=!1,(t=(e=this.timerId).unref)===null||t===void 0||t.call(e)}getEndTime(){return this.endTime}};xl.BackoffTimeout=gh});var kl=D(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.ChildLoadBalancerHandler=void 0;var KI=Er(),QI=zt(),YI="child_load_balancer_helper",yh=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(t){this.parent=t,this.child=null}createSubchannel(t,r){return this.parent.channelControlHelper.createSubchannel(t,r)}updateState(t,r){var i;if(this.calledByPendingChild()){if(t===QI.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(t,r)}requestReresolution(){var t;let r=(t=this.parent.pendingChild)!==null&&t!==void 0?t:this.parent.currentChild;this.child===r&&this.parent.channelControlHelper.requestReresolution()}setChild(t){this.child=t}addChannelzChild(t){this.parent.channelControlHelper.addChannelzChild(t)}removeChannelzChild(t){this.parent.channelControlHelper.removeChannelzChild(t)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let s=new this.ChildPolicyHelper(this),o=(0,KI.createLoadBalancer)(t,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;this.latestConfig=t,i.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return YI}};Rl.ChildLoadBalancerHandler=yh});var D0=D(Ol=>{"use strict";Object.defineProperty(Ol,"__esModule",{value:!0});Ol.ResolvingLoadBalancer=void 0;var XI=Er(),JI=dh(),Tt=zt(),ZI=wn(),rs=Ir(),eD=xo(),vh=fe(),tD=wt(),nD=Fe(),rD=fe(),iD=Ot(),sD=kl(),oD="resolving_load_balancer";function I0(n){nD.trace(rD.LogVerbosity.DEBUG,oD,n)}var aD=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function lD(n,e,t,r){for(let i of t.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===n&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===n&&i.method===e)return!0}return!1}function cD(n,e,t,r){for(let i of t)if(lD(n,e,i,r))return i;return null}function uD(n){return function(t,r){var i,s;let o=t.split("/").filter(c=>c.length>0),a=(i=o[0])!==null&&i!==void 0?i:"",l=(s=o[1])!==null&&s!==void 0?s:"";if(n&&n.methodConfig)for(let c of aD){let u=cD(a,l,n.methodConfig,c);if(u)return{methodConfig:u,pickInformation:{},status:vh.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:vh.Status.OK,dynamicFilterFactories:[]}}}var _h=class{constructor(e,t,r,i,s){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=Tt.ConnectivityState.IDLE,this.latestChildPicker=new rs.QueuePicker(this),this.currentState=Tt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,JI.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Tt.ConnectivityState.IDLE,new rs.QueuePicker(this)),this.childLoadBalancer=new sD.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(I0("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,l)=>{this.latestChildState=a,this.latestChildPicker=l,this.updateState(a,l)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,ZI.createResolver)(e,{onSuccessfulResolution:(a,l,c,u,p)=>{var g;this.backoffTimeout.stop(),this.backoffTimeout.reset();let C=null;l===null?c===null?(this.previousServiceConfig=null,C=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):C=this.previousServiceConfig:(C=l,this.previousServiceConfig=l);let A=(g=C?.loadBalancingConfig)!==null&&g!==void 0?g:[],I=(0,XI.getFirstUsableConfig)(A,!0);if(I===null){this.handleResolutionFailure({code:vh.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new tD.Metadata});return}this.childLoadBalancer.updateAddressList(a,I,p);let T=C??this.defaultServiceConfig;this.onSuccessfulResolution(T,u??uD(T))},onError:a=>{this.handleResolutionFailure(a)}},r);let o={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new eD.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Tt.ConnectivityState.IDLE&&this.updateState(Tt.ConnectivityState.CONNECTING,new rs.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){I0((0,iD.uriToString)(this.target)+" "+Tt.ConnectivityState[this.currentState]+" -> "+Tt.ConnectivityState[e]),e===Tt.ConnectivityState.IDLE&&(t=new rs.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===Tt.ConnectivityState.IDLE&&(this.updateState(Tt.ConnectivityState.TRANSIENT_FAILURE,new rs.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Tt.ConnectivityState.IDLE||this.currentState===Tt.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=Tt.ConnectivityState.IDLE,this.latestChildPicker=new rs.QueuePicker(this),this.currentState=Tt.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Ol.ResolvingLoadBalancer=_h});var x0=D(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.channelOptionsEqual=is.recognizedOptions=void 0;is.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function dD(n,e){let t=Object.keys(n).sort(),r=Object.keys(e).sort();if(t.length!==r.length)return!1;for(let i=0;i<t.length;i+=1)if(t[i]!==r[i]||n[t[i]]!==e[r[i]])return!1;return!0}is.channelOptionsEqual=dD});var An=D(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.stringToSubchannelAddress=Tn.subchannelAddressToString=Tn.subchannelAddressEqual=Tn.isTcpSubchannelAddress=void 0;var hD=pe("net");function Ro(n){return"port"in n}Tn.isTcpSubchannelAddress=Ro;function fD(n,e){return!n&&!e?!0:!n||!e?!1:Ro(n)?Ro(e)&&n.host===e.host&&n.port===e.port:!Ro(e)&&n.path===e.path}Tn.subchannelAddressEqual=fD;function pD(n){return Ro(n)?n.host+":"+n.port:n.path}Tn.subchannelAddressToString=pD;var mD=443;function gD(n,e){return(0,hD.isIP)(n)?{host:n,port:e??mD}:{path:n}}Tn.stringToSubchannelAddress=gD});var Ml=D(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.addAdminServicesToServer=ss.registerAdminService=void 0;var R0=[];function yD(n,e){R0.push({getServiceDefinition:n,getHandlers:e})}ss.registerAdminService=yD;function vD(n){for(let{getServiceDefinition:e,getHandlers:t}of R0)n.addService(e(),t())}ss.addAdminServicesToServer=vD});var k0=D(Gt=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ClientDuplexStreamImpl=Gt.ClientWritableStreamImpl=Gt.ClientReadableStreamImpl=Gt.ClientUnaryCallImpl=Gt.callErrorFromStatus=void 0;var _D=pe("events"),wh=pe("stream"),ko=fe();function CD(n,e){let t=`${n.code} ${ko.Status[n.code]}: ${n.details}`,i=`${new Error(t).stack}
for call at
${e}`;return Object.assign(new Error(t),n,{stack:i})}Gt.callErrorFromStatus=CD;var Ch=class extends _D.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ko.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}};Gt.ClientUnaryCallImpl=Ch;var Sh=class extends wh.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ko.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}};Gt.ClientReadableStreamImpl=Sh;var bh=class extends wh.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ko.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Gt.ClientWritableStreamImpl=bh;var Eh=class extends wh.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ko.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0||t.startRead()}_write(e,t,r){var i;let s={callback:r},o=Number(t);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var t;(t=this.call)===null||t===void 0||t.halfClose(),e()}};Gt.ClientDuplexStreamImpl=Eh});var O0=D(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.InterceptingListenerImpl=os.isInterceptingListener=void 0;function SD(n){return n.onReceiveMetadata!==void 0&&n.onReceiveMetadata.length===1}os.isInterceptingListener=SD;var Th=class{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,t=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(t),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,t=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=t,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(t),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,t=>{this.processingMetadata||this.processingMessage?this.pendingStatus=t:this.nextListener.onReceiveStatus(t)})}};os.InterceptingListenerImpl=Th});var Oh=D($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.getInterceptingCall=$t.InterceptingCall=$t.RequesterBuilder=$t.ListenerBuilder=$t.InterceptorConfigurationError=void 0;var bD=wt(),M0=O0(),P0=fe(),N0=vl(),Mo=class n extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,n)}};$t.InterceptorConfigurationError=Mo;var Ih=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};$t.ListenerBuilder=Ih;var Dh=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};$t.RequesterBuilder=Dh;var Ah={onReceiveMetadata:(n,e)=>{e(n)},onReceiveMessage:(n,e)=>{e(n)},onReceiveStatus:(n,e)=>{e(n)}},Oo={start:(n,e,t)=>{t(n,e)},sendMessage:(n,e)=>{e(n)},halfClose:n=>{n()},cancel:n=>{n()}},xh=class{constructor(e,t){var r,i,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:(r=t.start)!==null&&r!==void 0?r:Oo.start,sendMessage:(i=t.sendMessage)!==null&&i!==void 0?i:Oo.sendMessage,halfClose:(s=t.halfClose)!==null&&s!==void 0?s:Oo.halfClose,cancel:(o=t.cancel)!==null&&o!==void 0?o:Oo.cancel}:this.requester=Oo}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,i,s,o,a,l;let c={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:u=>{},onReceiveMessage:(o=(s=t?.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:u=>{},onReceiveStatus:(l=(a=t?.onReceiveStatus)===null||a===void 0?void 0:a.bind(t))!==null&&l!==void 0?l:u=>{}};this.processingMetadata=!0,this.requester.start(e,c,(u,p)=>{var g,C,A;this.processingMetadata=!1;let I;if((0,M0.isInterceptingListener)(p))I=p;else{let T={onReceiveMetadata:(g=p.onReceiveMetadata)!==null&&g!==void 0?g:Ah.onReceiveMetadata,onReceiveMessage:(C=p.onReceiveMessage)!==null&&C!==void 0?C:Ah.onReceiveMessage,onReceiveStatus:(A=p.onReceiveStatus)!==null&&A!==void 0?A:Ah.onReceiveStatus};I=new M0.InterceptingListenerImpl(T,c)}this.nextCall.start(u,I),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};$t.InterceptingCall=xh;function ED(n,e,t){var r,i;let s=(r=t.deadline)!==null&&r!==void 0?r:1/0,o=t.host,a=(i=t.parent)!==null&&i!==void 0?i:null,l=t.propagate_flags,c=t.credentials,u=n.createCall(e,s,o,a,l);return c&&u.setCredentials(c),u}var Pl=class{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(i){this.call.cancelWithStatus(P0.Status.INTERNAL,`Request message serialization failure: ${(0,N0.getErrorMessage)(i)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=t?.onReceiveMetadata)===null||s===void 0||s.call(t,i)},onReceiveMessage:i=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(i)}catch(a){r={code:P0.Status.INTERNAL,details:`Response message parsing error: ${(0,N0.getErrorMessage)(a)}`,metadata:new bD.Metadata},this.call.cancelWithStatus(r.code,r.details);return}(s=t?.onReceiveMessage)===null||s===void 0||s.call(t,o)},onReceiveStatus:i=>{var s,o;r?(s=t?.onReceiveStatus)===null||s===void 0||s.call(t,r):(o=t?.onReceiveStatus)===null||o===void 0||o.call(t,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Rh=class extends Pl{constructor(e,t){super(e,t)}start(e,t){var r,i;let s=!1,o={onReceiveMetadata:(i=(r=t?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(t))!==null&&i!==void 0?i:a=>{},onReceiveMessage:a=>{var l;s=!0,(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,a)},onReceiveStatus:a=>{var l,c;s||(l=t?.onReceiveMessage)===null||l===void 0||l.call(t,null),(c=t?.onReceiveStatus)===null||c===void 0||c.call(t,a)}};super.start(e,o),this.call.startRead()}},kh=class extends Pl{};function wD(n,e,t){let r=ED(n,t.path,e);return t.responseStream?new kh(r,t):new Rh(r,t)}function TD(n,e,t,r){if(n.clientInterceptors.length>0&&n.clientInterceptorProviders.length>0)throw new Mo("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(n.callInterceptors.length>0&&n.callInterceptorProviders.length>0)throw new Mo("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];n.callInterceptors.length>0||n.callInterceptorProviders.length>0?i=[].concat(n.callInterceptors,n.callInterceptorProviders.map(a=>a(e))).filter(a=>a):i=[].concat(n.clientInterceptors,n.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},t,{method_definition:e});return i.reduceRight((a,l)=>c=>l(c,a),a=>wD(r,a,e))(s)}$t.getInterceptingCall=TD});var Nh=D(Fl=>{"use strict";Object.defineProperty(Fl,"__esModule",{value:!0});Fl.Client=void 0;var In=k0(),AD=Fh(),ID=zt(),Dr=fe(),as=wt(),Nl=Oh(),nn=Symbol(),ls=Symbol(),cs=Symbol(),Xn=Symbol();function Mh(n){return typeof n=="function"}function us(n){return n.stack.split(`
`).slice(1).join(`
`)}var Ph=class{constructor(e,t,r={}){var i,s;if(r=Object.assign({},r),this[ls]=(i=r.interceptors)!==null&&i!==void 0?i:[],delete r.interceptors,this[cs]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[],delete r.interceptor_providers,this[ls].length>0&&this[cs].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[Xn]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[nn]=r.channelOverride;else if(r.channelFactoryOverride){let o=r.channelFactoryOverride;delete r.channelFactoryOverride,this[nn]=o(e,t,r)}else this[nn]=new AD.ChannelImplementation(e,t,r)}close(){this[nn].close()}getChannel(){return this[nn]}waitForReady(e,t){let r=i=>{if(i){t(new Error("Failed to connect before the deadline"));return}let s;try{s=this[nn].getConnectivityState(!0)}catch{t(new Error("The channel has been closed"));return}if(s===ID.ConnectivityState.READY)t();else try{this[nn].watchConnectivityState(s,e,r)}catch{t(new Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(Mh(e))return{metadata:new as.Metadata,options:{},callback:e};if(Mh(t))return e instanceof as.Metadata?{metadata:e,options:{},callback:t}:{metadata:new as.Metadata,options:e,callback:t};if(!(e instanceof as.Metadata&&t instanceof Object&&Mh(r)))throw new Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,i,s,o,a){var l,c;let u=this.checkOptionalUnaryResponseArguments(s,o,a),p={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},g={argument:i,metadata:u.metadata,call:new In.ClientUnaryCallImpl,channel:this[nn],methodDefinition:p,callOptions:u.options,callback:u.callback};this[Xn]&&(g=this[Xn](g));let C=g.call,A={clientInterceptors:this[ls],clientInterceptorProviders:this[cs],callInterceptors:(l=g.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=g.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},I=(0,Nl.getInterceptingCall)(A,g.methodDefinition,g.callOptions,g.channel);C.call=I;let T=null,P=!1,x=new Error;return I.start(g.metadata,{onReceiveMetadata:N=>{C.emit("metadata",N)},onReceiveMessage(N){T!==null&&I.cancelWithStatus(Dr.Status.INTERNAL,"Too many responses received"),T=N},onReceiveStatus(N){if(!P){if(P=!0,N.code===Dr.Status.OK)if(T===null){let F=us(x);g.callback((0,In.callErrorFromStatus)({code:Dr.Status.INTERNAL,details:"No message received",metadata:N.metadata},F))}else g.callback(null,T);else{let F=us(x);g.callback((0,In.callErrorFromStatus)(N,F))}x=null,C.emit("status",N)}}}),I.sendMessage(i),I.halfClose(),C}makeClientStreamRequest(e,t,r,i,s,o){var a,l;let c=this.checkOptionalUnaryResponseArguments(i,s,o),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},p={metadata:c.metadata,call:new In.ClientWritableStreamImpl(t),channel:this[nn],methodDefinition:u,callOptions:c.options,callback:c.callback};this[Xn]&&(p=this[Xn](p));let g=p.call,C={clientInterceptors:this[ls],clientInterceptorProviders:this[cs],callInterceptors:(a=p.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=p.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},A=(0,Nl.getInterceptingCall)(C,p.methodDefinition,p.callOptions,p.channel);g.call=A;let I=null,T=!1,P=new Error;return A.start(p.metadata,{onReceiveMetadata:x=>{g.emit("metadata",x)},onReceiveMessage(x){I!==null&&A.cancelWithStatus(Dr.Status.INTERNAL,"Too many responses received"),I=x},onReceiveStatus(x){if(!T){if(T=!0,x.code===Dr.Status.OK)if(I===null){let N=us(P);p.callback((0,In.callErrorFromStatus)({code:Dr.Status.INTERNAL,details:"No message received",metadata:x.metadata},N))}else p.callback(null,I);else{let N=us(P);p.callback((0,In.callErrorFromStatus)(x,N))}P=null,g.emit("status",x)}}}),g}checkMetadataAndOptions(e,t){let r,i;return e instanceof as.Metadata?(r=e,t?i=t:i={}):(e?i=e:i={},r=new as.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,t,r,i,s,o){var a,l;let c=this.checkMetadataAndOptions(s,o),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},p={argument:i,metadata:c.metadata,call:new In.ClientReadableStreamImpl(r),channel:this[nn],methodDefinition:u,callOptions:c.options};this[Xn]&&(p=this[Xn](p));let g=p.call,C={clientInterceptors:this[ls],clientInterceptorProviders:this[cs],callInterceptors:(a=p.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=p.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},A=(0,Nl.getInterceptingCall)(C,p.methodDefinition,p.callOptions,p.channel);g.call=A;let I=!1,T=new Error;return A.start(p.metadata,{onReceiveMetadata(P){g.emit("metadata",P)},onReceiveMessage(P){g.push(P)},onReceiveStatus(P){if(!I){if(I=!0,g.push(null),P.code!==Dr.Status.OK){let x=us(T);g.emit("error",(0,In.callErrorFromStatus)(P,x))}T=null,g.emit("status",P)}}}),A.sendMessage(i),A.halfClose(),g}makeBidiStreamRequest(e,t,r,i,s){var o,a;let l=this.checkMetadataAndOptions(i,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},u={metadata:l.metadata,call:new In.ClientDuplexStreamImpl(t,r),channel:this[nn],methodDefinition:c,callOptions:l.options};this[Xn]&&(u=this[Xn](u));let p=u.call,g={clientInterceptors:this[ls],clientInterceptorProviders:this[cs],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=u.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},C=(0,Nl.getInterceptingCall)(g,u.methodDefinition,u.callOptions,u.channel);p.call=C;let A=!1,I=new Error;return C.start(u.metadata,{onReceiveMetadata(T){p.emit("metadata",T)},onReceiveMessage(T){p.push(T)},onReceiveStatus(T){if(!A){if(A=!0,p.push(null),T.code!==Dr.Status.OK){let P=us(I);p.emit("error",(0,In.callErrorFromStatus)(T,P))}I=null,p.emit("status",T)}}}),p}};Fl.Client=Ph});var Vh=D(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.loadPackageDefinition=ds.makeClientConstructor=void 0;var Po=Nh(),DD={unary:Po.Client.prototype.makeUnaryRequest,server_stream:Po.Client.prototype.makeServerStreamRequest,client_stream:Po.Client.prototype.makeClientStreamRequest,bidi:Po.Client.prototype.makeBidiStreamRequest};function Lh(n){return["__proto__","prototype","constructor"].includes(n)}function F0(n,e,t){t||(t={});class r extends Po.Client{}return Object.keys(n).forEach(i=>{if(Lh(i))return;let s=n[i],o;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,l=s.responseDeserialize,c=xD(DD[o],s.path,a,l);r.prototype[i]=c,Object.assign(r.prototype[i],s),s.originalName&&!Lh(s.originalName)&&(r.prototype[s.originalName]=r.prototype[i])}),r.service=n,r.serviceName=e,r}ds.makeClientConstructor=F0;function xD(n,e,t,r){return function(...i){return n.call(this,e,t,r,...i)}}function RD(n){return"format"in n}function kD(n){let e={};for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],i=t.split(".");if(i.some(a=>Lh(a)))continue;let s=i[i.length-1],o=e;for(let a of i.slice(0,-1))o[a]||(o[a]={}),o=o[a];RD(r)?o[s]=r:o[s]=F0(r,s,{})}return e}ds.loadPackageDefinition=kD});var a_=D((v4,o_)=>{"use strict";var OD=1/0,MD="[object Symbol]",PD=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ND=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vl="\\ud800-\\udfff",G0="\\u0300-\\u036f\\ufe20-\\ufe23",$0="\\u20d0-\\u20f0",W0="\\u2700-\\u27bf",H0="a-z\\xdf-\\xf6\\xf8-\\xff",FD="\\xac\\xb1\\xd7\\xf7",LD="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",VD="\\u2000-\\u206f",BD=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",K0="A-Z\\xc0-\\xd6\\xd8-\\xde",Q0="\\ufe0e\\ufe0f",Y0=FD+LD+VD+BD,Uh="['\u2019]",UD="["+Vl+"]",L0="["+Y0+"]",Ll="["+G0+$0+"]",X0="\\d+",qD="["+W0+"]",J0="["+H0+"]",Z0="[^"+Vl+Y0+X0+W0+H0+K0+"]",Bh="\\ud83c[\\udffb-\\udfff]",zD="(?:"+Ll+"|"+Bh+")",e_="[^"+Vl+"]",qh="(?:\\ud83c[\\udde6-\\uddff]){2}",zh="[\\ud800-\\udbff][\\udc00-\\udfff]",hs="["+K0+"]",t_="\\u200d",V0="(?:"+J0+"|"+Z0+")",jD="(?:"+hs+"|"+Z0+")",B0="(?:"+Uh+"(?:d|ll|m|re|s|t|ve))?",U0="(?:"+Uh+"(?:D|LL|M|RE|S|T|VE))?",n_=zD+"?",r_="["+Q0+"]?",GD="(?:"+t_+"(?:"+[e_,qh,zh].join("|")+")"+r_+n_+")*",i_=r_+n_+GD,$D="(?:"+[qD,qh,zh].join("|")+")"+i_,WD="(?:"+[e_+Ll+"?",Ll,qh,zh,UD].join("|")+")",HD=RegExp(Uh,"g"),KD=RegExp(Ll,"g"),QD=RegExp(Bh+"(?="+Bh+")|"+WD+i_,"g"),YD=RegExp([hs+"?"+J0+"+"+B0+"(?="+[L0,hs,"$"].join("|")+")",jD+"+"+U0+"(?="+[L0,hs+V0,"$"].join("|")+")",hs+"?"+V0+"+"+B0,hs+"+"+U0,X0,$D].join("|"),"g"),XD=RegExp("["+t_+Vl+G0+$0+Q0+"]"),JD=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ZD={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},ex=typeof global=="object"&&global&&global.Object===Object&&global,tx=typeof self=="object"&&self&&self.Object===Object&&self,nx=ex||tx||Function("return this")();function rx(n,e,t,r){var i=-1,s=n?n.length:0;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function ix(n){return n.split("")}function sx(n){return n.match(PD)||[]}function ox(n){return function(e){return n?.[e]}}var ax=ox(ZD);function s_(n){return XD.test(n)}function lx(n){return JD.test(n)}function cx(n){return s_(n)?ux(n):ix(n)}function ux(n){return n.match(QD)||[]}function dx(n){return n.match(YD)||[]}var hx=Object.prototype,fx=hx.toString,q0=nx.Symbol,z0=q0?q0.prototype:void 0,j0=z0?z0.toString:void 0;function px(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function mx(n){if(typeof n=="string")return n;if(Cx(n))return j0?j0.call(n):"";var e=n+"";return e=="0"&&1/n==-OD?"-0":e}function gx(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:px(n,e,t)}function yx(n){return function(e){e=Bl(e);var t=s_(e)?cx(e):void 0,r=t?t[0]:e.charAt(0),i=t?gx(t,1).join(""):e.slice(1);return r[n]()+i}}function vx(n){return function(e){return rx(Tx(Ex(e).replace(HD,"")),n,"")}}function _x(n){return!!n&&typeof n=="object"}function Cx(n){return typeof n=="symbol"||_x(n)&&fx.call(n)==MD}function Bl(n){return n==null?"":mx(n)}var Sx=vx(function(n,e,t){return e=e.toLowerCase(),n+(t?bx(e):e)});function bx(n){return wx(Bl(n).toLowerCase())}function Ex(n){return n=Bl(n),n&&n.replace(ND,ax).replace(KD,"")}var wx=yx("toUpperCase");function Tx(n,e,t){return n=Bl(n),e=t?void 0:e,e===void 0?lx(n)?dx(n):sx(n):n.match(e)||[]}o_.exports=Sx});var jh=D((_4,l_)=>{"use strict";l_.exports=Ax;function Ax(n,e){for(var t=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)t[r++]=arguments[i++];return new Promise(function(a,l){t[r]=function(u){if(s)if(s=!1,u)l(u);else{for(var p=new Array(arguments.length-1),g=0;g<p.length;)p[g++]=arguments[g];a.apply(null,p)}};try{n.apply(e||null,t)}catch(c){s&&(s=!1,l(c))}})}});var h_=D(d_=>{"use strict";var Ul=d_;Ul.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&e.charAt(t)==="=";)++r;return Math.ceil(e.length*3)/4-r};var fs=new Array(64),u_=new Array(123);for(rn=0;rn<64;)u_[fs[rn]=rn<26?rn+65:rn<52?rn+71:rn<62?rn-4:rn-59|43]=rn++;var rn;Ul.encode=function(e,t,r){for(var i=null,s=[],o=0,a=0,l;t<r;){var c=e[t++];switch(a){case 0:s[o++]=fs[c>>2],l=(c&3)<<4,a=1;break;case 1:s[o++]=fs[l|c>>4],l=(c&15)<<2,a=2;break;case 2:s[o++]=fs[l|c>>6],s[o++]=fs[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=fs[l],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var c_="invalid encoding";Ul.decode=function(e,t,r){for(var i=r,s=0,o,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&s>1)break;if((l=u_[l])===void 0)throw Error(c_);switch(s){case 0:o=l,s=1;break;case 1:t[r++]=o<<2|(l&48)>>4,o=l,s=2;break;case 2:t[r++]=(o&15)<<4|(l&60)>>2,o=l,s=3;break;case 3:t[r++]=(o&3)<<6|l,s=0;break}}if(s===1)throw Error(c_);return r-i};Ul.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var p_=D((S4,f_)=>{"use strict";f_.exports=ql;function ql(){this._listeners={}}ql.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this};ql.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this};ql.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}});var S_=D((b4,C_)=>{"use strict";C_.exports=m_(m_);function m_(n){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),r=t[3]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3]}function s(l,c,u){e[0]=l,c[u]=t[3],c[u+1]=t[2],c[u+2]=t[1],c[u+3]=t[0]}n.writeFloatLE=r?i:s,n.writeFloatBE=r?s:i;function o(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],e[0]}function a(l,c){return t[3]=l[c],t[2]=l[c+1],t[1]=l[c+2],t[0]=l[c+3],e[0]}n.readFloatLE=r?o:a,n.readFloatBE=r?a:o}():function(){function e(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var l=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-l)*8388608)&8388607;r((a<<31|l+127<<23|c)>>>0,s,o)}}n.writeFloatLE=e.bind(null,g_),n.writeFloatBE=e.bind(null,y_);function t(r,i,s){var o=r(i,s),a=(o>>31)*2+1,l=o>>>23&255,c=o&8388607;return l===255?c?NaN:a*(1/0):l===0?a*1401298464324817e-60*c:a*Math.pow(2,l-150)*(c+8388608)}n.readFloatLE=t.bind(null,v_),n.readFloatBE=t.bind(null,__)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),r=t[7]===128;function i(l,c,u){e[0]=l,c[u]=t[0],c[u+1]=t[1],c[u+2]=t[2],c[u+3]=t[3],c[u+4]=t[4],c[u+5]=t[5],c[u+6]=t[6],c[u+7]=t[7]}function s(l,c,u){e[0]=l,c[u]=t[7],c[u+1]=t[6],c[u+2]=t[5],c[u+3]=t[4],c[u+4]=t[3],c[u+5]=t[2],c[u+6]=t[1],c[u+7]=t[0]}n.writeDoubleLE=r?i:s,n.writeDoubleBE=r?s:i;function o(l,c){return t[0]=l[c],t[1]=l[c+1],t[2]=l[c+2],t[3]=l[c+3],t[4]=l[c+4],t[5]=l[c+5],t[6]=l[c+6],t[7]=l[c+7],e[0]}function a(l,c){return t[7]=l[c],t[6]=l[c+1],t[5]=l[c+2],t[4]=l[c+3],t[3]=l[c+4],t[2]=l[c+5],t[1]=l[c+6],t[0]=l[c+7],e[0]}n.readDoubleLE=r?o:a,n.readDoubleBE=r?a:o}():function(){function e(r,i,s,o,a,l){var c=o<0?1:0;if(c&&(o=-o),o===0)r(0,a,l+i),r(1/o>0?0:2147483648,a,l+s);else if(isNaN(o))r(0,a,l+i),r(2146959360,a,l+s);else if(o>17976931348623157e292)r(0,a,l+i),r((c<<31|2146435072)>>>0,a,l+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,r(u>>>0,a,l+i),r((c<<31|u/4294967296)>>>0,a,l+s);else{var p=Math.floor(Math.log(o)/Math.LN2);p===1024&&(p=1023),u=o*Math.pow(2,-p),r(u*4503599627370496>>>0,a,l+i),r((c<<31|p+1023<<20|u*1048576&1048575)>>>0,a,l+s)}}}n.writeDoubleLE=e.bind(null,g_,0,4),n.writeDoubleBE=e.bind(null,y_,4,0);function t(r,i,s,o,a){var l=r(o,a+i),c=r(o,a+s),u=(c>>31)*2+1,p=c>>>20&2047,g=4294967296*(c&1048575)+l;return p===2047?g?NaN:u*(1/0):p===0?u*5e-324*g:u*Math.pow(2,p-1075)*(g+4503599627370496)}n.readDoubleLE=t.bind(null,v_,0,4),n.readDoubleBE=t.bind(null,__,4,0)}(),n}function g_(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}function y_(n,e,t){e[t]=n>>>24,e[t+1]=n>>>16&255,e[t+2]=n>>>8&255,e[t+3]=n&255}function v_(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0}function __(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}});var Gh=D((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}});var E_=D(b_=>{"use strict";var $h=b_;$h.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,t+=4):t+=3;return t};$h.read=function(e,t,r){var i=r-t;if(i<1)return"";for(var s=null,o=[],a=0,l;t<r;)l=e[t++],l<128?o[a++]=l:l>191&&l<224?o[a++]=(l&31)<<6|e[t++]&63:l>239&&l<365?(l=((l&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(l>>10),o[a++]=56320+(l&1023)):o[a++]=(l&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};$h.write=function(e,t,r){for(var i=r,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128);return r-i}});var T_=D((w4,w_)=>{"use strict";w_.exports=Ix;function Ix(n,e,t){var r=t||8192,i=r>>>1,s=null,o=r;return function(l){if(l<1||l>i)return n(l);o+l>r&&(s=n(r),o=0);var c=e.call(s,o,o+=l);return o&7&&(o=(o|7)+1),c}}});var I_=D((T4,A_)=>{"use strict";A_.exports=Xe;var No=Dn();function Xe(n,e){this.lo=n>>>0,this.hi=e>>>0}var pi=Xe.zero=new Xe(0,0);pi.toNumber=function(){return 0};pi.zzEncode=pi.zzDecode=function(){return this};pi.length=function(){return 1};var Dx=Xe.zeroHash="\0\0\0\0\0\0\0\0";Xe.fromNumber=function(e){if(e===0)return pi;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new Xe(r,i)};Xe.from=function(e){if(typeof e=="number")return Xe.fromNumber(e);if(No.isString(e))if(No.Long)e=No.Long.fromString(e);else return Xe.fromNumber(parseInt(e,10));return e.low||e.high?new Xe(e.low>>>0,e.high>>>0):pi};Xe.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+r*4294967296)}return this.lo+this.hi*4294967296};Xe.prototype.toLong=function(e){return No.Long?new No.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var xr=String.prototype.charCodeAt;Xe.fromHash=function(e){return e===Dx?pi:new Xe((xr.call(e,0)|xr.call(e,1)<<8|xr.call(e,2)<<16|xr.call(e,3)<<24)>>>0,(xr.call(e,4)|xr.call(e,5)<<8|xr.call(e,6)<<16|xr.call(e,7)<<24)>>>0)};Xe.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Xe.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Xe.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Xe.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}});var Dn=D(Wh=>{"use strict";var W=Wh;W.asPromise=jh();W.base64=h_();W.EventEmitter=p_();W.float=S_();W.inquire=Gh();W.utf8=E_();W.pool=T_();W.LongBits=I_();W.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);W.global=W.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||Wh;W.emptyArray=Object.freeze?Object.freeze([]):[];W.emptyObject=Object.freeze?Object.freeze({}):{};W.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};W.isString=function(e){return typeof e=="string"||e instanceof String};W.isObject=function(e){return e&&typeof e=="object"};W.isset=W.isSet=function(e,t){var r=e[t];return r!=null&&e.hasOwnProperty(t)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};W.Buffer=function(){try{var n=W.inquire("buffer").Buffer;return n.prototype.utf8Write?n:null}catch{return null}}();W._Buffer_from=null;W._Buffer_allocUnsafe=null;W.newBuffer=function(e){return typeof e=="number"?W.Buffer?W._Buffer_allocUnsafe(e):new W.Array(e):W.Buffer?W._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};W.Array=typeof Uint8Array<"u"?Uint8Array:Array;W.Long=W.global.dcodeIO&&W.global.dcodeIO.Long||W.global.Long||W.inquire("long");W.key2Re=/^true|false|0|1$/;W.key32Re=/^-?(?:0|[1-9][0-9]*)$/;W.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;W.longToHash=function(e){return e?W.LongBits.from(e).toHash():W.LongBits.zeroHash};W.longFromHash=function(e,t){var r=W.LongBits.fromHash(e);return W.Long?W.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)};function D_(n,e,t){for(var r=Object.keys(e),i=0;i<r.length;++i)(n[r[i]]===void 0||!t)&&(n[r[i]]=e[r[i]]);return n}W.merge=D_;W.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function x_(n){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&D_(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return n},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}W.newError=x_;W.ProtocolError=x_("ProtocolError");W.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(t[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};W.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}};W.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};W._configure=function(){var n=W.Buffer;if(!n){W._Buffer_from=W._Buffer_allocUnsafe=null;return}W._Buffer_from=n.from!==Uint8Array.from&&n.from||function(t,r){return new n(t,r)},W._Buffer_allocUnsafe=n.allocUnsafe||function(t){return new n(t)}}});var jl=D((I4,M_)=>{"use strict";M_.exports=ce;var Wt=Dn(),Hh,zl=Wt.LongBits,R_=Wt.base64,k_=Wt.utf8;function Fo(n,e,t){this.fn=n,this.len=e,this.next=void 0,this.val=t}function Qh(){}function xx(n){this.head=n.head,this.tail=n.tail,this.len=n.len,this.next=n.states}function ce(){this.len=0,this.head=new Fo(Qh,0,0),this.tail=this.head,this.states=null}var O_=function(){return Wt.Buffer?function(){return(ce.create=function(){return new Hh})()}:function(){return new ce}};ce.create=O_();ce.alloc=function(e){return new Wt.Array(e)};Wt.Array!==Array&&(ce.alloc=Wt.pool(ce.alloc,Wt.Array.prototype.subarray));ce.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Fo(e,t,r),this.len+=t,this};function Yh(n,e,t){e[t]=n&255}function Rx(n,e,t){for(;n>127;)e[t++]=n&127|128,n>>>=7;e[t]=n}function Xh(n,e){this.len=n,this.next=void 0,this.val=e}Xh.prototype=Object.create(Fo.prototype);Xh.prototype.fn=Rx;ce.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Xh((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ce.prototype.int32=function(e){return e<0?this._push(Jh,10,zl.fromNumber(e)):this.uint32(e)};ce.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Jh(n,e,t){for(;n.hi;)e[t++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)e[t++]=n.lo&127|128,n.lo=n.lo>>>7;e[t++]=n.lo}ce.prototype.uint64=function(e){var t=zl.from(e);return this._push(Jh,t.length(),t)};ce.prototype.int64=ce.prototype.uint64;ce.prototype.sint64=function(e){var t=zl.from(e).zzEncode();return this._push(Jh,t.length(),t)};ce.prototype.bool=function(e){return this._push(Yh,1,e?1:0)};function Kh(n,e,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24}ce.prototype.fixed32=function(e){return this._push(Kh,4,e>>>0)};ce.prototype.sfixed32=ce.prototype.fixed32;ce.prototype.fixed64=function(e){var t=zl.from(e);return this._push(Kh,4,t.lo)._push(Kh,4,t.hi)};ce.prototype.sfixed64=ce.prototype.fixed64;ce.prototype.float=function(e){return this._push(Wt.float.writeFloatLE,4,e)};ce.prototype.double=function(e){return this._push(Wt.float.writeDoubleLE,8,e)};var kx=Wt.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};ce.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(Yh,1,0);if(Wt.isString(e)){var r=ce.alloc(t=R_.length(e));R_.decode(e,r,0),e=r}return this.uint32(t)._push(kx,t,e)};ce.prototype.string=function(e){var t=k_.length(e);return t?this.uint32(t)._push(k_.write,t,e):this._push(Yh,1,0)};ce.prototype.fork=function(){return this.states=new xx(this),this.head=this.tail=new Fo(Qh,0,0),this.len=0,this};ce.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Fo(Qh,0,0),this.len=0),this};ce.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this};ce.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t};ce._configure=function(n){Hh=n,ce.create=O_(),Hh._configure()}});var F_=D((D4,N_)=>{"use strict";N_.exports=xn;var P_=jl();(xn.prototype=Object.create(P_.prototype)).constructor=xn;var Rr=Dn();function xn(){P_.call(this)}xn._configure=function(){xn.alloc=Rr._Buffer_allocUnsafe,xn.writeBytesBuffer=Rr.Buffer&&Rr.Buffer.prototype instanceof Uint8Array&&Rr.Buffer.prototype.set.name==="set"?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}};xn.prototype.bytes=function(e){Rr.isString(e)&&(e=Rr._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(xn.writeBytesBuffer,t,e),this};function Ox(n,e,t){n.length<40?Rr.utf8.write(n,e,t):e.utf8Write?e.utf8Write(n,t):e.write(n,t)}xn.prototype.string=function(e){var t=Rr.Buffer.byteLength(e);return this.uint32(t),t&&this._push(Ox,t,e),this};xn._configure()});var $l=D((x4,q_)=>{"use strict";q_.exports=Be;var sn=Dn(),ef,B_=sn.LongBits,Mx=sn.utf8;function on(n,e){return RangeError("index out of range: "+n.pos+" + "+(e||1)+" > "+n.len)}function Be(n){this.buf=n,this.pos=0,this.len=n.length}var L_=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Be(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Be(e);throw Error("illegal buffer")},U_=function(){return sn.Buffer?function(t){return(Be.create=function(i){return sn.Buffer.isBuffer(i)?new ef(i):L_(i)})(t)}:L_};Be.create=U_();Be.prototype._slice=sn.Array.prototype.subarray||sn.Array.prototype.slice;Be.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,on(this,10);return e}}();Be.prototype.int32=function(){return this.uint32()|0};Be.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Zh(){var n=new B_(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n;if(n.lo=(n.lo|(this.buf[this.pos]&127)<<28)>>>0,n.hi=(n.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return n;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw on(this);if(n.lo=(n.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return n}return n.lo=(n.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,n}if(this.len-this.pos>4){for(;e<5;++e)if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}else for(;e<5;++e){if(this.pos>=this.len)throw on(this);if(n.hi=(n.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return n}throw Error("invalid varint encoding")}Be.prototype.bool=function(){return this.uint32()!==0};function Gl(n,e){return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0}Be.prototype.fixed32=function(){if(this.pos+4>this.len)throw on(this,4);return Gl(this.buf,this.pos+=4)};Be.prototype.sfixed32=function(){if(this.pos+4>this.len)throw on(this,4);return Gl(this.buf,this.pos+=4)|0};function V_(){if(this.pos+8>this.len)throw on(this,8);return new B_(Gl(this.buf,this.pos+=4),Gl(this.buf,this.pos+=4))}Be.prototype.float=function(){if(this.pos+4>this.len)throw on(this,4);var e=sn.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Be.prototype.double=function(){if(this.pos+8>this.len)throw on(this,4);var e=sn.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Be.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw on(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=sn.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)};Be.prototype.string=function(){var e=this.bytes();return Mx.read(e,0,e.length)};Be.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw on(this,e);this.pos+=e}else do if(this.pos>=this.len)throw on(this);while(this.buf[this.pos++]&128);return this};Be.prototype.skipType=function(n){switch(n){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(n=this.uint32()&7)!==4;)this.skipType(n);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+n+" at offset "+this.pos)}return this};Be._configure=function(n){ef=n,Be.create=U_(),ef._configure();var e=sn.Long?"toLong":"toNumber";sn.merge(Be.prototype,{int64:function(){return Zh.call(this)[e](!1)},uint64:function(){return Zh.call(this)[e](!0)},sint64:function(){return Zh.call(this).zzDecode()[e](!1)},fixed64:function(){return V_.call(this)[e](!0)},sfixed64:function(){return V_.call(this)[e](!1)}})}});var $_=D((R4,G_)=>{"use strict";G_.exports=mi;var j_=$l();(mi.prototype=Object.create(j_.prototype)).constructor=mi;var z_=Dn();function mi(n){j_.call(this,n)}mi._configure=function(){z_.Buffer&&(mi.prototype._slice=z_.Buffer.prototype.slice)};mi.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};mi._configure()});var H_=D((k4,W_)=>{"use strict";W_.exports=Lo;var tf=Dn();(Lo.prototype=Object.create(tf.EventEmitter.prototype)).constructor=Lo;function Lo(n,e,t){if(typeof n!="function")throw TypeError("rpcImpl must be a function");tf.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!e,this.responseDelimited=!!t}Lo.prototype.rpcCall=function n(e,t,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return tf.asPromise(n,o,e,t,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(l,c){if(l)return o.emit("error",l,e),s(l);if(c===null){o.end(!0);return}if(!(c instanceof r))try{c=r[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",c,e),s(null,c)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Lo.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var nf=D(K_=>{"use strict";var Px=K_;Px.Service=H_()});var rf=D((M4,Q_)=>{"use strict";Q_.exports={}});var J_=D(X_=>{"use strict";var At=X_;At.build="minimal";At.Writer=jl();At.BufferWriter=F_();At.Reader=$l();At.BufferReader=$_();At.util=Dn();At.rpc=nf();At.roots=rf();At.configure=Y_;function Y_(){At.util._configure(),At.Writer._configure(At.BufferWriter),At.Reader._configure(At.BufferReader)}Y_()});var eC=D((N4,Z_)=>{"use strict";Z_.exports=sf;function sf(n,e){typeof n=="string"&&(e=n,n=void 0);var t=[];function r(s){if(typeof s!="string"){var o=i();if(sf.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),l=new Array(a.length+1),c=new Array(a.length),u=0;u<a.length;)l[u]=a[u],c[u]=s[a[u++]];return l[u]=o,Function.apply(null,l).apply(null,c)}return Function(o)()}for(var p=new Array(arguments.length-1),g=0;g<p.length;)p[g]=arguments[++g];if(g=0,s=s.replace(/%([%dfijs])/g,function(A,I){var T=p[g++];switch(I){case"d":case"f":return String(Number(T));case"i":return String(Math.floor(T));case"j":return JSON.stringify(T);case"s":return String(T)}return"%"}),g!==p.length)throw Error("parameter count mismatch");return t.push(s),r}function i(s){return"function "+(s||e||"")+"("+(n&&n.join(",")||"")+`){
  `+t.join(`
  `)+`
}`}return r.toString=i,r}sf.verbose=!1});var nC=D((F4,tC)=>{"use strict";tC.exports=Vo;var Nx=jh(),Fx=Gh(),of=Fx("fs");function Vo(n,e,t){return typeof e=="function"?(t=e,e={}):e||(e={}),t?!e.xhr&&of&&of.readFile?of.readFile(n,function(i,s){return i&&typeof XMLHttpRequest<"u"?Vo.xhr(n,e,t):i?t(i):t(null,e.binary?s:s.toString("utf8"))}):Vo.xhr(n,e,t):Nx(Vo,this,n,e)}Vo.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(t.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var sC=D(iC=>{"use strict";var lf=iC,rC=lf.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},af=lf.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),r=rC(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)t[s]===".."?s>0&&t[s-1]!==".."?t.splice(--s,2):r?t.splice(s,1):++s:t[s]==="."?t.splice(s,1):++s;return i+t.join("/")};lf.resolve=function(e,t,r){return r||(t=af(t)),rC(t)?t:(r||(e=af(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?af(e+"/"+t):t)}});var gi=D(oC=>{"use strict";var Bo=oC,Lx=Je(),Vx=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Uo(n,e){var t=0,r={};for(e|=0;t<n.length;)r[Vx[t+e]]=n[t++];return r}Bo.basic=Uo([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Bo.defaults=Uo([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Lx.emptyArray,null]);Bo.long=Uo([0,0,0,1,1],7);Bo.mapKey=Uo([0,0,0,5,5,0,0,0,1,1,0,2],2);Bo.packed=Uo([1,5,0,0,0,5,5,0,0,0,1,1,0])});var kr=D((B4,cC)=>{"use strict";cC.exports=Ht;var Wl=yi();((Ht.prototype=Object.create(Wl.prototype)).constructor=Ht).className="Field";var aC=an(),lC=gi(),je=Je(),cf,Bx=/^required|optional|repeated$/;Ht.fromJSON=function(e,t){return new Ht(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Ht(n,e,t,r,i,s,o){if(je.isObject(r)?(o=i,s=r,r=i=void 0):je.isObject(i)&&(o=s,s=i,i=void 0),Wl.call(this,n,s),!je.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!je.isString(t))throw TypeError("type must be a string");if(r!==void 0&&!Bx.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!je.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=t,this.id=e,this.extend=i||void 0,this.required=r==="required",this.optional=!this.required,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=je.Long?lC.long[t]!==void 0:!1,this.bytes=t==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(Ht.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});Ht.prototype.setOption=function(e,t,r){return e==="packed"&&(this._packed=null),Wl.prototype.setOption.call(this,e,t,r)};Ht.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return je.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Ht.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=lC.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof cf?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof aC&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof aC))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=je.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;je.base64.test(this.typeDefault)?je.base64.decode(this.typeDefault,e=je.newBuffer(je.base64.length(this.typeDefault)),0):je.utf8.write(this.typeDefault,e=je.newBuffer(je.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=je.emptyObject:this.repeated?this.defaultValue=je.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof cf&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Wl.prototype.resolve.call(this)};Ht.d=function(e,t,r,i){return typeof t=="function"?t=je.decorateType(t).name:t&&typeof t=="object"&&(t=je.decorateEnum(t).name),function(o,a){je.decorateType(o.constructor).add(new Ht(a,e,t,r,{default:i}))}};Ht._configure=function(e){cf=e}});var ps=D((U4,hC)=>{"use strict";hC.exports=Kt;var Kl=yi();((Kt.prototype=Object.create(Kl.prototype)).constructor=Kt).className="OneOf";var uC=kr(),Hl=Je();function Kt(n,e,t,r){if(Array.isArray(e)||(t=e,e=void 0),Kl.call(this,n,t),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}Kt.fromJSON=function(e,t){return new Kt(e,t.oneof,t.options,t.comment)};Kt.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return Hl.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])};function dC(n){if(n.parent)for(var e=0;e<n.fieldsArray.length;++e)n.fieldsArray[e].parent||n.parent.add(n.fieldsArray[e])}Kt.prototype.add=function(e){if(!(e instanceof uC))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,dC(this),this};Kt.prototype.remove=function(e){if(!(e instanceof uC))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),t=this.oneof.indexOf(e.name),t>-1&&this.oneof.splice(t,1),e.partOf=null,this};Kt.prototype.onAdd=function(e){Kl.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=t,t.fieldsArray.push(i))}dC(this)};Kt.prototype.onRemove=function(e){for(var t=0,r;t<this.fieldsArray.length;++t)(r=this.fieldsArray[t]).parent&&r.parent.remove(r);Kl.prototype.onRemove.call(this,e)};Kt.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(i,s){Hl.decorateType(i.constructor).add(new Kt(s,e)),Object.defineProperty(i,s,{get:Hl.oneOfGetter(e),set:Hl.oneOfSetter(e)})}}});var ys=D((q4,gC)=>{"use strict";gC.exports=ue;var uf=yi();((ue.prototype=Object.create(uf.prototype)).constructor=ue).className="Namespace";var fC=kr(),Ql=Je(),Ux=ps(),ms,qo,gs;ue.fromJSON=function(e,t){return new ue(e,t.options).addJSON(t.nested)};function pC(n,e){if(n&&n.length){for(var t={},r=0;r<n.length;++r)t[n[r].name]=n[r].toJSON(e);return t}}ue.arrayToJSON=pC;ue.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=t&&e[r][1]>t)return!0}return!1};ue.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1};function ue(n,e){uf.call(this,n,e),this.nested=void 0,this._nestedArray=null}function mC(n){return n._nestedArray=null,n}Object.defineProperty(ue.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Ql.toArray(this.nested))}});ue.prototype.toJSON=function(e){return Ql.toObject(["options",this.options,"nested",pC(this.nestedArray,e)])};ue.prototype.addJSON=function(e){var t=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],t.add((s.fields!==void 0?ms.fromJSON:s.values!==void 0?gs.fromJSON:s.methods!==void 0?qo.fromJSON:s.id!==void 0?fC.fromJSON:ue.fromJSON)(r[i],s));return this};ue.prototype.get=function(e){return this.nested&&this.nested[e]||null};ue.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof gs)return this.nested[e].values;throw Error("no such enum: "+e)};ue.prototype.add=function(e){if(!(e instanceof fC&&e.extend!==void 0||e instanceof ms||e instanceof Ux||e instanceof gs||e instanceof qo||e instanceof ue))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t)if(t instanceof ue&&e instanceof ue&&!(t instanceof ms||t instanceof qo)){for(var r=t.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),mC(this)};ue.prototype.remove=function(e){if(!(e instanceof uf))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),mC(this)};ue.prototype.define=function(e,t){if(Ql.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof ue))throw Error("path conflicts with non-namespace objects")}else r.add(r=new ue(i))}return t&&r.addJSON(t),r};ue.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof ue?e[t++].resolveAll():e[t++].resolve();return this.resolve()};ue.prototype.lookup=function(e,t,r){if(typeof t=="boolean"?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),Ql.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var i=this.get(e[0]);if(i){if(e.length===1){if(!t||t.indexOf(i.constructor)>-1)return i}else if(i instanceof ue&&(i=i.lookup(e.slice(1),t,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof ue&&(i=this._nestedArray[s].lookup(e,t,!0)))return i;return this.parent===null||r?null:this.parent.lookup(e,t)};ue.prototype.lookupType=function(e){var t=this.lookup(e,[ms]);if(!t)throw Error("no such type: "+e);return t};ue.prototype.lookupEnum=function(e){var t=this.lookup(e,[gs]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};ue.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[ms,gs]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};ue.prototype.lookupService=function(e){var t=this.lookup(e,[qo]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};ue._configure=function(n,e,t){ms=n,qo=e,gs=t}});var Yl=D((z4,yC)=>{"use strict";yC.exports=Jn;var df=kr();((Jn.prototype=Object.create(df.prototype)).constructor=Jn).className="MapField";var qx=gi(),zo=Je();function Jn(n,e,t,r,i,s){if(df.call(this,n,e,r,void 0,void 0,i,s),!zo.isString(t))throw TypeError("keyType must be a string");this.keyType=t,this.resolvedKeyType=null,this.map=!0}Jn.fromJSON=function(e,t){return new Jn(e,t.id,t.keyType,t.type,t.options,t.comment)};Jn.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return zo.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])};Jn.prototype.resolve=function(){if(this.resolved)return this;if(qx.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return df.prototype.resolve.call(this)};Jn.d=function(e,t,r){return typeof r=="function"?r=zo.decorateType(r).name:r&&typeof r=="object"&&(r=zo.decorateEnum(r).name),function(s,o){zo.decorateType(s.constructor).add(new Jn(o,e,t,r))}}});var Xl=D((j4,vC)=>{"use strict";vC.exports=vi;var hf=yi();((vi.prototype=Object.create(hf.prototype)).constructor=vi).className="Method";var vs=Je();function vi(n,e,t,r,i,s,o,a,l){if(vs.isObject(i)?(o=i,i=s=void 0):vs.isObject(s)&&(o=s,s=void 0),!(e===void 0||vs.isString(e)))throw TypeError("type must be a string");if(!vs.isString(t))throw TypeError("requestType must be a string");if(!vs.isString(r))throw TypeError("responseType must be a string");hf.call(this,n,o),this.type=e||"rpc",this.requestType=t,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=l}vi.fromJSON=function(e,t){return new vi(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};vi.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return vs.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])};vi.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),hf.prototype.resolve.call(this))}});var Jl=D((G4,CC)=>{"use strict";CC.exports=Qt;var Or=ys();((Qt.prototype=Object.create(Or.prototype)).constructor=Qt).className="Service";var ff=Xl(),jo=Je(),zx=nf();function Qt(n,e){Or.call(this,n,e),this.methods={},this._methodsArray=null}Qt.fromJSON=function(e,t){var r=new Qt(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(ff.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),r.comment=t.comment,r};Qt.prototype.toJSON=function(e){var t=Or.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return jo.toObject(["options",t&&t.options||void 0,"methods",Or.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(Qt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=jo.toArray(this.methods))}});function _C(n){return n._methodsArray=null,n}Qt.prototype.get=function(e){return this.methods[e]||Or.prototype.get.call(this,e)};Qt.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return Or.prototype.resolve.call(this)};Qt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof ff?(this.methods[e.name]=e,e.parent=this,_C(this)):Or.prototype.add.call(this,e)};Qt.prototype.remove=function(e){if(e instanceof ff){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,_C(this)}return Or.prototype.remove.call(this,e)};Qt.prototype.create=function(e,t,r){for(var i=new zx.Service(e,t,r),s=0,o;s<this.methodsArray.length;++s){var a=jo.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=jo.codegen(["r","c"],jo.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var Zl=D(($4,SC)=>{"use strict";SC.exports=Rn;var jx=Dn();function Rn(n){if(n)for(var e=Object.keys(n),t=0;t<e.length;++t)this[e[t]]=n[e[t]]}Rn.create=function(e){return this.$type.create(e)};Rn.encode=function(e,t){return this.$type.encode(e,t)};Rn.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)};Rn.decode=function(e){return this.$type.decode(e)};Rn.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Rn.verify=function(e){return this.$type.verify(e)};Rn.fromObject=function(e){return this.$type.fromObject(e)};Rn.toObject=function(e,t){return this.$type.toObject(e,t)};Rn.prototype.toJSON=function(){return this.$type.toObject(this,jx.toJSONOptions)}});var pf=D((W4,EC)=>{"use strict";EC.exports=Wx;var Gx=an(),Zn=gi(),bC=Je();function $x(n){return"missing required '"+n.name+"'"}function Wx(n){var e=bC.codegen(["r","l"],n.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(n.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");n.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var t=0;t<n.fieldsArray.length;++t){var r=n._fieldsArray[t].resolve(),i=r.resolvedType instanceof Gx?"int32":r.type,s="m"+bC.safeProp(r.name);e("case %i: {",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Zn.defaults[r.keyType]!==void 0?e("k=%j",Zn.defaults[r.keyType]):e("k=null"),Zn.defaults[i]!==void 0?e("value=%j",Zn.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Zn.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",t):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Zn.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Zn.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),Zn.basic[i]===void 0?e(r.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,t):e("%s.push(r.%s())",s,i)):Zn.basic[i]===void 0?e(r.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,t):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),t=0;t<n._fieldsArray.length;++t){var o=n._fieldsArray[t];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",$x(o))}return e("return m")}});var yf=D((H4,wC)=>{"use strict";wC.exports=Qx;var Hx=an(),mf=Je();function Yt(n,e){return n.name+": "+e+(n.repeated&&e!=="array"?"[]":n.map&&e!=="object"?"{k:"+n.keyType+"}":"")+" expected"}function gf(n,e,t,r){if(e.resolvedType)if(e.resolvedType instanceof Hx){n("switch(%s){",r)("default:")("return%j",Yt(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)n("case %i:",e.resolvedType.values[i[s]]);n("break")("}")}else n("{")("var e=types[%i].verify(%s);",t,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.isInteger(%s))",r)("return%j",Yt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",Yt(e,"integer|Long"));break;case"float":case"double":n('if(typeof %s!=="number")',r)("return%j",Yt(e,"number"));break;case"bool":n('if(typeof %s!=="boolean")',r)("return%j",Yt(e,"boolean"));break;case"string":n("if(!util.isString(%s))",r)("return%j",Yt(e,"string"));break;case"bytes":n('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",Yt(e,"buffer"));break}return n}function Kx(n,e,t){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":n("if(!util.key32Re.test(%s))",t)("return%j",Yt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":n("if(!util.key64Re.test(%s))",t)("return%j",Yt(e,"integer|Long key"));break;case"bool":n("if(!util.key2Re.test(%s))",t)("return%j",Yt(e,"boolean key"));break}return n}function Qx(n){var e=mf.codegen(["m"],n.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),t=n.oneofsArray,r={};t.length&&e("var p={}");for(var i=0;i<n.fieldsArray.length;++i){var s=n._fieldsArray[i].resolve(),o="m"+mf.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",Yt(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),Kx(e,s,"k[i]"),gf(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",Yt(s,"array"))("for(var i=0;i<%s.length;++i){",o),gf(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=mf.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",a)}gf(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var Cf=D(AC=>{"use strict";var TC=AC,Go=an(),kn=Je();function vf(n,e,t,r){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof Go){n("switch(d%s){",r);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!i&&(n("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),e.repeated||n("break"),i=!0),n("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",r,s[o[a]])("break");n("}")}else n('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,t,r);else{var l=!1;switch(e.type){case"double":case"float":n("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":n("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":n("m%s=d%s|0",r,r);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":n('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":n("m%s=String(d%s)",r,r);break;case"bool":n("m%s=Boolean(d%s)",r,r);break}}return n}TC.fromObject=function(e){var t=e.fieldsArray,r=kn.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var s=t[i].resolve(),o=kn.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),vf(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),vf(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Go||r("if(d%s!=null){",o),vf(r,s,i,o),s.resolvedType instanceof Go||r("}"))}return r("return m")};function _f(n,e,t,r){if(e.resolvedType)e.resolvedType instanceof Go?n("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,t,r,r,t,r,r):n("d%s=types[%i].toObject(m%s,o)",r,t,r);else{var i=!1;switch(e.type){case"double":case"float":n("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":n('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":n("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:n("d%s=m%s",r,r);break}}return n}TC.toObject=function(e){var t=e.fieldsArray.slice().sort(kn.compareFieldsById);if(!t.length)return kn.codegen()("return {}");for(var r=kn.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<t.length;++a)t[a].partOf||(t[a].resolve().repeated?i:t[a].map?s:o).push(t[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",kn.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",kn.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var l=o[a],c=kn.safeProp(l.name);if(l.resolvedType instanceof Go)r("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var u="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,l.typeDefault)}r("}")}var p=!1;for(a=0;a<t.length;++a){var l=t[a],g=e._fieldsArray.indexOf(l),c=kn.safeProp(l.name);l.map?(p||(p=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),_f(r,l,g,c+"[ks2[j]]")("}")):l.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),_f(r,l,g,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),_f(r,l,g,c),l.partOf&&r("if(o.oneofs)")("d%s=%j",kn.safeProp(l.partOf.name),l.name)),r("}")}return r("return d")}});var Sf=D(IC=>{"use strict";var Yx=IC,Xx=Zl();Yx[".google.protobuf.Any"]={fromObject:function(n){if(n&&n["@type"]){var e=n["@type"].substring(n["@type"].lastIndexOf("/")+1),t=this.lookup(e);if(t){var r=n["@type"].charAt(0)==="."?n["@type"].slice(1):n["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:t.encode(t.fromObject(n)).finish()})}}return this.fromObject(n)},toObject:function(n,e){var t="type.googleapis.com/",r="",i="";if(e&&e.json&&n.type_url&&n.value){i=n.type_url.substring(n.type_url.lastIndexOf("/")+1),r=n.type_url.substring(0,n.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(n=s.decode(n.value))}if(!(n instanceof this.ctor)&&n instanceof Xx){var o=n.$type.toObject(n,e),a=n.$type.fullName[0]==="."?n.$type.fullName.slice(1):n.$type.fullName;return r===""&&(r=t),i=r+a,o["@type"]=i,o}return this.toObject(n,e)}}});var nc=D((Y4,xC)=>{"use strict";xC.exports=be;var ln=ys();((be.prototype=Object.create(ln.prototype)).constructor=be).className="Type";var Jx=an(),wf=ps(),ec=kr(),Zx=Yl(),eR=Jl(),bf=Zl(),Ef=$l(),tR=jl(),at=Je(),nR=Tf(),rR=pf(),iR=yf(),DC=Cf(),sR=Sf();function be(n,e){ln.call(this,n,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(be.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var n=Object.keys(this.fields),e=0;e<n.length;++e){var t=this.fields[n[e]],r=t.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=t}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=at.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=at.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=be.generateConstructor(this)())},set:function(n){var e=n.prototype;e instanceof bf||((n.prototype=new bf).constructor=n,at.merge(n.prototype,e)),n.$type=n.prototype.$type=this,at.merge(n,bf,!0),this._ctor=n;for(var t=0;t<this.fieldsArray.length;++t)this._fieldsArray[t].resolve();var r={};for(t=0;t<this.oneofsArray.length;++t)r[this._oneofsArray[t].resolve().name]={get:at.oneOfGetter(this._oneofsArray[t].oneof),set:at.oneOfSetter(this._oneofsArray[t].oneof)};t&&Object.defineProperties(n.prototype,r)}}});be.generateConstructor=function(e){for(var t=at.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?t("this%s={}",at.safeProp(i.name)):i.repeated&&t("this%s=[]",at.safeProp(i.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function tc(n){return n._fieldsById=n._fieldsArray=n._oneofsArray=null,delete n.encode,delete n.decode,delete n.verify,n}be.fromJSON=function(e,t){var r=new be(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var i=Object.keys(t.fields),s=0;s<i.length;++s)r.add((typeof t.fields[i[s]].keyType<"u"?Zx.fromJSON:ec.fromJSON)(i[s],t.fields[i[s]]));if(t.oneofs)for(i=Object.keys(t.oneofs),s=0;s<i.length;++s)r.add(wf.fromJSON(i[s],t.oneofs[i[s]]));if(t.nested)for(i=Object.keys(t.nested),s=0;s<i.length;++s){var o=t.nested[i[s]];r.add((o.id!==void 0?ec.fromJSON:o.fields!==void 0?be.fromJSON:o.values!==void 0?Jx.fromJSON:o.methods!==void 0?eR.fromJSON:ln.fromJSON)(i[s],o))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),r};be.prototype.toJSON=function(e){var t=ln.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return at.toObject(["options",t&&t.options||void 0,"oneofs",ln.arrayToJSON(this.oneofsArray,e),"fields",ln.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])};be.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var r=this.oneofsArray;for(t=0;t<r.length;)r[t++].resolve();return ln.prototype.resolveAll.call(this)};be.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};be.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof ec&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),tc(this)}return e instanceof wf?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),tc(this)):ln.prototype.add.call(this,e)};be.prototype.remove=function(e){if(e instanceof ec&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),tc(this)}if(e instanceof wf){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),tc(this)}return ln.prototype.remove.call(this,e)};be.prototype.isReservedId=function(e){return ln.isReservedId(this.reserved,e)};be.prototype.isReservedName=function(e){return ln.isReservedName(this.reserved,e)};be.prototype.create=function(e){return new this.ctor(e)};be.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=nR(this)({Writer:tR,types:t,util:at}),this.decode=rR(this)({Reader:Ef,types:t,util:at}),this.verify=iR(this)({types:t,util:at}),this.fromObject=DC.fromObject(this)({types:t,util:at}),this.toObject=DC.toObject(this)({types:t,util:at});var i=sR[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};be.prototype.encode=function(e,t){return this.setup().encode(e,t)};be.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};be.prototype.decode=function(e,t){return this.setup().decode(e,t)};be.prototype.decodeDelimited=function(e){return e instanceof Ef||(e=Ef.create(e)),this.decode(e,e.uint32())};be.prototype.verify=function(e){return this.setup().verify(e)};be.prototype.fromObject=function(e){return this.setup().fromObject(e)};be.prototype.toObject=function(e,t){return this.setup().toObject(e,t)};be.d=function(e){return function(r){at.decorateType(r,e)}}});var sc=D((X4,PC)=>{"use strict";PC.exports=Mt;var ic=ys();((Mt.prototype=Object.create(ic.prototype)).constructor=Mt).className="Root";var If=kr(),kC=an(),oR=ps(),Mr=Je(),OC,Af,$o;function Mt(n){ic.call(this,"",n),this.deferred=[],this.files=[]}Mt.fromJSON=function(e,t){return t||(t=new Mt),e.options&&t.setOptions(e.options),t.addJSON(e.nested)};Mt.prototype.resolvePath=Mr.path.resolve;Mt.prototype.fetch=Mr.fetch;function MC(){}Mt.prototype.load=function n(e,t,r){typeof t=="function"&&(r=t,t=void 0);var i=this;if(!r)return Mr.asPromise(n,i,e,t);var s=r===MC;function o(C,A){if(r){if(s)throw C;var I=r;r=null,I(C,A)}}function a(C){var A=C.lastIndexOf("google/protobuf/");if(A>-1){var I=C.substring(A);if(I in $o)return I}return null}function l(C,A){try{if(Mr.isString(A)&&A.charAt(0)==="{"&&(A=JSON.parse(A)),!Mr.isString(A))i.setOptions(A.options).addJSON(A.nested);else{Af.filename=C;var I=Af(A,i,t),T,P=0;if(I.imports)for(;P<I.imports.length;++P)(T=a(I.imports[P])||i.resolvePath(C,I.imports[P]))&&c(T);if(I.weakImports)for(P=0;P<I.weakImports.length;++P)(T=a(I.weakImports[P])||i.resolvePath(C,I.weakImports[P]))&&c(T,!0)}}catch(x){o(x)}!s&&!u&&o(null,i)}function c(C,A){if(C=a(C)||C,!(i.files.indexOf(C)>-1)){if(i.files.push(C),C in $o){s?l(C,$o[C]):(++u,setTimeout(function(){--u,l(C,$o[C])}));return}if(s){var I;try{I=Mr.fs.readFileSync(C).toString("utf8")}catch(T){A||o(T);return}l(C,I)}else++u,i.fetch(C,function(T,P){if(--u,!!r){if(T){A?u||o(null,i):o(T);return}l(C,P)}})}}var u=0;Mr.isString(e)&&(e=[e]);for(var p=0,g;p<e.length;++p)(g=i.resolvePath("",e[p]))&&c(g);if(s)return i;u||o(null,i)};Mt.prototype.loadSync=function(e,t){if(!Mr.isNode)throw Error("not supported");return this.load(e,t,MC)};Mt.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return ic.prototype.resolveAll.call(this)};var rc=/^[A-Z]/;function RC(n,e){var t=e.parent.lookup(e.extend);if(t){var r=new If(e.fullName,e.id,e.type,e.rule,void 0,e.options);return t.get(r.name)||(r.declaringField=e,e.extensionField=r,t.add(r)),!0}return!1}Mt.prototype._handleAdd=function(e){if(e instanceof If)e.extend!==void 0&&!e.extensionField&&(RC(this,e)||this.deferred.push(e));else if(e instanceof kC)rc.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof oR)){if(e instanceof OC)for(var t=0;t<this.deferred.length;)RC(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);rc.test(e.name)&&(e.parent[e.name]=e)}};Mt.prototype._handleRemove=function(e){if(e instanceof If){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof kC)rc.test(e.name)&&delete e.parent[e.name];else if(e instanceof ic){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);rc.test(e.name)&&delete e.parent[e.name]}};Mt._configure=function(n,e,t){OC=n,Af=e,$o=t}});var Je=D((J4,FC)=>{"use strict";var Ue=FC.exports=Dn(),NC=rf(),Df,xf;Ue.codegen=eC();Ue.fetch=nC();Ue.path=sC();Ue.fs=Ue.inquire("fs");Ue.toArray=function(e){if(e){for(var t=Object.keys(e),r=new Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]};Ue.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(t[i]=s)}return t};var aR=/\\/g,lR=/"/g;Ue.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Ue.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Ue.isReserved(e)?'["'+e.replace(aR,"\\\\").replace(lR,'\\"')+'"]':"."+e};Ue.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var cR=/_([a-z])/g;Ue.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(cR,function(t,r){return r.toUpperCase()})};Ue.compareFieldsById=function(e,t){return e.id-t.id};Ue.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(Ue.decorateRoot.remove(e.$type),e.$type.name=t,Ue.decorateRoot.add(e.$type)),e.$type;Df||(Df=nc());var r=new Df(t||e.name);return Ue.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var uR=0;Ue.decorateEnum=function(e){if(e.$type)return e.$type;xf||(xf=an());var t=new xf("Enum"+uR++,e);return Ue.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t};Ue.setProperty=function(e,t,r){function i(s,o,a){var l=o.shift();if(l==="__proto__"||l==="prototype")return s;if(o.length>0)s[l]=i(s[l]||{},o,a);else{var c=s[l];c&&(a=[].concat(c).concat(a)),s[l]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return t=t.split("."),i(e,t,r)};Object.defineProperty(Ue,"decorateRoot",{get:function(){return NC.decorated||(NC.decorated=new(sc()))}})});var yi=D((Z4,LC)=>{"use strict";LC.exports=Pt;Pt.className="ReflectionObject";var oc=Je(),ac;function Pt(n,e){if(!oc.isString(n))throw TypeError("name must be a string");if(e&&!oc.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=n,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Pt.prototype,{root:{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n}},fullName:{get:function(){for(var n=[this.name],e=this.parent;e;)n.unshift(e.name),e=e.parent;return n.join(".")}}});Pt.prototype.toJSON=function(){throw Error()};Pt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof ac&&t._handleAdd(this)};Pt.prototype.onRemove=function(e){var t=e.root;t instanceof ac&&t._handleRemove(this),this.parent=null,this.resolved=!1};Pt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ac&&(this.resolved=!0),this)};Pt.prototype.getOption=function(e){if(this.options)return this.options[e]};Pt.prototype.setOption=function(e,t,r){return(!r||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=t),this};Pt.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var o=s[e];oc.setProperty(o,r,t)}else s={},s[e]=oc.setProperty({},r,t),i.push(s)}else{var a={};a[e]=t,i.push(a)}return this};Pt.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this};Pt.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e};Pt._configure=function(n){ac=n}});var an=D((ez,UC)=>{"use strict";UC.exports=On;var VC=yi();((On.prototype=Object.create(VC.prototype)).constructor=On).className="Enum";var BC=ys(),lc=Je();function On(n,e,t,r,i,s){if(VC.call(this,n,t),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}On.fromJSON=function(e,t){var r=new On(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,r};On.prototype.toJSON=function(e){var t=e?!!e.keepComments:!1;return lc.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])};On.prototype.add=function(e,t,r,i){if(!lc.isString(e))throw TypeError("name must be a string");if(!lc.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this};On.prototype.remove=function(e){if(!lc.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};On.prototype.isReservedId=function(e){return BC.isReservedId(this.reserved,e)};On.prototype.isReservedName=function(e){return BC.isReservedName(this.reserved,e)}});var Tf=D((tz,zC)=>{"use strict";zC.exports=hR;var dR=an(),Rf=gi(),kf=Je();function qC(n,e,t,r){return e.resolvedType.group?n("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",t,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):n("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",t,r,(e.id<<3|2)>>>0)}function hR(n){for(var e=kf.codegen(["m","w"],n.name+"$encode")("if(!w)")("w=Writer.create()"),t,r,i=n.fieldsArray.slice().sort(kf.compareFieldsById),t=0;t<i.length;++t){var s=i[t].resolve(),o=n._fieldsArray.indexOf(s),a=s.resolvedType instanceof dR?"int32":s.type,l=Rf.basic[a];r="m"+kf.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Rf.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&Rf.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),l===void 0?qC(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,a,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),l===void 0?qC(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,a,r))}return e("return w")}});var GC=D((nz,jC)=>{"use strict";var oe=jC.exports=J_();oe.build="light";function fR(n,e,t){return typeof e=="function"?(t=e,e=new oe.Root):e||(e=new oe.Root),e.load(n,t)}oe.load=fR;function pR(n,e){return e||(e=new oe.Root),e.loadSync(n)}oe.loadSync=pR;oe.encoder=Tf();oe.decoder=pf();oe.verifier=yf();oe.converter=Cf();oe.ReflectionObject=yi();oe.Namespace=ys();oe.Root=sc();oe.Enum=an();oe.Type=nc();oe.Field=kr();oe.OneOf=ps();oe.MapField=Yl();oe.Service=Jl();oe.Method=Xl();oe.Message=Zl();oe.wrappers=Sf();oe.types=gi();oe.util=Je();oe.ReflectionObject._configure(oe.Root);oe.Namespace._configure(oe.Type,oe.Service,oe.Enum);oe.Root._configure(oe.Type);oe.Field._configure(oe.Type)});var Mf=D((rz,HC)=>{"use strict";HC.exports=WC;var Of=/[\s{}=;:[\],'"()<>]/g,mR=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,gR=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,yR=/^ *[*/]+ */,vR=/^\s*\*?\/*/,_R=/\n/g,CR=/\s/,SR=/\\(.?)/g,bR={0:"\0",r:"\r",n:`
`,t:"	"};function $C(n){return n.replace(SR,function(e,t){switch(t){case"\\":case"":return t;default:return bR[t]||""}})}WC.unescape=$C;function WC(n,e){n=n.toString();var t=0,r=n.length,i=1,s=0,o={},a=[],l=null;function c(F){return Error("illegal "+F+" (line "+i+")")}function u(){var F=l==="'"?gR:mR;F.lastIndex=t-1;var $=F.exec(n);if(!$)throw c("string");return t=F.lastIndex,T(l),l=null,$C($[1])}function p(F){return n.charAt(F)}function g(F,$,X){var _={type:n.charAt(F++),lineEmpty:!1,leading:X},m;e?m=2:m=3;var y=F-m,v;do if(--y<0||(v=n.charAt(y))===`
`){_.lineEmpty=!0;break}while(v===" "||v==="	");for(var h=n.substring(F,$).split(_R),S=0;S<h.length;++S)h[S]=h[S].replace(e?vR:yR,"").trim();_.text=h.join(`
`).trim(),o[i]=_,s=i}function C(F){var $=A(F),X=n.substring(F,$),_=/^\s*\/\//.test(X);return _}function A(F){for(var $=F;$<r&&p($)!==`
`;)$++;return $}function I(){if(a.length>0)return a.shift();if(l)return u();var F,$,X,_,m,y=t===0;do{if(t===r)return null;for(F=!1;CR.test(X=p(t));)if(X===`
`&&(y=!0,++i),++t===r)return null;if(p(t)==="/"){if(++t===r)throw c("comment");if(p(t)==="/")if(e){if(_=t,m=!1,C(t-1)){m=!0;do if(t=A(t),t===r||(t++,!y))break;while(C(t))}else t=Math.min(r,A(t)+1);m&&(g(_,t,y),y=!0),i++,F=!0}else{for(m=p(_=t+1)==="/";p(++t)!==`
`;)if(t===r)return null;++t,m&&(g(_,t-1,y),y=!0),++i,F=!0}else if((X=p(t))==="*"){_=t+1,m=e||p(_)==="*";do{if(X===`
`&&++i,++t===r)throw c("comment");$=X,X=p(t)}while($!=="*"||X!=="/");++t,m&&(g(_,t-2,y),y=!0),F=!0}else return"/"}}while(F);var v=t;Of.lastIndex=0;var h=Of.test(p(v++));if(!h)for(;v<r&&!Of.test(p(v));)++v;var S=n.substring(t,t=v);return(S==='"'||S==="'")&&(l=S),S}function T(F){a.push(F)}function P(){if(!a.length){var F=I();if(F===null)return null;T(F)}return a[0]}function x(F,$){var X=P(),_=X===F;if(_)return I(),!0;if(!$)throw c("token '"+X+"', '"+F+"' expected");return!1}function N(F){var $=null,X;return F===void 0?(X=o[i-1],delete o[i-1],X&&(e||X.type==="*"||X.lineEmpty)&&($=X.leading?X.text:null)):(s<F&&P(),X=o[F],delete o[F],X&&!X.lineEmpty&&(e||X.type==="/")&&($=X.leading?null:X.text)),$}return Object.defineProperty({next:I,peek:P,push:T,skip:x,cmnt:N},"line",{get:function(){return i}})}});var ZC=D((iz,JC)=>{"use strict";JC.exports=er;er.filename=null;er.defaults={keepCase:!1};var ER=Mf(),KC=sc(),QC=nc(),YC=kr(),wR=Yl(),XC=ps(),TR=an(),AR=Jl(),IR=Xl(),Pf=gi(),Nf=Je(),DR=/^[1-9][0-9]*$/,xR=/^-?[1-9][0-9]*$/,RR=/^0[x][0-9a-fA-F]+$/,kR=/^-?0[x][0-9a-fA-F]+$/,OR=/^0[0-7]+$/,MR=/^-?0[0-7]+$/,PR=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,Mn=/^[a-zA-Z_][a-zA-Z_0-9]*$/,Pn=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,NR=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function er(n,e,t){e instanceof KC||(t=e,e=new KC),t||(t=er.defaults);var r=t.preferTrailingComment||!1,i=ER(n,t.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,l=i.skip,c=i.cmnt,u=!0,p,g,C,A,I=!1,T=e,P=t.keepCase?function(O){return O}:Nf.camelCase;function x(O,M,B){var K=er.filename;return B||(er.filename=null),Error("illegal "+(M||"token")+" '"+O+"' ("+(K?K+", ":"")+"line "+i.line+")")}function N(){var O=[],M;do{if((M=s())!=='"'&&M!=="'")throw x(M);O.push(s()),l(M),M=a()}while(M==='"'||M==="'");return O.join("")}function F(O){var M=s();switch(M){case"'":case'"':return o(M),N();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return X(M,!0)}catch{if(O&&Pn.test(M))return M;throw x(M,"value")}}function $(O,M){var B,K;do M&&((B=a())==='"'||B==="'")?O.push(N()):O.push([K=_(s()),l("to",!0)?_(s()):K]);while(l(",",!0));var z={options:void 0};z.setOption=function(ne,ke){this.options===void 0&&(this.options={}),this.options[ne]=ke},S(z,function(ke){if(ke==="option")Ce(z,ke),l(";");else throw x(ke)},function(){tt(z)})}function X(O,M){var B=1;switch(O.charAt(0)==="-"&&(B=-1,O=O.substring(1)),O){case"inf":case"INF":case"Inf":return B*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(DR.test(O))return B*parseInt(O,10);if(RR.test(O))return B*parseInt(O,16);if(OR.test(O))return B*parseInt(O,8);if(PR.test(O))return B*parseFloat(O);throw x(O,"number",M)}function _(O,M){switch(O){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!M&&O.charAt(0)==="-")throw x(O,"id");if(xR.test(O))return parseInt(O,10);if(kR.test(O))return parseInt(O,16);if(MR.test(O))return parseInt(O,8);throw x(O,"id")}function m(){if(p!==void 0)throw x("package");if(p=s(),!Pn.test(p))throw x(p,"name");T=T.define(p),l(";")}function y(){var O=a(),M;switch(O){case"weak":M=C||(C=[]),s();break;case"public":s();default:M=g||(g=[]);break}O=N(),l(";"),M.push(O)}function v(){if(l("="),A=N(),I=A==="proto3",!I&&A!=="proto2")throw x(A,"syntax");e.setOption("syntax",A),l(";")}function h(O,M){switch(M){case"option":return Ce(O,M),l(";"),!0;case"message":return d(O,M),!0;case"enum":return ye(O,M),!0;case"service":return ze(O,M),!0;case"extend":return Vi(O,M),!0}return!1}function S(O,M,B){var K=i.line;if(O&&(typeof O.comment!="string"&&(O.comment=c()),O.filename=er.filename),l("{",!0)){for(var z;(z=s())!=="}";)M(z);l(";",!0)}else B&&B(),l(";"),O&&(typeof O.comment!="string"||r)&&(O.comment=c(K)||O.comment)}function d(O,M){if(!Mn.test(M=s()))throw x(M,"type name");var B=new QC(M);S(B,function(z){if(!h(B,z))switch(z){case"map":ae(B,z);break;case"required":case"repeated":f(B,z);break;case"optional":I?f(B,"proto3_optional"):f(B,"optional");break;case"oneof":Ae(B,z);break;case"extensions":$(B.extensions||(B.extensions=[]));break;case"reserved":$(B.reserved||(B.reserved=[]),!0);break;default:if(!I||!Pn.test(z))throw x(z);o(z),f(B,"optional");break}}),O.add(B)}function f(O,M,B){var K=s();if(K==="group"){U(O,M);return}for(;K.endsWith(".")||a().startsWith(".");)K+=s();if(!Pn.test(K))throw x(K,"type");var z=s();if(!Mn.test(z))throw x(z,"name");z=P(z),l("=");var ne=new YC(z,_(s()),K,M,B);if(S(ne,function(Dt){if(Dt==="option")Ce(ne,Dt),l(";");else throw x(Dt)},function(){tt(ne)}),M==="proto3_optional"){var ke=new XC("_"+z);ne.setOption("proto3_optional",!0),ke.add(ne),O.add(ke)}else O.add(ne);!I&&ne.repeated&&(Pf.packed[K]!==void 0||Pf.basic[K]===void 0)&&ne.setOption("packed",!1,!0)}function U(O,M){var B=s();if(!Mn.test(B))throw x(B,"name");var K=Nf.lcFirst(B);B===K&&(B=Nf.ucFirst(B)),l("=");var z=_(s()),ne=new QC(B);ne.group=!0;var ke=new YC(K,z,B,M);ke.filename=er.filename,S(ne,function(Dt){switch(Dt){case"option":Ce(ne,Dt),l(";");break;case"required":case"repeated":f(ne,Dt);break;case"optional":I?f(ne,"proto3_optional"):f(ne,"optional");break;case"message":d(ne,Dt);break;case"enum":ye(ne,Dt);break;default:throw x(Dt)}}),O.add(ne).add(ke)}function ae(O){l("<");var M=s();if(Pf.mapKey[M]===void 0)throw x(M,"type");l(",");var B=s();if(!Pn.test(B))throw x(B,"type");l(">");var K=s();if(!Mn.test(K))throw x(K,"name");l("=");var z=new wR(P(K),_(s()),M,B);S(z,function(ke){if(ke==="option")Ce(z,ke),l(";");else throw x(ke)},function(){tt(z)}),O.add(z)}function Ae(O,M){if(!Mn.test(M=s()))throw x(M,"name");var B=new XC(P(M));S(B,function(z){z==="option"?(Ce(B,z),l(";")):(o(z),f(B,"optional"))}),O.add(B)}function ye(O,M){if(!Mn.test(M=s()))throw x(M,"name");var B=new TR(M);S(B,function(z){switch(z){case"option":Ce(B,z),l(";");break;case"reserved":$(B.reserved||(B.reserved=[]),!0);break;default:Ve(B,z)}}),O.add(B)}function Ve(O,M){if(!Mn.test(M))throw x(M,"name");l("=");var B=_(s(),!0),K={options:void 0};K.setOption=function(z,ne){this.options===void 0&&(this.options={}),this.options[z]=ne},S(K,function(ne){if(ne==="option")Ce(K,ne),l(";");else throw x(ne)},function(){tt(K)}),O.add(M,B,K.comment,K.options)}function Ce(O,M){var B=l("(",!0);if(!Pn.test(M=s()))throw x(M,"name");var K=M,z=K,ne;B&&(l(")"),K="("+K+")",z=K,M=a(),NR.test(M)&&(ne=M.slice(1),K+=M,s())),l("=");var ke=ft(O,K);Pe(O,z,ke,ne)}function ft(O,M){if(l("{",!0)){for(var B={};!l("}",!0);){if(!Mn.test(it=s()))throw x(it,"name");if(it===null)throw x(it,"end of input");var K,z=it;if(l(":",!0),a()==="{")K=ft(O,M+"."+it);else if(a()==="["){K=[];var ne;if(l("[",!0)){do ne=F(!0),K.push(ne);while(l(",",!0));l("]"),typeof ne<"u"&&qe(O,M+"."+it,ne)}}else K=F(!0),qe(O,M+"."+it,K);var ke=B[z];ke&&(K=[].concat(ke).concat(K)),B[z]=K,l(",",!0),l(";",!0)}return B}var cr=F(!0);return qe(O,M,cr),cr}function qe(O,M,B){O.setOption&&O.setOption(M,B)}function Pe(O,M,B,K){O.setParsedOption&&O.setParsedOption(M,B,K)}function tt(O){if(l("[",!0)){do Ce(O,"option");while(l(",",!0));l("]")}return O}function ze(O,M){if(!Mn.test(M=s()))throw x(M,"service name");var B=new AR(M);S(B,function(z){if(!h(B,z))if(z==="rpc")pt(B,z);else throw x(z)}),O.add(B)}function pt(O,M){var B=c(),K=M;if(!Mn.test(M=s()))throw x(M,"name");var z=M,ne,ke,cr,Dt;if(l("("),l("stream",!0)&&(ke=!0),!Pn.test(M=s())||(ne=M,l(")"),l("returns"),l("("),l("stream",!0)&&(Dt=!0),!Pn.test(M=s())))throw x(M);cr=M,l(")");var Ba=new IR(z,K,ne,cr,ke,Dt);Ba.comment=B,S(Ba,function(sd){if(sd==="option")Ce(Ba,sd),l(";");else throw x(sd)}),O.add(Ba)}function Vi(O,M){if(!Pn.test(M=s()))throw x(M,"reference");var B=M;S(null,function(z){switch(z){case"required":case"repeated":f(O,z,B);break;case"optional":I?f(O,"proto3_optional",B):f(O,"optional",B);break;default:if(!I||!Pn.test(z))throw x(z);o(z),f(O,"optional",B);break}})}for(var it;(it=s())!==null;)switch(it){case"package":if(!u)throw x(it);m();break;case"import":if(!u)throw x(it);y();break;case"syntax":if(!u)throw x(it);v();break;case"option":Ce(T,it),l(";");break;default:if(h(T,it)){u=!1;continue}throw x(it)}return er.filename=null,{package:p,imports:g,weakImports:C,syntax:A,root:e}}});var nS=D((sz,tS)=>{"use strict";tS.exports=cn;var FR=/\/|\./;function cn(n,e){FR.test(n)||(n="google/protobuf/"+n+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),cn[n]=e}cn("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var eS;cn("duration",{Duration:eS={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});cn("timestamp",{Timestamp:eS});cn("empty",{Empty:{fields:{}}});cn("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});cn("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});cn("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});cn.get=function(e){return cn[e]||null}});var iS=D((oz,rS)=>{"use strict";var Pr=rS.exports=GC();Pr.build="full";Pr.tokenize=Mf();Pr.parse=ZC();Pr.common=nS();Pr.Root._configure(Pr.Type,Pr.parse,Pr.common)});var cc=D((az,sS)=>{"use strict";sS.exports=iS()});var Ff=D((lz,LR)=>{LR.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var uS=D((re,cS)=>{"use strict";var _t=cc();cS.exports=re=_t.descriptor=_t.Root.fromJSON(Ff()).lookup(".google.protobuf");var oS=_t.Namespace,Wo=_t.Root,tr=_t.Enum,Nr=_t.Type,Fr=_t.Field,VR=_t.MapField,uc=_t.OneOf,Ho=_t.Service,dc=_t.Method;Wo.fromDescriptor=function(e){typeof e.length=="number"&&(e=re.FileDescriptorSet.decode(e));var t=new Wo;if(e.file)for(var r,i,s=0,o;s<e.file.length;++s){if(i=t,(r=e.file[s]).package&&r.package.length&&(i=t.define(r.package)),r.name&&r.name.length&&t.files.push(i.filename=r.name),r.messageType)for(o=0;o<r.messageType.length;++o)i.add(Nr.fromDescriptor(r.messageType[o],r.syntax));if(r.enumType)for(o=0;o<r.enumType.length;++o)i.add(tr.fromDescriptor(r.enumType[o]));if(r.extension)for(o=0;o<r.extension.length;++o)i.add(Fr.fromDescriptor(r.extension[o]));if(r.service)for(o=0;o<r.service.length;++o)i.add(Ho.fromDescriptor(r.service[o]));var a=_s(r.options,re.FileOptions);if(a){var l=Object.keys(a);for(o=0;o<l.length;++o)i.setOption(l[o],a[l[o]])}}return t};Wo.prototype.toDescriptor=function(e){var t=re.FileDescriptorSet.create();return aS(this,t.file,e),t};function aS(n,e,t){var r=re.FileDescriptorProto.create({name:n.filename||(n.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});t&&(r.syntax=t),n instanceof Wo||(r.package=n.fullName.substring(1));for(var i=0,s;i<n.nestedArray.length;++i)(s=n._nestedArray[i])instanceof Nr?r.messageType.push(s.toDescriptor(t)):s instanceof tr?r.enumType.push(s.toDescriptor()):s instanceof Fr?r.extension.push(s.toDescriptor(t)):s instanceof Ho?r.service.push(s.toDescriptor()):s instanceof oS&&aS(s,e,t);r.options=Cs(n.options,re.FileOptions),r.messageType.length+r.enumType.length+r.extension.length+r.service.length&&e.push(r)}var BR=0;Nr.fromDescriptor=function(e,t){typeof e.length=="number"&&(e=re.DescriptorProto.decode(e));var r=new Nr(e.name.length?e.name:"Type"+BR++,_s(e.options,re.MessageOptions)),i;if(e.oneofDecl)for(i=0;i<e.oneofDecl.length;++i)r.add(uc.fromDescriptor(e.oneofDecl[i]));if(e.field)for(i=0;i<e.field.length;++i){var s=Fr.fromDescriptor(e.field[i],t);r.add(s),e.field[i].hasOwnProperty("oneofIndex")&&r.oneofsArray[e.field[i].oneofIndex].add(s)}if(e.extension)for(i=0;i<e.extension.length;++i)r.add(Fr.fromDescriptor(e.extension[i],t));if(e.nestedType)for(i=0;i<e.nestedType.length;++i)r.add(Nr.fromDescriptor(e.nestedType[i],t)),e.nestedType[i].options&&e.nestedType[i].options.mapEntry&&r.setOption("map_entry",!0);if(e.enumType)for(i=0;i<e.enumType.length;++i)r.add(tr.fromDescriptor(e.enumType[i]));if(e.extensionRange&&e.extensionRange.length)for(r.extensions=[],i=0;i<e.extensionRange.length;++i)r.extensions.push([e.extensionRange[i].start,e.extensionRange[i].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(r.reserved=[],e.reservedRange)for(i=0;i<e.reservedRange.length;++i)r.reserved.push([e.reservedRange[i].start,e.reservedRange[i].end]);if(e.reservedName)for(i=0;i<e.reservedName.length;++i)r.reserved.push(e.reservedName[i])}return r};Nr.prototype.toDescriptor=function(e){var t=re.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;if(t.field.push(i=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof VR){var s=Lf(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType),o=Lf(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType),a=o===11||o===14?this._fieldsArray[r].resolvedType&&lS(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;t.nestedType.push(re.DescriptorProto.create({name:i.typeName,field:[re.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),re.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:re.MessageOptions.create({mapEntry:!0})}))}}for(r=0;r<this.oneofsArray.length;++r)t.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof Fr?t.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof Nr?t.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof tr&&t.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)t.extensionRange.push(re.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)typeof this.reserved[r]=="string"?t.reservedName.push(this.reserved[r]):t.reservedRange.push(re.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return t.options=Cs(this.options,re.MessageOptions),t};var UR=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;Fr.fromDescriptor=function(e,t){if(typeof e.length=="number"&&(e=re.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var r;e.typeName&&e.typeName.length?r=e.typeName:r=$R(e.type);var i;switch(e.label){case 1:i=void 0;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new Fr(e.name.length?e.name:"field"+e.number,e.number,r,i,s);if(o.options=_s(e.options,re.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var l=UR.exec(a);l&&(a=parseInt(a));break}o.setOption("default",a)}return WR(e.type)&&(t==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};Fr.prototype.toDescriptor=function(e){var t=re.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=_t.util.ucFirst(this.name),t.label=3;else{switch(t.type=Lf(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:t.typeName=this.resolvedType?lS(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":t.label=3;break;case"required":t.label=2;break;default:t.label=1;break}}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=Cs(this.options,re.FieldOptions),this.options.default!=null&&(t.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((t.options||(t.options=re.FieldOptions.create())).packed=!1):this.packed&&((t.options||(t.options=re.FieldOptions.create())).packed=!0),t};var qR=0;tr.fromDescriptor=function(e){typeof e.length=="number"&&(e=re.EnumDescriptorProto.decode(e));var t={};if(e.value)for(var r=0;r<e.value.length;++r){var i=e.value[r].name,s=e.value[r].number||0;t[i&&i.length?i:"NAME"+s]=s}return new tr(e.name&&e.name.length?e.name:"Enum"+qR++,t,_s(e.options,re.EnumOptions))};tr.prototype.toDescriptor=function(){for(var e=[],t=0,r=Object.keys(this.values);t<r.length;++t)e.push(re.EnumValueDescriptorProto.create({name:r[t],number:this.values[r[t]]}));return re.EnumDescriptorProto.create({name:this.name,value:e,options:Cs(this.options,re.EnumOptions)})};var zR=0;uc.fromDescriptor=function(e){return typeof e.length=="number"&&(e=re.OneofDescriptorProto.decode(e)),new uc(e.name&&e.name.length?e.name:"oneof"+zR++)};uc.prototype.toDescriptor=function(){return re.OneofDescriptorProto.create({name:this.name})};var jR=0;Ho.fromDescriptor=function(e){typeof e.length=="number"&&(e=re.ServiceDescriptorProto.decode(e));var t=new Ho(e.name&&e.name.length?e.name:"Service"+jR++,_s(e.options,re.ServiceOptions));if(e.method)for(var r=0;r<e.method.length;++r)t.add(dc.fromDescriptor(e.method[r]));return t};Ho.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return re.ServiceDescriptorProto.create({name:this.name,method:e,options:Cs(this.options,re.ServiceOptions)})};var GR=0;dc.fromDescriptor=function(e){return typeof e.length=="number"&&(e=re.MethodDescriptorProto.decode(e)),new dc(e.name&&e.name.length?e.name:"Method"+GR++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,_s(e.options,re.MethodOptions))};dc.prototype.toDescriptor=function(){return re.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Cs(this.options,re.MethodOptions)})};function $R(n){switch(n){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+n)}function WR(n){switch(n){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function Lf(n,e){switch(n){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof tr)return 14;if(e instanceof Nr)return e.group?10:11;throw Error("illegal type: "+n)}function _s(n,e){if(n){for(var t=[],r=0,i,s,o;r<e.fieldsArray.length;++r)(s=(i=e._fieldsArray[r]).name)!=="uninterpretedOption"&&n.hasOwnProperty(s)&&(o=n[s],i.resolvedType instanceof tr&&typeof o=="number"&&i.resolvedType.valuesById[o]!==void 0&&(o=i.resolvedType.valuesById[o]),t.push(HR(s),o));return t.length?_t.util.toObject(t):void 0}}function Cs(n,e){if(n){for(var t=[],r=0,i=Object.keys(n),s,o;r<i.length;++r)if(o=n[s=i[r]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=_t.util.camelCase(s)])||t.push(s,o)}return t.length?e.fromObject(_t.util.toObject(t)):void 0}}function lS(n,e){var t=n.fullName.split("."),r=e.fullName.split("."),i=0,s=0,o=r.length-1;if(!(n instanceof Wo)&&e instanceof oS)for(;i<t.length&&s<o&&t[i]===r[s];){var a=e.lookup(t[i++],!0);if(a!==null&&a!==e)break;++s}else for(;i<t.length&&s<o&&t[i]===r[s];++i,++s);return r.slice(s).join(".")}function HR(n){return n.substring(0,1)+n.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}});var dS=D((cz,KR)=>{KR.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var hS=D((uz,QR)=>{QR.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var fS=D((dz,YR)=>{YR.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var yS=D(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.addCommonProtos=Lr.loadProtosWithOptionsSync=Lr.loadProtosWithOptions=void 0;var pS=pe("fs"),mS=pe("path"),Ss=cc();function gS(n,e){let t=n.resolvePath;n.resolvePath=(r,i)=>{if(mS.isAbsolute(i))return i;for(let s of e){let o=mS.join(s,i);try{return pS.accessSync(o,pS.constants.R_OK),o}catch{continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),t(r,i)}}function XR(n,e){return R(this,null,function*(){let t=new Ss.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));gS(t,e.includeDirs)}let r=yield t.load(n,e);return r.resolveAll(),r})}Lr.loadProtosWithOptions=XR;function JR(n,e){let t=new Ss.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");gS(t,e.includeDirs)}let r=t.loadSync(n,e);return r.resolveAll(),r}Lr.loadProtosWithOptionsSync=JR;function ZR(){let n=dS(),e=Ff(),t=hS(),r=fS();Ss.common("api",n.nested.google.nested.protobuf.nested),Ss.common("descriptor",e.nested.google.nested.protobuf.nested),Ss.common("source_context",t.nested.google.nested.protobuf.nested),Ss.common("type",r.nested.google.nested.protobuf.nested)}Lr.addCommonProtos=ZR});var CS=D((_S,Vf)=>{"use strict";var vS=function(n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(d,f,U){this.low=d|0,this.high=f|0,this.unsigned=!!U}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function r(d){return(d&&d.__isLong__)===!0}function i(d){var f=Math.clz32(d&-d);return d?31-f:f}t.isLong=r;var s={},o={};function a(d,f){var U,ae,Ae;return f?(d>>>=0,(Ae=0<=d&&d<256)&&(ae=o[d],ae)?ae:(U=c(d,0,!0),Ae&&(o[d]=U),U)):(d|=0,(Ae=-128<=d&&d<128)&&(ae=s[d],ae)?ae:(U=c(d,d<0?-1:0,!1),Ae&&(s[d]=U),U))}t.fromInt=a;function l(d,f){if(isNaN(d))return f?F:N;if(f){if(d<0)return F;if(d>=T)return y}else{if(d<=-P)return v;if(d+1>=P)return m}return d<0?l(-d,f).neg():c(d%I|0,d/I|0,f)}t.fromNumber=l;function c(d,f,U){return new t(d,f,U)}t.fromBits=c;var u=Math.pow;function p(d,f,U){if(d.length===0)throw Error("empty string");if(typeof f=="number"?(U=f,f=!1):f=!!f,d==="NaN"||d==="Infinity"||d==="+Infinity"||d==="-Infinity")return f?F:N;if(U=U||10,U<2||36<U)throw RangeError("radix");var ae;if((ae=d.indexOf("-"))>0)throw Error("interior hyphen");if(ae===0)return p(d.substring(1),f,U).neg();for(var Ae=l(u(U,8)),ye=N,Ve=0;Ve<d.length;Ve+=8){var Ce=Math.min(8,d.length-Ve),ft=parseInt(d.substring(Ve,Ve+Ce),U);if(Ce<8){var qe=l(u(U,Ce));ye=ye.mul(qe).add(l(ft))}else ye=ye.mul(Ae),ye=ye.add(l(ft))}return ye.unsigned=f,ye}t.fromString=p;function g(d,f){return typeof d=="number"?l(d,f):typeof d=="string"?p(d,f):c(d.low,d.high,typeof f=="boolean"?f:d.unsigned)}t.fromValue=g;var C=65536,A=1<<24,I=C*C,T=I*I,P=T/2,x=a(A),N=a(0);t.ZERO=N;var F=a(0,!0);t.UZERO=F;var $=a(1);t.ONE=$;var X=a(1,!0);t.UONE=X;var _=a(-1);t.NEG_ONE=_;var m=c(-1,2147483647,!1);t.MAX_VALUE=m;var y=c(-1,-1,!0);t.MAX_UNSIGNED_VALUE=y;var v=c(0,-2147483648,!1);t.MIN_VALUE=v;var h=t.prototype;h.toInt=function(){return this.unsigned?this.low>>>0:this.low},h.toNumber=function(){return this.unsigned?(this.high>>>0)*I+(this.low>>>0):this.high*I+(this.low>>>0)},h.toString=function(f){if(f=f||10,f<2||36<f)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(v)){var U=l(f),ae=this.div(U),Ae=ae.mul(U).sub(this);return ae.toString(f)+Ae.toInt().toString(f)}else return"-"+this.neg().toString(f);for(var ye=l(u(f,6),this.unsigned),Ve=this,Ce="";;){var ft=Ve.div(ye),qe=Ve.sub(ft.mul(ye)).toInt()>>>0,Pe=qe.toString(f);if(Ve=ft,Ve.isZero())return Pe+Ce;for(;Pe.length<6;)Pe="0"+Pe;Ce=""+Pe+Ce}},h.getHighBits=function(){return this.high},h.getHighBitsUnsigned=function(){return this.high>>>0},h.getLowBits=function(){return this.low},h.getLowBitsUnsigned=function(){return this.low>>>0},h.getNumBitsAbs=function(){if(this.isNegative())return this.eq(v)?64:this.neg().getNumBitsAbs();for(var f=this.high!=0?this.high:this.low,U=31;U>0&&!(f&1<<U);U--);return this.high!=0?U+33:U+1},h.isZero=function(){return this.high===0&&this.low===0},h.eqz=h.isZero,h.isNegative=function(){return!this.unsigned&&this.high<0},h.isPositive=function(){return this.unsigned||this.high>=0},h.isOdd=function(){return(this.low&1)===1},h.isEven=function(){return(this.low&1)===0},h.equals=function(f){return r(f)||(f=g(f)),this.unsigned!==f.unsigned&&this.high>>>31===1&&f.high>>>31===1?!1:this.high===f.high&&this.low===f.low},h.eq=h.equals,h.notEquals=function(f){return!this.eq(f)},h.neq=h.notEquals,h.ne=h.notEquals,h.lessThan=function(f){return this.comp(f)<0},h.lt=h.lessThan,h.lessThanOrEqual=function(f){return this.comp(f)<=0},h.lte=h.lessThanOrEqual,h.le=h.lessThanOrEqual,h.greaterThan=function(f){return this.comp(f)>0},h.gt=h.greaterThan,h.greaterThanOrEqual=function(f){return this.comp(f)>=0},h.gte=h.greaterThanOrEqual,h.ge=h.greaterThanOrEqual,h.compare=function(f){if(r(f)||(f=g(f)),this.eq(f))return 0;var U=this.isNegative(),ae=f.isNegative();return U&&!ae?-1:!U&&ae?1:this.unsigned?f.high>>>0>this.high>>>0||f.high===this.high&&f.low>>>0>this.low>>>0?-1:1:this.sub(f).isNegative()?-1:1},h.comp=h.compare,h.negate=function(){return!this.unsigned&&this.eq(v)?v:this.not().add($)},h.neg=h.negate,h.add=function(f){r(f)||(f=g(f));var U=this.high>>>16,ae=this.high&65535,Ae=this.low>>>16,ye=this.low&65535,Ve=f.high>>>16,Ce=f.high&65535,ft=f.low>>>16,qe=f.low&65535,Pe=0,tt=0,ze=0,pt=0;return pt+=ye+qe,ze+=pt>>>16,pt&=65535,ze+=Ae+ft,tt+=ze>>>16,ze&=65535,tt+=ae+Ce,Pe+=tt>>>16,tt&=65535,Pe+=U+Ve,Pe&=65535,c(ze<<16|pt,Pe<<16|tt,this.unsigned)},h.subtract=function(f){return r(f)||(f=g(f)),this.add(f.neg())},h.sub=h.subtract,h.multiply=function(f){if(this.isZero())return this;if(r(f)||(f=g(f)),e){var U=e.mul(this.low,this.high,f.low,f.high);return c(U,e.get_high(),this.unsigned)}if(f.isZero())return this.unsigned?F:N;if(this.eq(v))return f.isOdd()?v:N;if(f.eq(v))return this.isOdd()?v:N;if(this.isNegative())return f.isNegative()?this.neg().mul(f.neg()):this.neg().mul(f).neg();if(f.isNegative())return this.mul(f.neg()).neg();if(this.lt(x)&&f.lt(x))return l(this.toNumber()*f.toNumber(),this.unsigned);var ae=this.high>>>16,Ae=this.high&65535,ye=this.low>>>16,Ve=this.low&65535,Ce=f.high>>>16,ft=f.high&65535,qe=f.low>>>16,Pe=f.low&65535,tt=0,ze=0,pt=0,Vi=0;return Vi+=Ve*Pe,pt+=Vi>>>16,Vi&=65535,pt+=ye*Pe,ze+=pt>>>16,pt&=65535,pt+=Ve*qe,ze+=pt>>>16,pt&=65535,ze+=Ae*Pe,tt+=ze>>>16,ze&=65535,ze+=ye*qe,tt+=ze>>>16,ze&=65535,ze+=Ve*ft,tt+=ze>>>16,ze&=65535,tt+=ae*Pe+Ae*qe+ye*ft+Ve*Ce,tt&=65535,c(pt<<16|Vi,tt<<16|ze,this.unsigned)},h.mul=h.multiply,h.divide=function(f){if(r(f)||(f=g(f)),f.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&f.low===-1&&f.high===-1)return this;var U=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,f.low,f.high);return c(U,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?F:N;var ae,Ae,ye;if(this.unsigned){if(f.unsigned||(f=f.toUnsigned()),f.gt(this))return F;if(f.gt(this.shru(1)))return X;ye=F}else{if(this.eq(v)){if(f.eq($)||f.eq(_))return v;if(f.eq(v))return $;var Ve=this.shr(1);return ae=Ve.div(f).shl(1),ae.eq(N)?f.isNegative()?$:_:(Ae=this.sub(f.mul(ae)),ye=ae.add(Ae.div(f)),ye)}else if(f.eq(v))return this.unsigned?F:N;if(this.isNegative())return f.isNegative()?this.neg().div(f.neg()):this.neg().div(f).neg();if(f.isNegative())return this.div(f.neg()).neg();ye=N}for(Ae=this;Ae.gte(f);){ae=Math.max(1,Math.floor(Ae.toNumber()/f.toNumber()));for(var Ce=Math.ceil(Math.log(ae)/Math.LN2),ft=Ce<=48?1:u(2,Ce-48),qe=l(ae),Pe=qe.mul(f);Pe.isNegative()||Pe.gt(Ae);)ae-=ft,qe=l(ae,this.unsigned),Pe=qe.mul(f);qe.isZero()&&(qe=$),ye=ye.add(qe),Ae=Ae.sub(Pe)}return ye},h.div=h.divide,h.modulo=function(f){if(r(f)||(f=g(f)),e){var U=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,f.low,f.high);return c(U,e.get_high(),this.unsigned)}return this.sub(this.div(f).mul(f))},h.mod=h.modulo,h.rem=h.modulo,h.not=function(){return c(~this.low,~this.high,this.unsigned)},h.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},h.clz=h.countLeadingZeros,h.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},h.ctz=h.countTrailingZeros,h.and=function(f){return r(f)||(f=g(f)),c(this.low&f.low,this.high&f.high,this.unsigned)},h.or=function(f){return r(f)||(f=g(f)),c(this.low|f.low,this.high|f.high,this.unsigned)},h.xor=function(f){return r(f)||(f=g(f)),c(this.low^f.low,this.high^f.high,this.unsigned)},h.shiftLeft=function(f){return r(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low<<f,this.high<<f|this.low>>>32-f,this.unsigned):c(0,this.low<<f-32,this.unsigned)},h.shl=h.shiftLeft,h.shiftRight=function(f){return r(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low>>>f|this.high<<32-f,this.high>>f,this.unsigned):c(this.high>>f-32,this.high>=0?0:-1,this.unsigned)},h.shr=h.shiftRight,h.shiftRightUnsigned=function(f){return r(f)&&(f=f.toInt()),(f&=63)===0?this:f<32?c(this.low>>>f|this.high<<32-f,this.high>>>f,this.unsigned):f===32?c(this.high,0,this.unsigned):c(this.high>>>f-32,0,this.unsigned)},h.shru=h.shiftRightUnsigned,h.shr_u=h.shiftRightUnsigned,h.rotateLeft=function(f){var U;return r(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?c(this.high,this.low,this.unsigned):f<32?(U=32-f,c(this.low<<f|this.high>>>U,this.high<<f|this.low>>>U,this.unsigned)):(f-=32,U=32-f,c(this.high<<f|this.low>>>U,this.low<<f|this.high>>>U,this.unsigned))},h.rotl=h.rotateLeft,h.rotateRight=function(f){var U;return r(f)&&(f=f.toInt()),(f&=63)===0?this:f===32?c(this.high,this.low,this.unsigned):f<32?(U=32-f,c(this.high<<U|this.low>>>f,this.low<<U|this.high>>>f,this.unsigned)):(f-=32,U=32-f,c(this.low<<U|this.high>>>f,this.high<<U|this.low>>>f,this.unsigned))},h.rotr=h.rotateRight,h.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},h.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},h.toBytes=function(f){return f?this.toBytesLE():this.toBytesBE()},h.toBytesLE=function(){var f=this.high,U=this.low;return[U&255,U>>>8&255,U>>>16&255,U>>>24,f&255,f>>>8&255,f>>>16&255,f>>>24]},h.toBytesBE=function(){var f=this.high,U=this.low;return[f>>>24,f>>>16&255,f>>>8&255,f&255,U>>>24,U>>>16&255,U>>>8&255,U&255]},t.fromBytes=function(f,U,ae){return ae?t.fromBytesLE(f,U):t.fromBytesBE(f,U)},t.fromBytesLE=function(f,U){return new t(f[0]|f[1]<<8|f[2]<<16|f[3]<<24,f[4]|f[5]<<8|f[6]<<16|f[7]<<24,U)},t.fromBytesBE=function(f,U){return new t(f[4]<<24|f[5]<<16|f[6]<<8|f[7],f[0]<<24|f[1]<<16|f[2]<<8|f[3],U)};var S=t;return n.default=S,"default"in n?n.default:n}({});typeof define=="function"&&define.amd?define([],function(){return vS}):typeof Vf=="object"&&typeof _S=="object"&&(Vf.exports=vS)});var zf=D(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.loadFileDescriptorSetFromObject=Ke.loadFileDescriptorSetFromBuffer=Ke.fromJSON=Ke.loadSync=Ke.load=Ke.IdempotencyLevel=Ke.isAnyExtension=Ke.Long=void 0;var ek=a_(),Nn=cc(),Uf=uS(),qf=yS(),tk=CS();Ke.Long=tk;function nk(n){return"@type"in n&&typeof n["@type"]=="string"}Ke.isAnyExtension=nk;var ES;(function(n){n.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",n.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",n.IDEMPOTENT="IDEMPOTENT"})(ES=Ke.IdempotencyLevel||(Ke.IdempotencyLevel={}));var wS={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function rk(n,e){return n===""?e:n+"."+e}function ik(n){return n instanceof Nn.Service||n instanceof Nn.Type||n instanceof Nn.Enum}function sk(n){return n instanceof Nn.Namespace||n instanceof Nn.Root}function TS(n,e){let t=rk(e,n.name);return ik(n)?[[t,n]]:sk(n)&&typeof n.nested<"u"?Object.keys(n.nested).map(r=>TS(n.nested[r],t)).reduce((r,i)=>r.concat(i),[]):[]}function SS(n,e){return function(r){return n.toObject(n.decode(r),e)}}function bS(n){return function(t){if(Array.isArray(t))throw new Error(`Failed to serialize message: expected object with ${n.name} structure, got array instead`);let r=n.fromObject(t);return n.encode(r).finish()}}function ok(n){return(n||[]).reduce((e,t)=>{for(let[r,i]of Object.entries(t))switch(r){case"uninterpreted_option":e.uninterpreted_option.push(t.uninterpreted_option);break;default:e[r]=i}return e},{deprecated:!1,idempotency_level:ES.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function ak(n,e,t,r){let i=n.resolvedRequestType,s=n.resolvedResponseType;return{path:"/"+e+"/"+n.name,requestStream:!!n.requestStream,responseStream:!!n.responseStream,requestSerialize:bS(i),requestDeserialize:SS(i,t),responseSerialize:bS(s),responseDeserialize:SS(s,t),originalName:ek(n.name),requestType:Bf(i,r),responseType:Bf(s,r),options:ok(n.parsedOptions)}}function lk(n,e,t,r){let i={};for(let s of n.methodsArray)i[s.name]=ak(s,e,t,r);return i}function Bf(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:t.$type.toObject(t,wS),fileDescriptorProtos:e}}function ck(n,e){let t=n.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:t.$type.toObject(t,wS),fileDescriptorProtos:e}}function uk(n,e,t,r){if(n instanceof Nn.Service)return lk(n,e,t,r);if(n instanceof Nn.Type)return Bf(n,r);if(n instanceof Nn.Enum)return ck(n,r);throw new Error("Type mismatch in reflection object handling")}function hc(n,e){let t={};n.resolveAll();let i=n.toDescriptor("proto3").file.map(s=>Buffer.from(Uf.FileDescriptorProto.encode(s).finish()));for(let[s,o]of TS(n,""))t[s]=uk(o,s,e,i);return t}function AS(n,e){e=e||{};let t=Nn.Root.fromDescriptor(n);return t.resolveAll(),hc(t,e)}function dk(n,e){return(0,qf.loadProtosWithOptions)(n,e).then(t=>hc(t,e))}Ke.load=dk;function hk(n,e){let t=(0,qf.loadProtosWithOptionsSync)(n,e);return hc(t,e)}Ke.loadSync=hk;function fk(n,e){e=e||{};let t=Nn.Root.fromJSON(n);return t.resolveAll(),hc(t,e)}Ke.fromJSON=fk;function pk(n,e){let t=Uf.FileDescriptorSet.decode(n);return AS(t,e)}Ke.loadFileDescriptorSetFromBuffer=pk;function mk(n,e){let t=Uf.FileDescriptorSet.fromObject(n);return AS(t,e)}Ke.loadFileDescriptorSetFromObject=mk;(0,qf.addCommonProtos)()});var _i=D(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.setup=xe.getChannelzServiceDefinition=xe.getChannelzHandlers=xe.unregisterChannelzRef=xe.registerChannelzSocket=xe.registerChannelzServer=xe.registerChannelzSubchannel=xe.registerChannelzChannel=xe.ChannelzCallTracker=xe.ChannelzChildrenTracker=xe.ChannelzTrace=void 0;var IS=pe("net"),Ko=zt(),Yo=fe(),gk=An(),yk=Ml(),vk=Vh();function jf(n){return{channel_id:n.id,name:n.name}}function Hf(n){return{subchannel_id:n.id,name:n.name}}function _k(n){return{server_id:n.id}}function pc(n){return{socket_id:n.id,name:n.name}}var DS=32,Gf=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:r?.kind==="channel"?r:void 0,childSubchannel:r?.kind==="subchannel"?r:void 0}),this.events.length>=DS*2&&(this.events=this.events.slice(DS)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:nr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:nr(e.timestamp),channel_ref:e.childChannel?jf(e.childChannel):null,subchannel_ref:e.childSubchannel?Hf(e.childSubchannel):null}))}}};xe.ChannelzTrace=Gf;var $f=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,i;switch(e.kind){case"channel":{let s=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);t!==void 0&&(t.count-=1,t.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let t=[];for(let{ref:i}of this.subchannelChildren.values())t.push(i);let r=[];for(let{ref:i}of this.socketChildren.values())r.push(i);return{channels:e,subchannels:t,sockets:r}}};xe.ChannelzChildrenTracker=$f;var Wf=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};xe.ChannelzCallTracker=Wf;var Ck=1;function mc(){return Ck++}var Qo=[],Kf=[],Vr=[],Qf=[];function Sk(n,e,t){let r=mc(),i={id:r,name:n,kind:"channel"};return t&&(Qo[r]={ref:i,getInfo:e}),i}xe.registerChannelzChannel=Sk;function bk(n,e,t){let r=mc(),i={id:r,name:n,kind:"subchannel"};return t&&(Kf[r]={ref:i,getInfo:e}),i}xe.registerChannelzSubchannel=bk;function Ek(n,e){let t=mc(),r={id:t,kind:"server"};return e&&(Vr[t]={ref:r,getInfo:n}),r}xe.registerChannelzServer=Ek;function wk(n,e,t){let r=mc(),i={id:r,name:n,kind:"socket"};return t&&(Qf[r]={ref:i,getInfo:e}),i}xe.registerChannelzSocket=wk;function Tk(n){switch(n.kind){case"channel":delete Qo[n.id];return;case"subchannel":delete Kf[n.id];return;case"server":delete Vr[n.id];return;case"socket":delete Qf[n.id];return}}xe.unregisterChannelzRef=Tk;function Ak(n){let e=Number.parseInt(n,16);return[e/256|0,e%256]}function xS(n){if(n==="")return[];let e=n.split(":").map(r=>Ak(r));return[].concat(...e)}function Ik(n){if((0,IS.isIPv4)(n))return Buffer.from(Uint8Array.from(n.split(".").map(e=>Number.parseInt(e))));if((0,IS.isIPv6)(n)){let e,t,r=n.indexOf("::");r===-1?(e=n,t=""):(e=n.substring(0,r),t=n.substring(r+2));let i=Buffer.from(xS(e)),s=Buffer.from(xS(t)),o=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,o,s])}else return null}function kS(n){switch(n){case Ko.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Ko.ConnectivityState.IDLE:return{state:"IDLE"};case Ko.ConnectivityState.READY:return{state:"READY"};case Ko.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Ko.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function nr(n){if(!n)return null;let e=n.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function OS(n){let e=n.getInfo();return{ref:jf(n.ref),data:{target:e.target,state:kS(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:nr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(t=>jf(t)),subchannel_ref:e.children.subchannels.map(t=>Hf(t))}}function Dk(n,e){let t=Number.parseInt(n.request.channel_id),r=Qo[t];if(r===void 0){e({code:Yo.Status.NOT_FOUND,details:"No channel data found for id "+t});return}e(null,{channel:OS(r)})}function xk(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_channel_id);for(;i<Qo.length;i++){let s=Qo[i];if(s!==void 0&&(r.push(OS(s)),r.length>=t))break}e(null,{channel:r,end:i>=Vr.length})}function MS(n){let e=n.getInfo();return{ref:_k(n.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:nr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(t=>pc(t))}}function Rk(n,e){let t=Number.parseInt(n.request.server_id),r=Vr[t];if(r===void 0){e({code:Yo.Status.NOT_FOUND,details:"No server data found for id "+t});return}e(null,{server:MS(r)})}function kk(n,e){let t=Number.parseInt(n.request.max_results),r=[],i=Number.parseInt(n.request.start_server_id);for(;i<Vr.length;i++){let s=Vr[i];if(s!==void 0&&(r.push(MS(s)),r.length>=t))break}e(null,{server:r,end:i>=Vr.length})}function Ok(n,e){let t=Number.parseInt(n.request.subchannel_id),r=Kf[t];if(r===void 0){e({code:Yo.Status.NOT_FOUND,details:"No subchannel data found for id "+t});return}let i=r.getInfo(),s={ref:Hf(r.ref),data:{target:i.target,state:kS(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:nr(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(o=>pc(o))};e(null,{subchannel:s})}function RS(n){var e;return(0,gk.isTcpSubchannelAddress)(n)?{address:"tcpip_address",tcpip_address:{ip_address:(e=Ik(n.host))!==null&&e!==void 0?e:void 0,port:n.port}}:{address:"uds_address",uds_address:{filename:n.path}}}function Mk(n,e){var t,r,i,s,o;let a=Number.parseInt(n.request.socket_id),l=Qf[a];if(l===void 0){e({code:Yo.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let c=l.getInfo(),u=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(t=c.security.cipherSuiteStandardName)!==null&&t!==void 0?t:void 0,other_name:(r=c.security.cipherSuiteOtherName)!==null&&r!==void 0?r:void 0,local_certificate:(i=c.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,p={ref:pc(l.ref),local:c.localAddress?RS(c.localAddress):null,remote:c.remoteAddress?RS(c.remoteAddress):null,remote_name:(o=c.remoteName)!==null&&o!==void 0?o:void 0,security:u,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:nr(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:nr(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:nr(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:nr(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:p})}function Pk(n,e){let t=Number.parseInt(n.request.server_id),r=Vr[t];if(r===void 0){e({code:Yo.Status.NOT_FOUND,details:"No server data found for id "+t});return}let i=Number.parseInt(n.request.start_socket_id),s=Number.parseInt(n.request.max_results),a=r.getInfo().sessionChildren.sockets.sort((u,p)=>u.id-p.id),l=[],c=0;for(;c<a.length&&!(a[c].id>=i&&(l.push(pc(a[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=a.length})}function PS(){return{GetChannel:Dk,GetTopChannels:xk,GetServer:Rk,GetServers:kk,GetSubchannel:Ok,GetSocket:Mk,GetServerSockets:Pk}}xe.getChannelzHandlers=PS;var fc=null;function NS(){if(fc)return fc;let n=zf().loadSync,e=n("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return fc=(0,vk.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,fc}xe.getChannelzServiceDefinition=NS;function Nk(){(0,yk.registerAdminService)(NS,PS)}xe.setup=Nk});var FS=D(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.Subchannel=void 0;var Ee=zt(),Fk=xo(),Yf=Fe(),gc=fe(),Lk=Ot(),Vk=An(),bs=_i(),Bk="subchannel",Uk=~(1<<31),Xf=class{constructor(e,t,r,i,s){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=i,this.connector=s,this.connectivityState=Ee.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new bs.ChannelzCallTracker,this.childrenTracker=new bs.ChannelzChildrenTracker,this.streamTracker=new bs.ChannelzCallTracker;let a={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new Fk.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Vk.subchannelAddressToString)(t),this.keepaliveTime=(o=r["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new bs.ChannelzTrace,this.channelzRef=(0,bs.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){Yf.trace(gc.LogVerbosity.DEBUG,Bk,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){Yf.trace(gc.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Ee.ConnectivityState.TRANSIENT_FAILURE],Ee.ConnectivityState.CONNECTING):this.transitionToState([Ee.ConnectivityState.TRANSIENT_FAILURE],Ee.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,Uk);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(t=>{this.transitionToState([Ee.ConnectivityState.CONNECTING],Ee.ConnectivityState.READY)?(this.transport=t,this.channelzEnabled&&this.childrenTracker.refChild(t.getChannelzRef()),t.addDisconnectListener(r=>{this.transitionToState([Ee.ConnectivityState.READY],Ee.ConnectivityState.IDLE),r&&this.keepaliveTime>0&&(this.keepaliveTime*=2,Yf.log(gc.LogVerbosity.ERROR,`Connection to ${(0,Lk.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):t.shutdown()},t=>{this.transitionToState([Ee.ConnectivityState.CONNECTING],Ee.ConnectivityState.TRANSIENT_FAILURE,`${t}`)})}transitionToState(e,t,r){var i,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Ee.ConnectivityState[this.connectivityState]+" -> "+Ee.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Ee.ConnectivityState[t]);let o=this.connectivityState;switch(this.connectivityState=t,t){case Ee.ConnectivityState.READY:this.stopBackoff();break;case Ee.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Ee.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Ee.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let a of this.stateListeners)a(this,o,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,bs.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Ee.ConnectivityState.CONNECTING,Ee.ConnectivityState.READY],Ee.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,t,r,i){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===gc.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,t,r,i,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Ee.ConnectivityState.IDLE],Ee.ConnectivityState.CONNECTING)||this.connectivityState===Ee.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Ee.ConnectivityState.TRANSIENT_FAILURE],Ee.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};yc.Subchannel=Xf});var tp=D(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.setup=qr.DEFAULT_PORT=void 0;var LS=wn(),BS=pe("dns"),US=pe("util"),qk=dh(),Jf=fe(),Zf=wt(),zk=Fe(),jk=fe(),Br=Ot(),VS=pe("net"),Gk=xo(),$k="dns_resolver";function Ur(n){zk.trace(jk.LogVerbosity.DEBUG,$k,n)}qr.DEFAULT_PORT=443;var Wk=3e4,Hk=US.promisify(BS.resolveTxt),Kk=US.promisify(BS.lookup);function Qk(...n){let e=[];for(let t=0;t<Math.max.apply(null,n.map(r=>r.length));t++)for(let r of n)t<r.length&&e.push(r[t]);return e}var ep=class{constructor(e,t,r){var i,s,o;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Ur("Resolver constructed for target "+(0,Br.uriToString)(e));let a=(0,Br.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,VS.isIPv4)(a.host)||(0,VS.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(i=a.port)!==null&&i!==void 0?i:qr.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:qr.DEFAULT_PORT),this.percentage=Math.random()*100,r["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:Jf.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Br.uriToString)(this.target)}`,metadata:new Zf.Metadata};let l={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new Gk.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=r["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:Wk,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Ur("Returning IP address for target "+(0,Br.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Ur("Failed to parse DNS address "+(0,Br.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:Jf.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Br.uriToString)(this.target)}`,metadata:new Zf.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Ur("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=Kk(e,{all:!0}),this.pendingLookupPromise.then(t=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let r=t.filter(o=>o.family===4),i=t.filter(o=>o.family===6);this.latestLookupResult=Qk(i,r).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Ur("Resolved addresses for target "+(0,Br.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},t=>{this.pendingLookupPromise!==null&&(Ur("Resolution error for target "+(0,Br.uriToString)(this.target)+": "+t.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=Hk(e),this.pendingTxtPromise.then(t=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,qk.extractAndSelectServiceConfig)(t,this.percentage)}catch(r){this.latestServiceConfigError={code:Jf.Status.UNAVAILABLE,details:`Parsing service config failed with error ${r.message}`,metadata:new Zf.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},t=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Ur('resolution update delayed by "min time between resolutions" rate limit'):Ur("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function Yk(){(0,LS.registerResolver)("dns",ep),(0,LS.registerDefaultScheme)("dns")}qr.setup=Yk});var np=D(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.getProxiedConnection=Ts.mapProxyName=void 0;var Xo=Fe(),Es=fe(),Xk=wn(),Jk=pe("http"),Zk=pe("tls"),eO=Fe(),qS=An(),ws=Ot(),tO=pe("url"),nO=tp(),rO="proxy";function zr(n){eO.trace(Es.LogVerbosity.DEBUG,rO,n)}function iO(){let n="",e="";if(process.env.grpc_proxy)e="grpc_proxy",n=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",n=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",n=process.env.http_proxy;else return{};let t;try{t=new tO.URL(n)}catch{return(0,Xo.log)(Es.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(t.protocol!=="http:")return(0,Xo.log)(Es.LogVerbosity.ERROR,`"${t.protocol}" scheme not supported in proxy URI`),{};let r=null;t.username&&(t.password?((0,Xo.log)(Es.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${t.username}:${t.password}`):r=t.username);let i=t.hostname,s=t.port;s===""&&(s="80");let o={address:`${i}:${s}`};return r&&(o.creds=r),zr("Proxy server "+o.address+" set by environment variable "+e),o}function sO(){let n=process.env.no_grpc_proxy,e="no_grpc_proxy";return n||(n=process.env.no_proxy,e="no_proxy"),n?(zr("No proxy server list set by environment variable "+e),n.split(",")):[]}function oO(n,e){var t;let r={target:n,extraOptions:{}};if(((t=e["grpc.enable_http_proxy"])!==null&&t!==void 0?t:1)===0||n.scheme==="unix")return r;let i=iO();if(!i.address)return r;let s=(0,ws.splitHostPort)(n.path);if(!s)return r;let o=s.host;for(let l of sO())if(l===o)return zr("Not using proxy for target in no_proxy list: "+(0,ws.uriToString)(n)),r;let a={"grpc.http_connect_target":(0,ws.uriToString)(n)};return i.creds&&(a["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:a}}Ts.mapProxyName=oO;function aO(n,e,t){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let i=e["grpc.http_connect_target"],s=(0,ws.parseUri)(i);if(s===null)return Promise.resolve({});let o=(0,ws.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(r=o.port)!==null&&r!==void 0?r:nO.DEFAULT_PORT}`,l={method:"CONNECT",path:a},c={Host:a};(0,qS.isTcpSubchannelAddress)(n)?(l.host=n.host,l.port=n.port):l.socketPath=n.path,"grpc.http_connect_creds"in e&&(c["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=c;let u=(0,qS.subchannelAddressToString)(n);return zr("Using proxy "+u+" to connect to "+l.path),new Promise((p,g)=>{let C=Jk.request(l);C.once("connect",(A,I,T)=>{var P;if(C.removeAllListeners(),I.removeAllListeners(),A.statusCode===200)if(zr("Successfully connected to "+l.path+" through proxy "+u),"secureContext"in t){let x=(0,Xk.getDefaultAuthority)(s),N=(0,ws.splitHostPort)(x),F=(P=N?.host)!==null&&P!==void 0?P:x,$=Zk.connect(Object.assign({host:F,servername:F,socket:I},t),()=>{zr("Successfully established a TLS connection to "+l.path+" through proxy "+u),p({socket:$,realTarget:s})});$.on("error",X=>{zr("Failed to establish a TLS connection to "+l.path+" through proxy "+u+" with error "+X.message),g()})}else zr("Successfully established a plaintext connection to "+l.path+" through proxy "+u),p({socket:I,realTarget:s});else(0,Xo.log)(Es.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+u+" with status "+A.statusCode),g()}),C.once("error",A=>{C.removeAllListeners(),(0,Xo.log)(Es.LogVerbosity.ERROR,"Failed to connect to proxy "+u+" with error "+A.message),g()}),C.end()})}Ts.getProxiedConnection=aO});var ip=D(vc=>{"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.StreamDecoder=void 0;var rr=function(n){return n[n.NO_DATA=0]="NO_DATA",n[n.READING_SIZE=1]="READING_SIZE",n[n.READING_MESSAGE=2]="READING_MESSAGE",n}(rr||{}),rp=class{constructor(e){this.maxReadMessageLength=e,this.readState=rr.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t=0,r,i=[];for(;t<e.length;)switch(this.readState){case rr.NO_DATA:this.readCompressFlag=e.slice(t,t+1),t+=1,this.readState=rr.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case rr.READING_SIZE:if(r=Math.min(e.length-t,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+r),this.readSizeRemaining-=r,t+=r,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=rr.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=rr.NO_DATA,i.push(s)}}break;case rr.READING_MESSAGE:if(r=Math.min(e.length-t,this.readMessageRemaining),this.readPartialMessage.push(e.slice(t,t+r)),this.readMessageRemaining-=r,t+=r,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=rr.NO_DATA,i.push(o)}break;default:throw new Error("Unexpected read state")}return i}};vc.StreamDecoder=rp});var zS=D(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.Http2SubchannelCall=void 0;var ir=pe("http2"),lO=pe("os"),me=fe(),jr=wt(),cO=ip(),uO=Fe(),dO=fe(),hO="subchannel_call";function fO(n){for(let[e,t]of Object.entries(lO.constants.errno))if(t===n)return e;return"Unknown system error "+n}var sp=class{constructor(e,t,r,i,s){var o;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=i,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=me.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;let a=(o=i.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:me.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new cO.StreamDecoder(a),e.on("response",(l,c)=>{let u="";for(let p of Object.keys(l))u+="		"+p+": "+l[p]+`
`;switch(this.trace(`Received server headers:
`+u),l[":status"]){case 400:this.mappedStatusCode=me.Status.INTERNAL;break;case 401:this.mappedStatusCode=me.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=me.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=me.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=me.Status.UNAVAILABLE;break;default:this.mappedStatusCode=me.Status.UNKNOWN}if(c&ir.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(l);else{let p;try{p=jr.Metadata.fromHttp2Headers(l)}catch(g){this.endCall({code:me.Status.UNKNOWN,details:g.message,metadata:new jr.Metadata});return}this.listener.onReceiveMetadata(p)}}),e.on("trailers",l=>{this.handleTrailers(l)}),e.on("data",l=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+l.length);let c;try{c=this.decoder.write(l)}catch(u){this.cancelWithStatus(me.Status.RESOURCE_EXHAUSTED,u.message);return}for(let u of c)this.trace("parsed message of length "+u.length),this.callEventTracker.addMessageReceived(),this.tryPush(u)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var l;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((l=this.finalStatus)===null||l===void 0?void 0:l.code)===me.Status.OK)return;let c,u="";switch(e.rstCode){case ir.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;c=me.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`;break;case ir.constants.NGHTTP2_REFUSED_STREAM:c=me.Status.UNAVAILABLE,u="Stream refused by server";break;case ir.constants.NGHTTP2_CANCEL:c=me.Status.CANCELLED,u="Call cancelled";break;case ir.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=me.Status.RESOURCE_EXHAUSTED,u="Bandwidth exhausted or memory limit exceeded";break;case ir.constants.NGHTTP2_INADEQUATE_SECURITY:c=me.Status.PERMISSION_DENIED,u="Protocol not secure enough";break;case ir.constants.NGHTTP2_INTERNAL_ERROR:c=me.Status.INTERNAL,this.internalError===null?u=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(c=me.Status.UNAVAILABLE,u=this.internalError.message):u=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=me.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:c,details:u,metadata:new jr.Metadata,rstCode:e.rstCode})})}),e.on("error",l=>{l.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+l.message+" code="+l.code+" errno="+fO(l.errno)+" syscall="+l.syscall),this.internalError=l),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:me.Status.UNAVAILABLE,details:"Connection dropped",metadata:new jr.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){uO.trace(dO.LogVerbosity.DEBUG,hO,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===me.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==me.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let t="";for(let l of Object.keys(e))t+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+t);let r;try{r=jr.Metadata.fromHttp2Headers(e)}catch{r=new jr.Metadata}let i=r.getMap(),s=this.mappedStatusCode;if(s===me.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let l=Number(i["grpc-status"]);l in me.Status&&(s=l,this.trace("received status code "+l+" from server")),r.remove("grpc-status")}let o="";if(typeof i["grpc-message"]=="string"){try{o=decodeURI(i["grpc-message"])}catch{o=i["grpc-message"]}r.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:r};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===me.Status.OK?t=ir.constants.NGHTTP2_NO_ERROR:t=ir.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new jr.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==me.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=i=>{process.nextTick(()=>{var s;let o=me.Status.UNAVAILABLE;i?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=me.Status.INTERNAL),i&&this.cancelWithStatus(o,`Write error: ${i.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(i){this.endCall({code:me.Status.UNAVAILABLE,details:`Write failed with error ${i.message}`,metadata:new jr.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};_c.Http2SubchannelCall=sp});var op=D(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.getNextCallNumber=void 0;var pO=0;function mO(){return pO++}Cc.getNextCallNumber=mO});var $S=D(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.Http2SubchannelConnector=void 0;var dp=pe("http2"),jS=pe("tls"),ap=_i(),Jo=fe(),gO=np(),Is=Fe(),GS=wn(),Sc=An(),As=Ot(),yO=pe("net"),vO=zS(),_O=op(),lp="transport",CO="transport_flowctrl",SO=Hd().version,{HTTP2_HEADER_AUTHORITY:bO,HTTP2_HEADER_CONTENT_TYPE:EO,HTTP2_HEADER_METHOD:wO,HTTP2_HEADER_PATH:TO,HTTP2_HEADER_TE:AO,HTTP2_HEADER_USER_AGENT:IO}=dp.constants,DO=2e4,xO=Buffer.from("too_many_pings","ascii"),cp=class{constructor(e,t,r,i){this.session=e,this.options=r,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=DO,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new ap.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Sc.subchannelAddressToString)(t),r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,ap.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${SO}`,r["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let l=!1;s===dp.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(xO)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),Is.isTracerEnabled(lp)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let i=this.session.socket,s=i.remoteAddress?(0,Sc.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,o=i.localAddress?(0,Sc.stringToSubchannelAddress)(i.localAddress,i.localPort):null,a;if(this.session.encrypted){let c=i,u=c.getCipher(),p=c.getCertificate(),g=c.getPeerCertificate();a={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:p&&"raw"in p?p.raw:null,remoteCertificate:g&&"raw"in g?g.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null}}trace(e){Is.trace(Jo.LogVerbosity.DEBUG,lp,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){Is.trace(Jo.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){Is.trace(Jo.LogVerbosity.DEBUG,CO,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){Is.trace(Jo.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0||t.call(e));try{this.session.ping((r,i,s)=>{r&&(this.keepaliveTrace("Ping failed with error "+r.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||t===void 0?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,i,s){let o=e.toHttp2Headers();o[bO]=t,o[IO]=this.userAgent,o[EO]="application/grpc",o[wO]="POST",o[TO]=r,o[AO]="trailers";let a;try{a=this.session.request(o)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var p;(p=s.onCallEnd)===null||p===void 0||p.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var p;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(p=s.onStreamEnd)===null||p===void 0||p.call(s,u)}}):l={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var p;(p=s.onCallEnd)===null||p===void 0||p.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var p;(p=s.onStreamEnd)===null||p===void 0||p.call(s,u)}},c=new vO.Http2SubchannelCall(a,l,i,this,(0,_O.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,ap.unregisterChannelzRef)(this.channelzRef)}},up=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){Is.trace(Jo.LogVerbosity.DEBUG,lp,(0,As.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,i){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,l,c;let u;i.realTarget?(u=(0,As.uriToString)(i.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,As.uriToString)(i.realTarget))):(u=null,this.trace("creating HTTP/2 session to "+(0,Sc.subchannelAddressToString)(e)));let p=(0,GS.getDefaultAuthority)((a=i.realTarget)!==null&&a!==void 0?a:this.channelTarget),g=t._getConnectionOptions()||{};g.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?g.maxSessionMemory=r["grpc-node.max_session_memory"]:g.maxSessionMemory=Number.MAX_SAFE_INTEGER;let C="http://";if("secureContext"in g){if(C="https://",r["grpc.ssl_target_name_override"]){let T=r["grpc.ssl_target_name_override"];g.checkServerIdentity=(P,x)=>(0,jS.checkServerIdentity)(T,x),g.servername=T}else{let T=(c=(l=(0,As.splitHostPort)(p))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";g.servername=T}i.socket&&(g.createConnection=(T,P)=>i.socket)}else g.createConnection=(T,P)=>i.socket?i.socket:yO.connect(e);g=Object.assign(Object.assign(Object.assign({},g),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});let A=dp.connect(C+p,g);this.session=A;let I="Failed to connect";A.unref(),A.once("connect",()=>{A.removeAllListeners(),s(new cp(A,e,r,u)),this.session=null}),A.once("close",()=>{this.session=null,setImmediate(()=>{o(`${I} (${new Date().toISOString()})`)})}),A.once("error",T=>{I=T.message,this.trace("connection failed with error "+I)})})}connect(e,t,r){var i,s;if(this.isShutdown)return Promise.reject();let o=t._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let a=r["grpc.ssl_target_name_override"];o.checkServerIdentity=(l,c)=>(0,jS.checkServerIdentity)(a,c),o.servername=a}else if("grpc.http_connect_target"in r){let a=(0,GS.getDefaultAuthority)((i=(0,As.parseUri)(r["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),l=(0,As.splitHostPort)(a);o.servername=(s=l?.host)!==null&&s!==void 0?s:a}r["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,gO.getProxiedConnection)(e,r,o).then(a=>this.createSession(e,t,r,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};bc.Http2SubchannelConnector=up});var WS=D(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.getSubchannelPool=Ds.SubchannelPool=void 0;var RO=x0(),kO=FS(),OO=An(),MO=Ot(),PO=$S(),NO=1e4,Zo=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let i=this.pool[t].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[t]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},NO),(t=(e=this.cleanupTimer).unref)===null||t===void 0||t.call(e))}getOrCreateSubchannel(e,t,r,i){this.ensureCleanupTask();let s=(0,MO.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let l of a)if((0,OO.subchannelAddressEqual)(t,l.subchannelAddress)&&(0,RO.channelOptionsEqual)(r,l.channelArguments)&&i._equals(l.channelCredentials))return l.subchannel}let o=new kO.Subchannel(e,t,r,i,new PO.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:t,channelArguments:r,channelCredentials:i,subchannel:o}),o.ref(),o}};Ds.SubchannelPool=Zo;var FO=new Zo;function LO(n){return n?FO:new Zo}Ds.getSubchannelPool=LO});var fp=D(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.FilterStackFactory=xs.FilterStack=void 0;var Ec=class{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let r=0;r<this.filters.length;r++)t=this.filters[r].sendMessage(t);return t}receiveMessage(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let r=this.filters.length-1;r>=0;r--)t=this.filters[r].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};xs.FilterStack=Ec;var hp=class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new Ec(this.factories.map(e=>e.createFilter()))}};xs.FilterStackFactory=hp});var pp=D(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.CompressionAlgorithms=void 0;var HS=function(n){return n[n.identity=0]="identity",n[n.deflate=1]="deflate",n[n.gzip=2]="gzip",n}(HS||(wc.CompressionAlgorithms=HS={}))});var gp=D(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});Tc.BaseFilter=void 0;var mp=class{sendMetadata(e){return R(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return R(this,null,function*(){return e})}receiveMessage(e){return R(this,null,function*(){return e})}receiveTrailers(e){return e}};Tc.BaseFilter=mp});var YS=D(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.CompressionFilterFactory=ks.CompressionFilter=void 0;var Ac=pe("zlib"),QS=pp(),Ic=fe(),VO=gp(),BO=Fe(),UO=n=>typeof n=="number"&&typeof QS.CompressionAlgorithms[n]=="string",Rs=class{writeMessage(e,t){return R(this,null,function*(){let r=e;t&&(r=yield this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(t?1:0,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i})}readMessage(e){return R(this,null,function*(){let t=e.readUInt8(0)===1,r=e.slice(5);return t&&(r=yield this.decompressMessage(r)),r})}},Ci=class extends Rs{compressMessage(e){return R(this,null,function*(){return e})}writeMessage(e,t){return R(this,null,function*(){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},yp=class extends Rs{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Ac.deflate(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Ac.createInflate();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:Ic.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},vp=class extends Rs{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{Ac.gzip(e,(i,s)=>{i?r(i):t(s)})})}decompressMessage(e){return new Promise((t,r)=>{let i=0,s=[],o=Ac.createGunzip();o.on("data",a=>{s.push(a),i+=a.byteLength,this.maxRecvMessageLength!==-1&&i>this.maxRecvMessageLength&&(o.destroy(),r({code:Ic.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(s))}),o.write(e),o.end()})}},_p=class extends Rs{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function KS(n,e){switch(n){case"identity":return new Ci;case"deflate":return new yp(e);case"gzip":return new vp(e);default:return new _p(n)}}var Dc=class extends VO.BaseFilter{constructor(e,t){var r,i;super(),this.sharedFilterConfig=t,this.sendCompression=new Ci,this.receiveCompression=new Ci,this.currentCompressionAlgorithm="identity";let s=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(r=e["grpc.max_receive_message_length"])!==null&&r!==void 0?r:Ic.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,s!==void 0)if(UO(s)){let o=QS.CompressionAlgorithms[s],a=(i=t.serverSupportedEncodingHeader)===null||i===void 0?void 0:i.split(",");(!a||a.includes(o))&&(this.currentCompressionAlgorithm=o,this.sendCompression=KS(this.currentCompressionAlgorithm,-1))}else BO.log(Ic.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${s}`)}sendMetadata(e){return R(this,null,function*(){let t=yield e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t})}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let i=t[0];typeof i=="string"&&(this.receiveCompression=KS(i,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Ci,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return R(this,null,function*(){var t;let r=yield e,i;return this.sendCompression instanceof Ci?i=!1:i=(((t=r.flags)!==null&&t!==void 0?t:0)&2)===0,{message:yield this.sendCompression.writeMessage(r.message,i),flags:r.flags}})}receiveMessage(e){return R(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};ks.CompressionFilter=Dc;var Cp=class{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new Dc(this.options,this.sharedFilterConfig)}};ks.CompressionFilterFactory=Cp});var xc=D(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.deadlineToString=Fn.getRelativeTimeout=Fn.getDeadlineTimeoutString=Fn.minDeadline=void 0;function qO(...n){let e=1/0;for(let t of n){let r=t instanceof Date?t.getTime():t;r<e&&(e=r)}return e}Fn.minDeadline=qO;var zO=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function jO(n){let e=new Date().getTime();n instanceof Date&&(n=n.getTime());let t=Math.max(n-e,0);for(let[r,i]of zO){let s=t/i;if(s<1e8)return String(Math.ceil(s))+r}throw new Error("Deadline is too far in the future")}Fn.getDeadlineTimeoutString=jO;var GO=2147483647;function $O(n){let e=n instanceof Date?n.getTime():n,t=new Date().getTime(),r=e-t;return r<0?0:r>GO?1/0:r}Fn.getRelativeTimeout=$O;function WO(n){if(n instanceof Date)return n.toISOString();{let e=new Date(n);return Number.isNaN(e.getTime())?""+n:e.toISOString()}}Fn.deadlineToString=WO});var kc=D(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.restrictControlPlaneStatusCode=void 0;var Ln=fe(),HO=[Ln.Status.OK,Ln.Status.INVALID_ARGUMENT,Ln.Status.NOT_FOUND,Ln.Status.ALREADY_EXISTS,Ln.Status.FAILED_PRECONDITION,Ln.Status.ABORTED,Ln.Status.OUT_OF_RANGE,Ln.Status.DATA_LOSS];function KO(n,e){return HO.includes(n)?{code:Ln.Status.INTERNAL,details:`Invalid status from control plane: ${n} ${Ln.Status[n]} ${e}`}:{code:n,details:e}}Rc.restrictControlPlaneStatusCode=KO});var JS=D(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.LoadBalancingCall=void 0;var XS=zt(),Oc=fe(),QO=xc(),Mc=wt(),ea=Ir(),YO=Ot(),XO=Fe(),Sp=kc(),JO=pe("http2"),ZO="load_balancing_call",bp=class{constructor(e,t,r,i,s,o,a){var l,c;this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let u=this.methodName.split("/"),p="";u.length>=2&&(p=u[1]);let g=(c=(l=(0,YO.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${g}/${p}`}trace(e){XO.trace(Oc.LogVerbosity.DEBUG,ZO,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:t});(r=this.listener)===null||r===void 0||r.onReceiveStatus(s),(i=this.onCallEnded)===null||i===void 0||i.call(this,s.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+ea.PickResultType[r.pickResultType]+" subchannel: "+i+" status: "+((e=r.status)===null||e===void 0?void 0:e.code)+" "+((t=r.status)===null||t===void 0?void 0:t.details)),r.pickResultType){case ea.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var l,c,u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let p=this.metadata.clone();if(p.merge(a),p.get("authorization").length>1&&this.outputStatus({code:Oc.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new Mc.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==XS.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+XS.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&p.set("grpc-timeout",(0,QO.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(p,this.host,this.methodName,{onReceiveMetadata:g=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(g)},onReceiveMessage:g=>{this.trace("Received message"),this.listener.onReceiveMessage(g)},onReceiveStatus:g=>{this.trace("Received status"),g.rstCode===JO.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(g,"REFUSED"):this.outputStatus(g,"PROCESSED")}})}catch(g){this.trace("Failed to start call on picked subchannel "+i+" with error "+g.message),this.outputStatus({code:Oc.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+g.message,metadata:new Mc.Metadata},"NOT_STARTED");return}(c=(l=this.callConfig).onCommitted)===null||c===void 0||c.call(l),(u=r.onCallStarted)===null||u===void 0||u.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:l,details:c}=(0,Sp.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:Oc.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:l,details:c,metadata:new Mc.Metadata},"PROCESSED")});break;case ea.PickResultType.DROP:let{code:s,details:o}=(0,Sp.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:r.status.metadata},"DROP")});break;case ea.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:l}=(0,Sp.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:a,details:l,metadata:r.status.metadata},"PROCESSED")})}break;case ea.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new Mc.Metadata},"PROCESSED")}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};Pc.LoadBalancingCall=bp});var eb=D(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.ResolvingCall=void 0;var Os=fe(),Nc=xc(),ZS=wt(),eM=Fe(),tM=kc(),nM="resolving_call",Ep=class{constructor(e,t,r,i,s,o){this.channel=e,this.method=t,this.filterStackFactory=i,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&Os.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(Os.Status.CANCELLED,"Cancelled by parent call")}),r.flags&Os.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,Nc.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){eM.trace(Os.LogVerbosity.DEBUG,nM,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,Nc.deadlineToString)(this.deadline));let e=(0,Nc.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(Os.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(r=>r(t)),process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(i=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,i.message),this.pendingHalfClose&&r.halfClose()},i=>{this.cancelWithStatus(i.code,i.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let t=e.config;if(t.status!==Os.Status.OK){let{code:r,details:i}=(0,tM.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:r,details:i,metadata:new ZS.Metadata});return}if(t.methodConfig.timeout){let r=new Date;r.setSeconds(r.getSeconds()+t.methodConfig.timeout.seconds),r.setMilliseconds(r.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,Nc.minDeadline)(this.deadline,r),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(r=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(r,{onReceiveMetadata:i=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(i))},onReceiveMessage:i=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(i).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:i=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=i:this.outputStatus(i)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},r=>{this.outputStatus(r)})}reportResolverError(e){var t;!((t=this.metadata)===null||t===void 0)&&t.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new ZS.Metadata})}getPeer(){var e,t;return(t=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};Fc.ResolvingCall=Ep});var tb=D(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.RetryingCall=Gr.MessageBufferTracker=Gr.RetryThrottler=void 0;var Lc=fe(),rM=wt(),iM=Fe(),sM="retrying_call",Tp=class{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Gr.RetryThrottler=Tp;var Ap=class{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;return this.limitPerCall-i<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(t,i+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=(r=this.allocatedPerCall.get(t))!==null&&r!==void 0?r:0;if(i<e)throw new Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(t,i-e)}freeAll(e){var t;let r=(t=this.allocatedPerCall.get(e))!==null&&t!==void 0?t:0;if(this.totalAllocated<r)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}};Gr.MessageBufferTracker=Ap;var wp="grpc-previous-rpc-attempts",Ip=class{constructor(e,t,r,i,s,o,a,l,c){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";let u=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(u.initialBackoff.substring(0,u.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){iM.trace(Lc.LogVerbosity.DEBUG,sM,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;(t=this.listener)===null||t===void 0||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new rM.Metadata});for(let{call:r}of this.underlyingCalls)r.cancelWithStatus(e,t)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return(t=this.writeBuffer[e-this.writeBufferOffset])!==null&&t!==void 0?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let r=this.getBufferEntry(t);r.allocated&&this.bufferTracker.free(r.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&this.underlyingCalls[t].state!=="COMPLETED"&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(Lc.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,t=-1;for(let[r,i]of this.underlyingCalls.entries())i.state==="ACTIVE"&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,t=r);t===-1?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(r=>r===t||r.toString().toLowerCase()===Lc.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,i),r}maybeRetryCall(e,t){if(this.state!=="RETRY"){t(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){t(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){t(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(t(!0),this.attempts+=1,this.startNewAttempt())},i)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var i,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&i!==void 0?i:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(r===null)a=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else a=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(t),this.reportStatus(e))},a)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(r,a=>{a||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e));break}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(t.length===0)return null;try{return parseInt(t[0])}catch{return-1}}handleChildStatus(e,t){var r;if(this.underlyingCalls[t].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===Lc.Status.OK){(r=this.retryThrottler)===null||r===void 0||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let s=(e=i.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(r=(t=this.hedgingTimer).unref)===null||r===void 0||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(wp,`${r}`);let s=!1;e.start(i,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),s=!0,r>0&&o.set(wp,`${r}`),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),this.underlyingCalls[t].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&r>0&&o.metadata.set(wp,`${r}`),this.handleChildStatus(o,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let i=this.underlyingCalls[e],s=i.nextMessageToSend;(r=(t=this.getBufferEntry(s)).callback)===null||r===void 0||r.call(t),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if(t.state!=="COMPLETED"&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:i=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let i={message:t,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(r=e.callback)===null||r===void 0||r.call(e);for(let[a,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(a)}},t)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let t of this.underlyingCalls)t?.state==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Gr.RetryingCall=Ip});var Bc=D(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.BaseSubchannelWrapper=void 0;var Dp=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};Vc.BaseSubchannelWrapper=Dp});var ib=D(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.InternalChannel=void 0;var oM=wl(),aM=D0(),lM=WS(),nb=Ir(),ta=fe(),cM=fp(),uM=YS(),rb=wn(),xp=Fe(),dM=np(),Uc=Ot(),Vn=zt(),na=_i(),hM=JS(),fM=xc(),pM=eb(),Rp=op(),mM=kc(),kp=tb(),gM=Bc(),yM=2147483647,vM=1e3,_M=30*60*1e3,qc=new Map,CM=1<<24,SM=1<<20,Op=class extends gM.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(r,i,s,o)=>{t.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Mp=class{constructor(e,t,r){var i,s,o,a,l,c,u,p;if(this.credentials=t,this.options=r,this.connectivityState=Vn.ConnectivityState.IDLE,this.currentPicker=new nb.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new na.ChannelzCallTracker,this.childrenTracker=new na.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof oM.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let g=(0,Uc.parseUri)(e);if(g===null)throw new Error(`Could not parse target name "${e}"`);let C=(0,rb.mapUriDefaultScheme)(g);if(C===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},yM),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new na.ChannelzTrace,this.channelzRef=(0,na.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,rb.getDefaultAuthority)(C);let A=(0,dM.mapProxyName)(C,r);this.target=A.target,this.options=Object.assign({},this.options,A.extraOptions),this.subchannelPool=(0,lM.getSubchannelPool)(((o=r["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new kp.MessageBufferTracker((a=r["grpc.retry_buffer_size"])!==null&&a!==void 0?a:CM,(l=r["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:SM),this.keepaliveTime=(c=r["grpc.keepalive_time_ms"])!==null&&c!==void 0?c:-1,this.idleTimeoutMs=Math.max((u=r["grpc.client_idle_timeout_ms"])!==null&&u!==void 0?u:_M,vM);let I={createSubchannel:(P,x)=>{let N=this.subchannelPool.getOrCreateSubchannel(this.target,P,Object.assign({},this.options,x),this.credentials);N.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",N.getChannelzRef());let F=new Op(N,this);return this.wrappedSubchannels.add(F),F},updateState:(P,x)=>{this.currentPicker=x;let N=this.pickQueue.slice();this.pickQueue=[],N.length>0&&this.callRefTimerUnref();for(let F of N)F.doPick();this.updateState(P)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:P=>{this.channelzEnabled&&this.childrenTracker.refChild(P)},removeChannelzChild:P=>{this.channelzEnabled&&this.childrenTracker.unrefChild(P)}};this.resolvingLoadBalancer=new aM.ResolvingLoadBalancer(this.target,I,r,(P,x)=>{P.retryThrottling?qc.set(this.getTarget(),new kp.RetryThrottler(P.retryThrottling.maxTokens,P.retryThrottling.tokenRatio,qc.get(this.getTarget()))):qc.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=x,this.currentResolutionError=null,process.nextTick(()=>{let N=this.configSelectionQueue;this.configSelectionQueue=[],N.length>0&&this.callRefTimerUnref();for(let F of N)F.getConfig()})},P=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+P.code+' and details "'+P.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,mM.restrictControlPlaneStatusCode)(P.code,P.details)),{metadata:P.metadata}));let x=this.configSelectionQueue;this.configSelectionQueue=[],x.length>0&&this.callRefTimerUnref();for(let N of x)N.reportResolverError(P)}),this.filterStackFactory=new cM.FilterStackFactory([new uM.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let T=new Error;(0,xp.trace)(ta.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((p=T.stack)===null||p===void 0?void 0:p.substring(T.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,xp.trace)(t??ta.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Uc.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,i;!((t=(e=this.callRefTimer).hasRef)===null||t===void 0)&&t.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer).ref)===null||i===void 0||i.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(t=(e=this.callRefTimer).unref)===null||t===void 0||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(r=>r===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){(0,xp.trace)(ta.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Uc.uriToString)(this.target)+" "+Vn.ConnectivityState[this.connectivityState]+" -> "+Vn.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Vn.ConnectivityState[e]),this.connectivityState=e;let t=this.connectivityStateWatchers.slice();for(let r of t)e!==r.currentState&&(r.timer&&clearTimeout(r.timer),this.removeConnectivityStateWatcher(r),r.callback());e!==Vn.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let t of this.wrappedSubchannels)t.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Vn.ConnectivityState.IDLE),this.currentPicker=new nb.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(r=(t=this.idleTimer).unref)===null||r===void 0||r.call(t)}maybeStartIdleTimer(){this.connectivityState!==Vn.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===ta.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,i,s){let o=(0,Rp.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+t+'"'),new hM.LoadBalancingCall(this,e,t,r,i,s,o)}createRetryingCall(e,t,r,i,s){let o=(0,Rp.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+t+'"'),new kp.RetryingCall(this,e,t,r,i,s,o,this.retryBufferTracker,qc.get(this.getTarget()))}createInnerCall(e,t,r,i,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,t,r,i,s):this.createRetryingCall(e,t,r,i,s)}createResolvingCall(e,t,r,i,s){let o=(0,Rp.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,fM.deadlineToString)(t));let a={deadline:t,flags:s??ta.Propagate.DEFAULTS,host:r??this.defaultAuthority,parentCall:i},l=new pM.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Vn.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,na.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Uc.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===Vn.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(t!==1/0){let o=t instanceof Date?t:new Date(t),a=new Date;if(t===-1/0||o<=a){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),r(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Vn.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,t,r,i,s)}};zc.InternalChannel=Mp});var Fh=D(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.ChannelImplementation=void 0;var bM=wl(),EM=ib(),Pp=class{constructor(e,t,r){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(t instanceof bM.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new EM.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof t=="number"||t instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,i,s)}};jc.ChannelImplementation=Pp});var fb=D(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.Http2ServerCallStream=Xt.ServerDuplexStreamImpl=Xt.ServerWritableStreamImpl=Xt.ServerReadableStreamImpl=Xt.ServerUnaryCallImpl=void 0;var ub=pe("events"),Ms=pe("http2"),Lp=pe("stream"),sb=pe("zlib"),Te=fe(),Vp=wt(),wM=ip(),db=Fe(),ia=vl(),hb="server_call";function ra(n){db.trace(Te.LogVerbosity.DEBUG,hb,n)}var TM="grpc-accept-encoding",AM="grpc-encoding",ob="grpc-message",ab="grpc-status",lb="grpc-timeout",IM=/(\d{1,8})\s*([HMSmun])/,DM={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},xM={[TM]:"identity,deflate,gzip",[AM]:"identity"},cb={[Ms.constants.HTTP2_HEADER_STATUS]:Ms.constants.HTTP_STATUS_OK,[Ms.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},RM={waitForTrailers:!0},Np=class extends ub.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Xt.ServerUnaryCallImpl=Np;var Gc=class extends Lp.Readable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};Xt.ServerReadableStreamImpl=Gc;var sa=class extends Lp.Writable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new Vp.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",r);return}}catch(i){this.emit("error",{details:(0,ia.getErrorMessage)(i),code:Te.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:Te.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};Xt.ServerWritableStreamImpl=sa;var Ps=class extends Lp.Duplex{constructor(e,t,r,i,s){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new Vp.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};Xt.ServerDuplexStreamImpl=Ps;Ps.prototype._read=Gc.prototype._read;Ps.prototype._write=sa.prototype._write;Ps.prototype._final=sa.prototype._final;var Fp=class extends ub.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=Te.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=Te.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;ra("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:Te.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if(t==="identity")return r;if(t==="deflate"||t==="gzip"){let i;return t==="deflate"?i=sb.createInflate():i=sb.createGunzip(),new Promise((s,o)=>{let a=0,l=[];i.on("data",c=>{l.push(c),a+=c.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(i.destroy(),o({code:Te.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),i.on("end",()=>{s(Buffer.concat(l))}),i.write(r),i.end()})}else return Promise.reject({code:Te.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},cb),xM),t);this.stream.respond(r,RM)}receiveMetadata(e){let t=Vp.Metadata.fromHttp2Headers(e);db.isTracerEnabled(hb)&&ra("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(lb);if(r.length>0){let i=r[0].toString().match(IM);if(i===null){let a=new Error("Invalid deadline");return a.code=Te.Status.OUT_OF_RANGE,this.sendError(a),t}let s=+i[1]*DM[i[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(kM,s,this),t.remove(lb)}return t.remove(Ms.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(Ms.constants.HTTP2_HEADER_TE),t.remove(Ms.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:i}=this,s=0,o=this,a=[],l=this.maxReceiveMessageSize;this.stream.on("data",c),this.stream.on("end",u),this.stream.on("error",u);function c(p){if(s+=p.byteLength,l!==-1&&s>l){i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),r({code:Te.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${l})`});return}a.push(p)}function u(p){if(i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),p!==void 0){r({code:Te.Status.INTERNAL,details:p.message});return}if(s===0){r({code:Te.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let g=Buffer.concat(a,s),A=g.readUInt8(0)===1?e:"identity",I=o.getDecompressedMessage(g,A);if(Buffer.isBuffer(I)){t(o.deserializeMessageWithInternalError(I));return}I.then(T=>t(o.deserializeMessageWithInternalError(T)),T=>r(T.code?T:{code:Te.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return R(this,null,function*(){try{return this.deserializeMessage(e)}catch(t){throw{details:(0,ia.getErrorMessage)(t),code:Te.Status.INTERNAL}}})}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,t,r,i){return R(this,null,function*(){if(!this.checkCancelled()){if(r===void 0&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let s=this.serializeMessage(t);this.write(s),this.sendStatus({code:Te.Status.OK,details:"OK",metadata:r})}catch(s){this.sendError({details:(0,ia.getErrorMessage)(s),code:Te.Status.INTERNAL})}}})}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===Te.Status.OK),!this.checkCancelled())if(ra("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+Te.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var i;let s=Object.assign({[ab]:e.code,[ob]:encodeURI(e.details)},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let i=Object.assign(Object.assign({[ab]:e.code,[ob]:encodeURI(e.details)},cb),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(i,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:Te.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&typeof e.details=="string"&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:Te.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new wM.StreamDecoder(this.maxReceiveMessageSize),i=!1,s=!1,o=!1,a=()=>R(this,null,function*(){!o&&i&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",l=>R(this,null,function*(){let c;try{c=r.write(l)}catch(u){this.sendError({code:Te.Status.RESOURCE_EXHAUSTED,details:u.message});return}s=!0,this.stream.pause();for(let u of c){this.emit("receiveMessage");let g=u.readUInt8(0)===1?t:"identity",C;try{C=yield this.getDecompressedMessage(u,g)}catch(A){this.sendError(A);return}if(!C)return;yield this.pushOrBufferMessage(e,C)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>R(this,null,function*(){i=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(t===null||r===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,t){return R(this,null,function*(){this.isPushPending?this.bufferedMessages.push(t):yield this.pushMessage(e,t)})}pushMessage(e,t){return R(this,null,function*(){if(t===null){ra("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}ra("Received message of length "+t.length),this.isPushPending=!0;try{let r=yield this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let i=(0,ia.getErrorCode)(r);(i===null||i<Te.Status.OK||i>Te.Status.UNAUTHENTICATED)&&(i=Te.Status.INTERNAL),e.emit("error",{details:(0,ia.getErrorMessage)(r),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let t=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return t?.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};Xt.Http2ServerCallStream=Fp;function kM(n){let e=new Error("Deadline exceeded");e.code=Te.Status.DEADLINE_EXCEEDED,n.sendError(e),n.cancelled=!0,n.emit("cancelled","deadline")}});var qp=D($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.ServerCredentials=void 0;var pb=oh(),oa=class{static createInsecure(){return new Bp}static createSsl(e,t,r=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw new TypeError("keyCertPairs must be an array");if(typeof r!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let o=0;o<t.length;o++){let a=t[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);i.push(a.cert_chain),s.push(a.private_key)}return new Up({ca:e||(0,pb.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:pb.CIPHER_SUITES})}};$c.ServerCredentials=oa;var Bp=class extends oa{_isSecure(){return!1}_getSettings(){return null}},Up=class extends oa{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var yb=D(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.Server=void 0;var $r=pe("http2"),sr=fe(),Si=fb(),OM=qp(),mb=wn(),Wc=Fe(),un=An(),MM=Ot(),It=_i(),Hc=~(1<<31),PM=~(1<<31),NM=2e4,{HTTP2_HEADER_PATH:gb}=$r.constants,FM="server";function LM(){}function zp(n){return{code:sr.Status.UNIMPLEMENTED,details:`The server does not implement the method ${n}`}}function VM(n,e){let t=zp(e);switch(n){case"unary":return(r,i)=>{i(t,null)};case"clientStream":return(r,i)=>{i(t,null)};case"serverStream":return r=>{r.emit("error",t)};case"bidi":return r=>{r.emit("error",t)};default:throw new Error(`Invalid handlerType ${n}`)}}var jp=class{constructor(e){var t,r,i,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new It.ChannelzTrace,this.callTracker=new It.ChannelzCallTracker,this.listenerChildrenTracker=new It.ChannelzChildrenTracker,this.sessionChildrenTracker=new It.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,It.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(t=this.options["grpc.max_connection_age_ms"])!==null&&t!==void 0?t:Hc,this.maxConnectionAgeGraceMs=(r=this.options["grpc.max_connection_age_grace_ms"])!==null&&r!==void 0?r:Hc,this.keepaliveTimeMs=(i=this.options["grpc.keepalive_time_ms"])!==null&&i!==void 0?i:PM,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:NM,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,i;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,un.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,l=o.localAddress?(0,un.stringToSubchannelAddress)(o.localAddress,o.localPort):null,c;if(e.encrypted){let p=o,g=p.getCipher(),C=p.getCertificate(),A=p.getPeerCertificate();c={cipherSuiteStandardName:(t=g.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:g.standardName?null:g.name,localCertificate:C&&"raw"in C?C.raw:null,remoteCertificate:A&&"raw"in A?A.raw:null}}else c=null;return{remoteAddress:a,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){Wc.trace(sr.LogVerbosity.DEBUG,FM,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!="object"||t===null||typeof t!="object")throw new Error("addService() requires two objects as arguments");let r=Object.keys(e);if(r.length===0)throw new Error("Cannot add an empty service to a server");r.forEach(i=>{let s=e[i],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=t[i],l;if(a===void 0&&typeof s.originalName=="string"&&(a=t[s.originalName]),a!==void 0?l=a.bind(t):l=VM(o,i),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(r=>{let i=e[r];this.unregister(i.path)})}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(t===null||!(t instanceof OM.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof r!="function")throw new TypeError("callback must be a function");let i=(0,MM.parseUri)(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=(0,mb.mapUriDefaultScheme)(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(C,A)=>{process.nextTick(()=>r(C,A))},l=()=>{let C;if(t._isSecure()){let A=Object.assign(o,t._getSettings());A.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,C=$r.createSecureServer(A),C.on("secureConnection",I=>{I.on("error",T=>{this.trace("An incoming TLS connection closed with error: "+T.message)})})}else C=$r.createServer(o);return C.setTimeout(0,LM),this._setupHandlers(C),C},c=(C,A,I)=>C.length===0?Promise.resolve({port:A,count:I}):Promise.all(C.map(T=>{this.trace("Attempting to bind "+(0,un.subchannelAddressToString)(T));let P;(0,un.isTcpSubchannelAddress)(T)?P={host:T.host,port:A}:P=T;let x=l();return new Promise((N,F)=>{let $=X=>{this.trace("Failed to bind "+(0,un.subchannelAddressToString)(T)+" with error "+X.message),N(X)};x.once("error",$),x.listen(P,()=>{if(this.shutdown){x.close(),N(new Error("bindAsync failed because server is shutdown"));return}let X=x.address(),_;typeof X=="string"?_={path:X}:_={host:X.address,port:X.port};let m=(0,It.registerChannelzSocket)((0,un.subchannelAddressToString)(_),()=>({localAddress:_,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(m),this.http2ServerList.push({server:x,channelzRef:m}),this.trace("Successfully bound "+(0,un.subchannelAddressToString)(_)),N("port"in _?_.port:A),x.removeListener("error",$)})})})).then(T=>{let P=0;for(let x of T)if(typeof x=="number"&&(P+=1,x!==A))throw new Error("Invalid state: multiple port numbers added from single address");return{port:A,count:P+I}}),u=C=>{if(C.length===0)return Promise.resolve({port:0,count:0});let A=C[0],I=l();return new Promise((T,P)=>{let x=N=>{this.trace("Failed to bind "+(0,un.subchannelAddressToString)(A)+" with error "+N.message),T(u(C.slice(1)))};I.once("error",x),I.listen(A,()=>{if(this.shutdown){I.close(),T({port:0,count:0});return}let N=I.address(),F={host:N.address,port:N.port},$=(0,It.registerChannelzSocket)((0,un.subchannelAddressToString)(F),()=>({localAddress:F,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild($),this.http2ServerList.push({server:I,channelzRef:$}),this.trace("Successfully bound "+(0,un.subchannelAddressToString)(F)),T(c(C.slice(1),N.port,1)),I.removeListener("error",x)})})},p={onSuccessfulResolution:(C,A,I)=>{if(p.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),C.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let T;(0,un.isTcpSubchannelAddress)(C[0])?C[0].port===0?T=u(C):T=c(C,C[0].port,0):T=c(C,1,0),T.then(P=>{if(P.count===0){let x=`No address added out of total ${C.length} resolved`;Wc.log(sr.LogVerbosity.ERROR,x),a(new Error(x),0)}else P.count<C.length&&Wc.log(sr.LogVerbosity.INFO,`WARNING Only ${P.count} addresses added out of total ${C.length} resolved`),a(null,P.port)},P=>{let x=`No address added out of total ${C.length} resolved`;Wc.log(sr.LogVerbosity.ERROR,x),a(new Error(x),0)})},onError:C=>{a(new Error(C.details),0)}};(0,mb.createResolver)(s,p,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,It.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy($r.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,It.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:t,serialize:r,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=s=>{this.channelzEnabled&&(0,It.unregisterChannelzRef)(this.channelzRef),e(s)},r=0;function i(){r--,r===0&&t()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(r++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,It.unregisterChannelzRef)(o)),i()}));this.sessions.forEach((s,o)=>{o.closed||(r+=1,o.close(i))}),r===0&&t()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[$r.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof r!="string"||!r.startsWith("application/grpc")?(e.respond({[$r.constants.HTTP2_HEADER_STATUS]:$r.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return t===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let i=new Si.Http2ServerCallStream(t,null,this.options);e.code===void 0&&(e.code=sr.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),r?.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed();return}let i=t[gb],s=this._retrieveHandler(i);if(!s){this._respondWithError(zp(i),e,r);return}let o=new Si.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===sr.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",a=>{a?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,t)||(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed(),o.sendError({code:sr.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,t){if(this._verifyContentType(e,t)!==!0)return;let r=t[gb],i=this._retrieveHandler(r);if(!i){this._respondWithError(zp(r),e,null);return}let s=new Si.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(s,i,t)||s.sendError({code:sr.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,t,r){var i;let s=e.receiveMetadata(r),o=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:a}=t;if(a==="unary")BM(e,t,s,o);else if(a==="clientStream")UM(e,t,s,o);else if(a==="serverStream")qM(e,t,s,o);else if(a==="bidi")zM(e,t,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let t=e.address(),r="null";t&&(typeof t=="string"?r=t:r=t.address+":"+t.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var o,a,l,c,u;if(!this.started){s.destroy();return}let p=(0,It.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),g={ref:p,streamTracker:new It.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,g);let C=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+C),this.sessionChildrenTracker.refChild(p));let A=null,I=null,T=!1;if(this.maxConnectionAgeMs!==Hc){let x=this.maxConnectionAgeMs/10,N=Math.random()*x*2-x;A=(l=(a=setTimeout(()=>{var F,$;T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+C);try{s.goaway($r.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Hc&&(I=($=(F=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||$===void 0?void 0:$.call(F))},this.maxConnectionAgeMs+N)).unref)===null||l===void 0?void 0:l.call(a)}let P=(u=(c=setInterval(()=>{var x,N;let F=(N=(x=setTimeout(()=>{T=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+C),s.close()},this.keepaliveTimeoutMs)).unref)===null||N===void 0?void 0:N.call(x);try{s.ping(($,X,_)=>{clearTimeout(F)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||u===void 0?void 0:u.call(c);s.on("close",()=>{this.channelzEnabled&&(T||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+C),this.sessionChildrenTracker.unrefChild(p),(0,It.unregisterChannelzRef)(p)),A&&clearTimeout(A),I&&clearTimeout(I),P&&clearTimeout(P),this.sessions.delete(s)})})}};Kc.Server=jp;function BM(n,e,t,r){return R(this,null,function*(){try{let i=yield n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Si.ServerUnaryCallImpl(n,t,i);e.func(s,(o,a,l,c)=>{n.sendUnaryMessage(o,a,l,c)})}catch(i){n.sendError(i)}})}function UM(n,e,t,r){let i=new Si.ServerReadableStreamImpl(n,t,e.deserialize,r);function s(o,a,l,c){i.destroy(),n.sendUnaryMessage(o,a,l,c)}n.cancelled||(i.on("error",s),e.func(i,s))}function qM(n,e,t,r){return R(this,null,function*(){try{let i=yield n.receiveUnaryMessage(r);if(i===void 0||n.cancelled)return;let s=new Si.ServerWritableStreamImpl(n,t,e.serialize,i);e.func(s)}catch(i){n.sendError(i)}})}function zM(n,e,t,r){let i=new Si.ServerDuplexStreamImpl(n,t,e.serialize,e.deserialize,r);n.cancelled||e.func(i)}});var vb=D(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.StatusBuilder=void 0;var Gp=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Qc.StatusBuilder=Gp});var $p=D(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.isDuration=Wr.durationToMs=Wr.msToDuration=void 0;function jM(n){return{seconds:n/1e3|0,nanos:n%1e3*1e6|0}}Wr.msToDuration=jM;function GM(n){return n.seconds*1e3+n.nanos/1e6|0}Wr.durationToMs=GM;function $M(n){return typeof n.seconds=="number"&&typeof n.nanos=="number"}Wr.isDuration=$M});var Zp=D(Hr=>{"use strict";var Wp;Object.defineProperty(Hr,"__esModule",{value:!0});Hr.setup=Hr.OutlierDetectionLoadBalancer=Hr.OutlierDetectionLoadBalancingConfig=void 0;var Xc=zt(),Cb=fe(),bi=$p(),Sb=em(),bb=Er(),WM=kl(),HM=Ir(),_b=An(),KM=Bc(),QM=Fe(),YM="outlier_detection";function Ze(n){QM.trace(Cb.LogVerbosity.DEBUG,YM,n)}var Jp="outlier_detection",XM=((Wp=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&Wp!==void 0?Wp:"true")==="true",JM={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},ZM={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Ns(n,e,t,r){if(e in n&&typeof n[e]!==t){let i=r?`${r}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${t}, got ${typeof n[e]}`)}}function Hp(n,e,t){let r=t?`${t}.${e}`:e;if(e in n){if(!(0,bi.isDuration)(n[e]))throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof n[e]}`);if(!(n[e].seconds>=0&&n[e].seconds<=315576e6&&n[e].nanos>=0&&n[e].nanos<=999999999))throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function Yc(n,e,t){let r=t?`${t}.${e}`:e;if(Ns(n,e,"number",t),e in n&&!(n[e]>=0&&n[e]<=100))throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}var aa=class n{constructor(e,t,r,i,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=t??3e4,this.maxEjectionTimeMs=r??3e5,this.maxEjectionPercent=i??10,this.successRateEjection=s?Object.assign(Object.assign({},JM),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},ZM),o):null}getLoadBalancerName(){return Jp}toJsonObject(){return{interval:(0,bi.msToDuration)(this.intervalMs),base_ejection_time:(0,bi.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,bi.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new n(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(Hp(e,"interval"),Hp(e,"base_ejection_time"),Hp(e,"max_ejection_time"),Yc(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Ns(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Yc(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Ns(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Ns(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Yc(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Yc(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Ns(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Ns(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new n(e.interval?(0,bi.durationToMs)(e.interval):null,e.base_ejection_time?(0,bi.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,bi.durationToMs)(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(bb.validateLoadBalancingConfig))}};Hr.OutlierDetectionLoadBalancingConfig=aa;var Qp=class extends KM.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((r,i,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,i,s,o)})}getConnectivityState(){return this.ejected?Xc.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,Xc.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,Xc.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function Kp(){return{success:0,failure:0}}var Yp=class{constructor(){this.activeBucket=Kp(),this.inactiveBucket=Kp()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=Kp()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},Xp=class{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType===HM.PickResultType.COMPLETE){let r=t.subchannel,i=r.getMapEntry();if(i){let s=t.onCallEnded;return this.countCalls&&(s=o=>{var a;o===Cb.Status.OK?i.counter.addSuccess():i.counter.addFailure(),(a=t.onCallEnded)===null||a===void 0||a.call(t,o)}),Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},t),{subchannel:r.getWrappedSubchannel()})}else return t}},Jc=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new WM.ChildLoadBalancerHandler((0,Sb.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let i=e.createSubchannel(t,r),s=this.addressMap.get((0,_b.subchannelAddressToString)(t)),o=new Qp(i,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(t,r)=>{t===Xc.ConnectivityState.READY?e.updateState(t,new Xp(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())t.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;Ze("Running success rate check");let r=t.request_volume,i=0,s=[];for(let[p,g]of this.addressMap){let C=g.counter.getLastSuccesses(),A=g.counter.getLastFailures();Ze("Stats for "+p+": successes="+C+" failures="+A+" targetRequestVolume="+r),C+A>=r&&(i+=1,s.push(C/(C+A)))}if(Ze("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<t.minimum_hosts)return;let o=s.reduce((p,g)=>p+g)/s.length,a=0;for(let p of s){let g=p-o;a+=g*g}let l=a/s.length,c=Math.sqrt(l),u=o-c*(t.stdev_factor/1e3);Ze("stdev="+c+" ejectionThreshold="+u);for(let[p,g]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let C=g.counter.getLastSuccesses(),A=g.counter.getLastFailures();if(C+A<r)continue;let I=C/(C+A);if(Ze("Checking candidate "+p+" successRate="+I),I<u){let T=Math.random()*100;Ze("Candidate "+p+" randomNumber="+T+" enforcement_percentage="+t.enforcement_percentage),T<t.enforcement_percentage&&(Ze("Ejecting candidate "+p),this.eject(g,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;Ze("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),o=i.counter.getLastFailures();s+o>=t.request_volume&&(r+=1)}if(!(r<t.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(Ze("Candidate successes="+o+" failures="+a),o+a<t.request_volume)continue;if(a*100/(a+o)>t.threshold){let c=Math.random()*100;Ze("Candidate "+i+" randomNumber="+c+" enforcement_percentage="+t.enforcement_percentage),c<t.enforcement_percentage&&(Ze("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,t){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let r of e.subchannelWrappers)r.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let t of e.subchannelWrappers)t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(r=(t=this.ejectionTimer).unref)===null||r===void 0||r.call(t)}runChecks(){let e=new Date;if(Ze("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[t,r]of this.addressMap.entries())if(r.currentEjectionTimestamp===null)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(r.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(i*r.ejectionTimeMultiplier,Math.max(i,s))),o<new Date&&(Ze("Unejecting "+t),this.uneject(r))}}}updateAddressList(e,t,r){if(!(t instanceof aa))return;let i=new Set;for(let o of e)i.add((0,_b.subchannelAddressToString)(o));for(let o of i)this.addressMap.has(o)||(Ze("Adding map entry for "+o),this.addressMap.set(o,{counter:new Yp,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())i.has(o)||(Ze("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,bb.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){Ze("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else Ze("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else{Ze("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Jp}};Hr.OutlierDetectionLoadBalancer=Jc;function eP(){XM&&(0,Sb.registerLoadBalancerType)(Jp,Jc,aa)}Hr.setup=eP});var em=D(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.OutlierDetectionLoadBalancingConfig=Z.BaseSubchannelWrapper=Z.registerAdminService=Z.FilterStackFactory=Z.BaseFilter=Z.PickResultType=Z.QueuePicker=Z.UnavailablePicker=Z.ChildLoadBalancerHandler=Z.subchannelAddressToString=Z.validateLoadBalancingConfig=Z.getFirstUsableConfig=Z.registerLoadBalancerType=Z.createChildChannelControlHelper=Z.BackoffTimeout=Z.durationToMs=Z.uriToString=Z.createResolver=Z.registerResolver=Z.log=Z.trace=void 0;var Eb=Fe();Object.defineProperty(Z,"trace",{enumerable:!0,get:function(){return Eb.trace}});Object.defineProperty(Z,"log",{enumerable:!0,get:function(){return Eb.log}});var wb=wn();Object.defineProperty(Z,"registerResolver",{enumerable:!0,get:function(){return wb.registerResolver}});Object.defineProperty(Z,"createResolver",{enumerable:!0,get:function(){return wb.createResolver}});var tP=Ot();Object.defineProperty(Z,"uriToString",{enumerable:!0,get:function(){return tP.uriToString}});var nP=$p();Object.defineProperty(Z,"durationToMs",{enumerable:!0,get:function(){return nP.durationToMs}});var rP=xo();Object.defineProperty(Z,"BackoffTimeout",{enumerable:!0,get:function(){return rP.BackoffTimeout}});var Zc=Er();Object.defineProperty(Z,"createChildChannelControlHelper",{enumerable:!0,get:function(){return Zc.createChildChannelControlHelper}});Object.defineProperty(Z,"registerLoadBalancerType",{enumerable:!0,get:function(){return Zc.registerLoadBalancerType}});Object.defineProperty(Z,"getFirstUsableConfig",{enumerable:!0,get:function(){return Zc.getFirstUsableConfig}});Object.defineProperty(Z,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return Zc.validateLoadBalancingConfig}});var iP=An();Object.defineProperty(Z,"subchannelAddressToString",{enumerable:!0,get:function(){return iP.subchannelAddressToString}});var sP=kl();Object.defineProperty(Z,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return sP.ChildLoadBalancerHandler}});var tm=Ir();Object.defineProperty(Z,"UnavailablePicker",{enumerable:!0,get:function(){return tm.UnavailablePicker}});Object.defineProperty(Z,"QueuePicker",{enumerable:!0,get:function(){return tm.QueuePicker}});Object.defineProperty(Z,"PickResultType",{enumerable:!0,get:function(){return tm.PickResultType}});var oP=gp();Object.defineProperty(Z,"BaseFilter",{enumerable:!0,get:function(){return oP.BaseFilter}});var aP=fp();Object.defineProperty(Z,"FilterStackFactory",{enumerable:!0,get:function(){return aP.FilterStackFactory}});var lP=Ml();Object.defineProperty(Z,"registerAdminService",{enumerable:!0,get:function(){return lP.registerAdminService}});var cP=Bc();Object.defineProperty(Z,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return cP.BaseSubchannelWrapper}});var uP=Zp();Object.defineProperty(Z,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return uP.OutlierDetectionLoadBalancingConfig}})});var Tb=D(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.setup=void 0;var dP=wn(),nm=class{constructor(e,t,r){this.listener=t,this.addresses=[],this.hasReturnedResult=!1;let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function hP(){(0,dP.registerResolver)("unix",nm)}eu.setup=hP});var Rb=D(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.setup=void 0;var Ab=pe("net"),tu=fe(),rm=wt(),Ib=wn(),Db=Ot(),fP=Fe(),pP="ip_resolver";function xb(n){fP.trace(tu.LogVerbosity.DEBUG,pP,n)}var im="ipv4",sm="ipv6",mP=443,nu=class{constructor(e,t,r){var i;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,xb("Resolver constructed for target "+(0,Db.uriToString)(e));let s=[];if(!(e.scheme===im||e.scheme===sm)){this.error={code:tu.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new rm.Metadata};return}let o=e.path.split(",");for(let a of o){let l=(0,Db.splitHostPort)(a);if(l===null){this.error={code:tu.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new rm.Metadata};return}if(e.scheme===im&&!(0,Ab.isIPv4)(l.host)||e.scheme===sm&&!(0,Ab.isIPv6)(l.host)){this.error={code:tu.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new rm.Metadata};return}s.push({host:l.host,port:(i=l.port)!==null&&i!==void 0?i:mP})}this.addresses=s,xb("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function gP(){(0,Ib.registerResolver)(im,nu),(0,Ib.registerResolver)(sm,nu)}ru.setup=gP});var Mb=D(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});Bn.setup=Bn.PickFirstLoadBalancer=Bn.shuffled=Bn.PickFirstLoadBalancingConfig=void 0;var kb=Er(),lt=zt(),iu=Ir(),yP=Fe(),vP=fe(),_P="pick_first";function om(n){yP.trace(vP.LogVerbosity.DEBUG,_P,n)}var la="pick_first",CP=250,ca=class n{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return la}toJsonObject(){return{[la]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new n(e.shuffleAddressList===!0)}};Bn.PickFirstLoadBalancingConfig=ca;var am=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:iu.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function Ob(n){let e=n.slice();for(let t=e.length-1;t>1;t--){let r=Math.floor(Math.random()*(t+1)),i=e[t];e[t]=e[r],e[r]=i}return e}Bn.shuffled=Ob;var su=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=lt.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.onSubchannelStateUpdate(t,r,i,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(lt.ConnectivityState.READY,new am(this.currentPick)):this.children.length===0?this.updateState(lt.ConnectivityState.IDLE,new iu.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(lt.ConnectivityState.TRANSIENT_FAILURE,new iu.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(lt.ConnectivityState.CONNECTING,new iu.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,i){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){r!==lt.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){r===lt.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),r===lt.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let i=r.subchannel.getConnectivityState();if(i===lt.ConnectivityState.IDLE||i===lt.ConnectivityState.CONNECTING){this.startConnecting(t);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===lt.ConnectivityState.IDLE&&(om("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var i;(i=this.children[e])===null||i===void 0||i.subchannel.startConnecting()})),this.connectionDelayTimeout=(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},CP)).unref)===null||r===void 0?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(om("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){om(lt.ConnectivityState[this.currentState]+" -> "+lt.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(r=>({subchannel:this.channelControlHelper.createSubchannel(r,{}),hasReportedTransientFailure:!1}));for(let{subchannel:r}of t)r.ref(),this.channelControlHelper.addChannelzChild(r.getChannelzRef());this.resetSubchannelList(),this.children=t;for(let{subchannel:r}of this.children)if(r.addConnectivityStateListener(this.subchannelStateListener),r.getConnectivityState()===lt.ConnectivityState.READY){this.pickSubchannel(r);return}for(let r of this.children)r.subchannel.getConnectivityState()===lt.ConnectivityState.TRANSIENT_FAILURE&&(r.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof ca&&(t.getShuffleAddressList()&&(e=Ob(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===lt.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return la}};Bn.PickFirstLoadBalancer=su;function SP(){(0,kb.registerLoadBalancerType)(la,su,ca),(0,kb.registerDefaultLoadBalancerType)(la)}Bn.setup=SP});var Nb=D(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});Fs.setup=Fs.RoundRobinLoadBalancer=void 0;var bP=Er(),ct=zt(),ou=Ir(),EP=An(),wP=Fe(),TP=fe(),AP="round_robin";function Pb(n){wP.trace(TP.LogVerbosity.DEBUG,AP,n)}var au="round_robin",lm=class n{getLoadBalancerName(){return au}constructor(){}toJsonObject(){return{[au]:{}}}static createFromJson(e){return new n}},cm=class{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:ou.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},lu=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=ct.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(t,r,i,s,o)=>{this.calculateAndUpdateState(),(i===ct.ConnectivityState.TRANSIENT_FAILURE||i===ct.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),t.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(ct.ConnectivityState.READY)>0){let e=this.subchannels.filter(r=>r.getConnectivityState()===ct.ConnectivityState.READY),t=0;this.currentReadyPicker!==null&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),t<0&&(t=0)),this.updateState(ct.ConnectivityState.READY,new cm(e,t))}else this.countSubchannelsWithState(ct.ConnectivityState.CONNECTING)>0?this.updateState(ct.ConnectivityState.CONNECTING,new ou.QueuePicker(this)):this.countSubchannelsWithState(ct.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(ct.ConnectivityState.TRANSIENT_FAILURE,new ou.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(ct.ConnectivityState.IDLE,new ou.QueuePicker(this))}updateState(e,t){Pb(ct.ConnectivityState[this.currentState]+" -> "+ct.ConnectivityState[e]),e===ct.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList(),Pb("Connect to address list "+e.map(r=>(0,EP.subchannelAddressToString)(r))),this.subchannels=e.map(r=>this.channelControlHelper.createSubchannel(r,{}));for(let r of this.subchannels){r.ref(),r.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(r.getChannelzRef());let i=r.getConnectivityState();(i===ct.ConnectivityState.IDLE||i===ct.ConnectivityState.TRANSIENT_FAILURE)&&r.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return au}};Fs.RoundRobinLoadBalancer=lu;function IP(){(0,bP.registerLoadBalancerType)(au,lu,lm)}Fs.setup=IP});var Bb=D(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.experimental=q.addAdminServicesToServer=q.getChannelzHandlers=q.getChannelzServiceDefinition=q.InterceptorConfigurationError=q.InterceptingCall=q.RequesterBuilder=q.ListenerBuilder=q.StatusBuilder=q.getClientChannel=q.ServerCredentials=q.Server=q.setLogVerbosity=q.setLogger=q.load=q.loadObject=q.CallCredentials=q.ChannelCredentials=q.waitForClientReady=q.closeClient=q.Channel=q.makeGenericClientConstructor=q.makeClientConstructor=q.loadPackageDefinition=q.Client=q.compressionAlgorithms=q.propagate=q.connectivityState=q.status=q.logVerbosity=q.Metadata=q.credentials=void 0;var cu=ih();Object.defineProperty(q,"CallCredentials",{enumerable:!0,get:function(){return cu.CallCredentials}});var DP=Fh();Object.defineProperty(q,"Channel",{enumerable:!0,get:function(){return DP.ChannelImplementation}});var xP=pp();Object.defineProperty(q,"compressionAlgorithms",{enumerable:!0,get:function(){return xP.CompressionAlgorithms}});var RP=zt();Object.defineProperty(q,"connectivityState",{enumerable:!0,get:function(){return RP.ConnectivityState}});var uu=wl();Object.defineProperty(q,"ChannelCredentials",{enumerable:!0,get:function(){return uu.ChannelCredentials}});var Fb=Nh();Object.defineProperty(q,"Client",{enumerable:!0,get:function(){return Fb.Client}});var um=fe();Object.defineProperty(q,"logVerbosity",{enumerable:!0,get:function(){return um.LogVerbosity}});Object.defineProperty(q,"status",{enumerable:!0,get:function(){return um.Status}});Object.defineProperty(q,"propagate",{enumerable:!0,get:function(){return um.Propagate}});var Lb=Fe(),dm=Vh();Object.defineProperty(q,"loadPackageDefinition",{enumerable:!0,get:function(){return dm.loadPackageDefinition}});Object.defineProperty(q,"makeClientConstructor",{enumerable:!0,get:function(){return dm.makeClientConstructor}});Object.defineProperty(q,"makeGenericClientConstructor",{enumerable:!0,get:function(){return dm.makeClientConstructor}});var kP=wt();Object.defineProperty(q,"Metadata",{enumerable:!0,get:function(){return kP.Metadata}});var OP=yb();Object.defineProperty(q,"Server",{enumerable:!0,get:function(){return OP.Server}});var MP=qp();Object.defineProperty(q,"ServerCredentials",{enumerable:!0,get:function(){return MP.ServerCredentials}});var PP=vb();Object.defineProperty(q,"StatusBuilder",{enumerable:!0,get:function(){return PP.StatusBuilder}});q.credentials={combineChannelCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),combineCallCredentials:(n,...e)=>e.reduce((t,r)=>t.compose(r),n),createInsecure:uu.ChannelCredentials.createInsecure,createSsl:uu.ChannelCredentials.createSsl,createFromSecureContext:uu.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:cu.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:cu.CallCredentials.createFromGoogleCredential,createEmpty:cu.CallCredentials.createEmpty};var NP=n=>n.close();q.closeClient=NP;var FP=(n,e,t)=>n.waitForReady(e,t);q.waitForClientReady=FP;var LP=(n,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};q.loadObject=LP;var VP=(n,e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};q.load=VP;var BP=n=>{Lb.setLogger(n)};q.setLogger=BP;var UP=n=>{Lb.setLoggerVerbosity(n)};q.setLogVerbosity=UP;var qP=n=>Fb.Client.prototype.getChannel.call(n);q.getClientChannel=qP;var du=Oh();Object.defineProperty(q,"ListenerBuilder",{enumerable:!0,get:function(){return du.ListenerBuilder}});Object.defineProperty(q,"RequesterBuilder",{enumerable:!0,get:function(){return du.RequesterBuilder}});Object.defineProperty(q,"InterceptingCall",{enumerable:!0,get:function(){return du.InterceptingCall}});Object.defineProperty(q,"InterceptorConfigurationError",{enumerable:!0,get:function(){return du.InterceptorConfigurationError}});var Vb=_i();Object.defineProperty(q,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Vb.getChannelzServiceDefinition}});Object.defineProperty(q,"getChannelzHandlers",{enumerable:!0,get:function(){return Vb.getChannelzHandlers}});var zP=Ml();Object.defineProperty(q,"addAdminServicesToServer",{enumerable:!0,get:function(){return zP.addAdminServicesToServer}});var jP=em();q.experimental=jP;var GP=tp(),$P=Tb(),WP=Rb(),HP=Mb(),KP=Nb(),QP=Zp(),YP=_i();GP.setup(),$P.setup(),WP.setup(),HP.setup(),KP.setup(),QP.setup(),YP.setup()});var bv=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(Q(co),Q(lo))}}static{this.\u0275dir=Qe({type:n})}}return n})(),sl=(()=>{class n extends bv{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,features:[kt]})}}return n})(),$i=new Oe("");var XT={provide:$i,useExisting:vn(()=>bn),multi:!0};function JT(){let n=md()?md().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var ZT=new Oe(""),bn=(()=>{class n extends bv{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!JT())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(co),Q(lo),Q(ZT,8))}}static{this.\u0275dir=Qe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&he("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[_n([XT]),kt]})}}return n})();function mr(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}function Ev(n){return n!=null&&typeof n.length=="number"}var Eo=new Oe(""),kd=new Oe(""),eA=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Qn=class{static min(e){return wv(e)}static max(e){return tA(e)}static required(e){return Tv(e)}static requiredTrue(e){return nA(e)}static email(e){return rA(e)}static minLength(e){return iA(e)}static maxLength(e){return sA(e)}static pattern(e){return oA(e)}static nullValidator(e){return Xa(e)}static compose(e){return kv(e)}static composeAsync(e){return Mv(e)}};function wv(n){return e=>{if(mr(e.value)||mr(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function tA(n){return e=>{if(mr(e.value)||mr(n))return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function Tv(n){return mr(n.value)?{required:!0}:null}function nA(n){return n.value===!0?null:{required:!0}}function rA(n){return mr(n.value)||eA.test(n.value)?null:{email:!0}}function iA(n){return e=>mr(e.value)||!Ev(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}function sA(n){return e=>Ev(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function oA(n){if(!n)return Xa;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(mr(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function Xa(n){return null}function Av(n){return n!=null}function Iv(n){return Qy(n)?Rt(n):n}function Dv(n){let e={};return n.forEach(t=>{e=t!=null?mt(mt({},e),t):e}),Object.keys(e).length===0?null:e}function xv(n,e){return e.map(t=>t(n))}function aA(n){return!n.validate}function Rv(n){return n.map(e=>aA(e)?e:t=>e.validate(t))}function kv(n){if(!n)return null;let e=n.filter(Av);return e.length==0?null:function(t){return Dv(xv(t,e))}}function Ov(n){return n!=null?kv(Rv(n)):null}function Mv(n){if(!n)return null;let e=n.filter(Av);return e.length==0?null:function(t){let r=xv(t,e).map(Iv);return Uy(r).pipe(Wn(Dv))}}function Pv(n){return n!=null?Mv(Rv(n)):null}function fv(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Nv(n){return n._rawValidators}function Fv(n){return n._rawAsyncValidators}function Td(n){return n?Array.isArray(n)?n:[n]:[]}function Ja(n,e){return Array.isArray(n)?n.includes(e):n===e}function pv(n,e){let t=Td(e);return Td(n).forEach(i=>{Ja(t,i)||t.push(i)}),t}function mv(n,e){return Td(e).filter(t=>!Ja(n,t))}var Za=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ov(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Pv(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},li=class extends Za{get formDirective(){return null}get path(){return null}},ci=class extends Za{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},el=class{constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},lA={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},aU=xt(mt({},lA),{"[class.ng-submitted]":"isSubmitted"}),yr=(()=>{class n extends el{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(ci,2))}}static{this.\u0275dir=Qe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&dd("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[kt]})}}return n})(),ol=(()=>{class n extends el{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(li,10))}}static{this.\u0275dir=Qe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&dd("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[kt]})}}return n})();var vo="VALID",Ya="INVALID",zi="PENDING",_o="DISABLED",gr=class{},tl=class extends gr{constructor(e,t){super(),this.value=e,this.source=t}},Co=class extends gr{constructor(e,t){super(),this.pristine=e,this.source=t}},So=class extends gr{constructor(e,t){super(),this.touched=e,this.source=t}},ji=class extends gr{constructor(e,t){super(),this.status=e,this.source=t}},Ad=class extends gr{constructor(e){super(),this.source=e}},Id=class extends gr{constructor(e){super(),this.source=e}};function Od(n){return(al(n)?n.validators:n)||null}function cA(n){return Array.isArray(n)?Ov(n):n||null}function Md(n,e){return(al(e)?e.asyncValidators:n)||null}function uA(n){return Array.isArray(n)?Pv(n):n||null}function al(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function Lv(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new za(1e3,"");if(!r[t])throw new za(1001,"")}function Vv(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new za(1002,"")})}var Gi=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=mo(()=>this.statusReactive()),this.statusReactive=oi(void 0),this._pristine=mo(()=>this.pristineReactive()),this.pristineReactive=oi(!0),this._touched=mo(()=>this.touchedReactive()),this.touchedReactive=oi(!1),this._events=new Ua,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return hr(this.statusReactive)}set status(e){hr(()=>this.statusReactive.set(e))}get valid(){return this.status===vo}get invalid(){return this.status===Ya}get pending(){return this.status==zi}get disabled(){return this.status===_o}get enabled(){return this.status!==_o}get pristine(){return hr(this.pristineReactive)}set pristine(e){hr(()=>this.pristineReactive.set(e))}get dirty(){return!this.pristine}get touched(){return hr(this.touchedReactive)}set touched(e){hr(()=>this.touchedReactive.set(e))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(pv(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(pv(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(mv(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(mv(e,this._rawAsyncValidators))}hasValidator(e){return Ja(this._rawValidators,e)}hasAsyncValidator(e){return Ja(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(xt(mt({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new So(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new So(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(xt(mt({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Co(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Co(!0,r))}markAsPending(e={}){this.status=zi;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new ji(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(xt(mt({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=_o,this.errors=null,this._forEachChild(i=>{i.disable(xt(mt({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new tl(this.value,r)),this._events.next(new ji(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(xt(mt({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=vo,this._forEachChild(r=>{r.enable(xt(mt({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(xt(mt({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vo||this.status===zi)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new tl(this.value,t)),this._events.next(new ji(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(xt(mt({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?_o:vo}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=zi,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Iv(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new ji(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Ui,this.statusChanges=new Ui}_calculateStatus(){return this._allControlsDisabled()?_o:this.errors?Ya:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(zi)?zi:this._anyControlsHaveStatus(Ya)?Ya:vo}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Co(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new So(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){al(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=cA(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=uA(this._rawAsyncValidators)}},nl=class extends Gi{constructor(e,t,r){super(Od(t),Md(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){Vv(this,!0,e),Object.keys(e).forEach(r=>{Lv(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Dd=class extends nl{};var ll=new Oe("CallSetDisabledState",{providedIn:"root",factory:()=>cl}),cl="always";function Bv(n,e){return[...e.path,n]}function xd(n,e,t=cl){Pd(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),hA(n,e),pA(n,e),fA(n,e),dA(n,e)}function gv(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),il(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function rl(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function dA(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Pd(n,e){let t=Nv(n);e.validator!==null?n.setValidators(fv(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Fv(n);e.asyncValidator!==null?n.setAsyncValidators(fv(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();rl(e._rawValidators,i),rl(e._rawAsyncValidators,i)}function il(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=Nv(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=Fv(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return rl(e._rawValidators,r),rl(e._rawAsyncValidators,r),t}function hA(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Uv(n,e)})}function fA(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Uv(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Uv(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function pA(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function mA(n,e){n==null,Pd(n,e)}function gA(n,e){return il(n,e)}function qv(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function yA(n){return Object.getPrototypeOf(n.constructor)===sl}function vA(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function zv(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===bn?t=s:yA(s)?r=s:i=s}),i||r||t||null}function _A(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function yv(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function vv(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var bo=class extends Gi{constructor(e=null,t,r){super(Od(t),Md(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),al(t)&&(t.nonNullable||t.initialValueIsDefault)&&(vv(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){yv(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){yv(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){vv(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var CA=n=>n instanceof bo;var SA={provide:ci,useExisting:vn(()=>wo)},_v=Promise.resolve(),wo=(()=>{class n extends ci{constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new bo,this._registered=!1,this.name="",this.update=new Ui,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=zv(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),qv(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){xd(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){_v.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&pd(r);_v.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?Bv(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(Q(li,9),Q(Eo,10),Q(kd,10),Q($i,10),Q(Xy,8),Q(ll,8))}}static{this.\u0275dir=Qe({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[_n([SA]),kt,ao]})}}return n})(),ul=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Qe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})(),bA={provide:$i,useExisting:vn(()=>Nd),multi:!0},Nd=(()=>{class n extends sl{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&he("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[_n([bA]),kt]})}}return n})();var jv=new Oe("");var EA={provide:li,useExisting:vn(()=>To)},To=(()=>{class n extends li{get submitted(){return hr(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=mo(()=>this._submittedReactive()),this._submittedReactive=oi(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ui,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(il(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return xd(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){gv(t.control||null,t,!1),_A(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),vA(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Ad(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Id(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(gv(r||null,t),CA(i)&&(xd(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);mA(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&gA(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Pd(this.form,this),this._oldForm&&il(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||n)(Q(Eo,10),Q(kd,10),Q(ll,8))}}static{this.\u0275dir=Qe({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&he("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_n([EA]),kt,ao]})}}return n})();var wA={provide:ci,useExisting:vn(()=>Ao)},Ao=(()=>{class n extends ci{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Ui,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=zv(this,s)}ngOnChanges(t){this._added||this._setUpControl(),qv(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Bv(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||n)(Q(li,13),Q(Eo,10),Q(kd,10),Q($i,10),Q(jv,8))}}static{this.\u0275dir=Qe({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[_n([wA]),kt,ao]})}}return n})(),TA={provide:$i,useExisting:vn(()=>dl),multi:!0};function Gv(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function AA(n){return n.split(":")[0]}var dl=(()=>{class n extends sl{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r=this._getOptionId(t),i=Gv(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=AA(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&he("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[_n([TA]),kt]})}}return n})(),$v=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Gv(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(Q(lo),Q(co),Q(dl,9))}}static{this.\u0275dir=Qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})(),IA={provide:$i,useExisting:vn(()=>Wv),multi:!0};function Cv(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function DA(n){return n.split(":")[0]}var Wv=(()=>{class n extends sl{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(s=>this._getOptionId(s));r=(s,o)=>{s._setSelected(i.indexOf(o.toString())>-1)}}else r=(i,s)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],s=r.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let l=o[a],c=this._getOptionValue(l.value);i.push(c)}}else{let o=r.options;for(let a=0;a<o.length;a++){let l=o[a];if(l.selected){let c=this._getOptionValue(l.value);i.push(c)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=DA(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&he("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[_n([IA]),kt]})}}return n})(),Hv=(()=>{class n{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Cv(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Cv(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||n)(Q(lo),Q(co),Q(Wv,9))}}static{this.\u0275dir=Qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();function xA(n){return typeof n=="number"?n:parseFloat(n)}var Kv=(()=>{class n{constructor(){this._validator=Xa}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Xa,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Qe({type:n,features:[ao]})}}return n})();var RA={provide:Eo,useExisting:vn(()=>Fd),multi:!0},Fd=(()=>{class n extends Kv{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>xA(t),this.createValidator=t=>wv(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&ud("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[_n([RA]),kt]})}}return n})(),kA={provide:Eo,useExisting:vn(()=>Io),multi:!0};var Io=(()=>{class n extends Kv{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=pd,this.createValidator=t=>Tv}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ii(n)))(i||n)}})()}static{this.\u0275dir=Qe({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&ud("required",i._enabled?"":null)},inputs:{required:"required"},features:[_n([kA]),kt]})}}return n})();var Qv=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Bt({type:n})}static{this.\u0275inj=Lt({})}}return n})(),Rd=class extends Gi{constructor(e,t,r){super(Od(t),Md(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){Vv(this,!1,e),e.forEach((r,i)=>{Lv(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Sv(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var hl=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return Sv(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new nl(i,s)}record(t,r=null){let i=this._reduceControls(t);return new Dd(i,r)}control(t,r,i){let s={};return this.useNonNullable?(Sv(r)?s=r:(s.validators=r,s.asyncValidators=i),new bo(t,xt(mt({},s),{nonNullable:!0}))):new bo(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new Rd(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof bo)return t;if(t instanceof Gi)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Wi=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ll,useValue:t.callSetDisabledState??cl}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Bt({type:n})}static{this.\u0275inj=Lt({imports:[Qv]})}}return n})(),fl=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:jv,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:ll,useValue:t.callSetDisabledState??cl}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Bt({type:n})}static{this.\u0275inj=Lt({imports:[Qv]})}}return n})();var OA="firebase",MA="10.14.1";He(OA,MA,"app");var bt=new hd("ANGULARFIRE2_VERSION");function gl(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Do=(n,e)=>{let t=e?[e]:Ka(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},vr=class{constructor(){return Do(PA)}},PA="app-check";function Hi(){}var ml=class{zone;delegate;constructor(e,t=By){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},Ld=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Hi,{},Hi,Hi)),t.pipe($y({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},di=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new ml(Zone.current)),this.insideAngular=t.run(()=>new ml(Zone.current,Vy)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Se(Zt))};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yl(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function NA(n){return yl().ngZone.runOutsideAngular(()=>n())}function ui(n){return yl().ngZone.run(()=>n())}function Vd(n){return FA(yl())(n)}function FA(n){return function(t){return t=t.lift(new Ld(n.ngZone)),t.pipe(ri(n.outsideAngular),ur(n.insideAngular))}}var LA=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ui(()=>n.apply(void 0,r))},nt=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=ui(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Hi,{},Hi,Hi))),r[s]=LA(r[s],t));let i=NA(()=>n.apply(this,r));if(!e)if(i instanceof yn){let s=yl();return i.pipe(ri(s.outsideAngular),ur(s.insideAngular))}else return ui(()=>i);return i instanceof yn?i.pipe(Vd):i instanceof Promise?ui(()=>new Promise((s,o)=>i.then(a=>ui(()=>s(a)),a=>ui(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:ui(()=>i)};var Yn=class{constructor(e){return e}},Ki=class{constructor(){return Ka()}};function BA(n){return n&&n.length===1?n[0]:new Yn(Ha())}var Bd=new Oe("angularfire2._apps"),Yv={provide:Yn,useFactory:BA,deps:[[new Vt,Bd]]},Xv={provide:Ki,deps:[[new Vt,Bd]]};function UA(n){return(e,t)=>{let r=t.get(si);He("angularfire",bt.full,"core"),He("angularfire",bt.full,"app"),He("angular",po.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Yn(i)}}var Jv=(()=>{class n{constructor(t){He("angularfire",bt.full,"core"),He("angularfire",bt.full,"app"),He("angular",po.full,t.toString())}static \u0275fac=function(r){return new(r||n)(Se(si))};static \u0275mod=Bt({type:n});static \u0275inj=Lt({providers:[Yv,Xv]})}return n})();function Ud(n,...e){return so([Yv,Xv,{provide:Bd,useFactory:UA(n),multi:!0,deps:[Zt,Bi,di,...e]}])}var qd=nt(hv,!0);var lq=od(YT(),1);function t0(n){return new yn(function(e){var t=Qa(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var n0="auth",hi=class{constructor(e){return e}},zd=class{constructor(){return Do(n0)}};var jd=new Oe("angularfire2.auth-instances");function M1(n,e){let t=gl(n0,n,e);return t&&new hi(t)}function P1(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new hi(r)}}var N1={provide:zd,deps:[[new Vt,jd]]},F1={provide:hi,useFactory:M1,deps:[[new Vt,jd],Yn]};function r0(n,...e){return He("angularfire",bt.full,"auth"),so([F1,N1,{provide:jd,useFactory:P1(n),multi:!0,deps:[Zt,Bi,di,Ki,[new Vt,vr],...e]}])}var i0=nt(t0,!0);var s0=nt(Cd,!0);var o0=nt(wd,!0);var a0=nt(Sd,!0);var l0=nt(Ed,!0);var c0=nt(bd,!0);var Et=(()=>{class n{firebaseauth=Ne(hi);user$=i0(this.firebaseauth);currentUserSig=oi(void 0);getUserId(){return R(this,null,function*(){let t=yield this.firebaseauth.currentUser;return t?t.uid:null})}register(t,r,i){let s=s0(this.firebaseauth,t,i).then(o=>c0(o.user,{displayName:r}));return Rt(s)}login(t,r){let i=a0(this.firebaseauth,t,r).then(()=>{});return Rt(i)}logout(){let t=l0(this.firebaseauth);return Rt(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Qi=(()=>{class n{http;constructor(t){this.http=t}productsAPI="https://dummyjson.com/products";categoriesAPI="https://dummyjson.com/products/category-list";searchResults$;getProducts(){return this.http.get(this.productsAPI)}getCategoriesOfProducts(){return this.http.get(this.categoriesAPI)}getProductById(t){return this.http.get(`https://dummyjson.com/products/${t}`)}static \u0275fac=function(r){return new(r||n)(Se(pr))};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Yi=(()=>{class n{http;searchTermSubject=new ni("");searchTerm$=this.searchTermSubject.asObservable();categorySubject=new ni("");category$=this.categorySubject.asObservable();constructor(t){this.http=t,qa([this.searchTerm$,this.category$]).pipe(jy(300),Jt(([r,i])=>this.searchProducts(r,i))).subscribe(r=>{console.log("Search results:",r)})}setSearchTerm(t){this.searchTermSubject.next(t)}setCategory(t){this.categorySubject.next(t)}searchProducts(t,r){let i=`https://dummyjson.com/products/search?q=${t}`;return r&&(i=`https://dummyjson.com/products/category/${r}`),this.http.get(i)}static \u0275fac=function(r){return new(r||n)(Se(pr))};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function V1(n,e){if(n&1&&(b(0,"option",25),w(1),E()),n&2){let t=e.$implicit;ie("value",t),V(),le(" ",t," ")}}function B1(n,e){if(n&1){let t=en();b(0,"li",8)(1,"a",26),he("click",function(){gt(t);let i=Ie();return yt(i.login())}),w(2," Connexion "),E()()}}function U1(n,e){if(n&1){let t=en();b(0,"li",8)(1,"a",26),he("click",function(){gt(t);let i=Ie();return yt(i.logout())}),w(2," Deconnexion "),E()()}}var d0=(()=>{class n{productService;searchService;router;selectedCategory="";searchKey="";categories=[];constructor(t,r,i){this.productService=t,this.searchService=r,this.router=i}authService=Ne(Et);ngOnInit(){this.productService.getCategoriesOfProducts().subscribe(t=>{this.categories=t}),this.authService.user$.subscribe(t=>{t?this.authService.currentUserSig.set({email:t.email,username:t.displayName}):this.authService.currentUserSig.set(null),console.log(this.authService.currentUserSig())})}onSearch(t){this.searchService.setCategory(""),this.searchService.setSearchTerm(t),this.router.navigate(["/products"])}onCategoryChange(){this.searchService.setCategory(this.selectedCategory),this.router.navigate(["/products"])}logout(){this.authService.logout(),this.router.navigateByUrl("/")}login(){this.router.navigateByUrl("signin")}static \u0275fac=function(r){return new(r||n)(Q(Qi),Q(Yi),Q(Ye))};static \u0275cmp=ve({type:n,selectors:[["app-navbar"]],standalone:!0,features:[_e],decls:43,vars:5,consts:[[1,"navbar","navbar-expand-lg","navbar-dark"],[1,"container-fluid"],["routerLink","/","routerLinkActive","active",1,"navbar-brand"],["src","unv.png","alt","Universe Logo","height","120"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","routerLink","/","routerLinkActive","active",1,"nav-link","active"],["routerLink","future","routerLinkActive","actice",1,"nav-link"],["role","searchbox",1,"d-flex","gap-2"],[1,"categories-dropdown"],[1,"dropdown-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["role","search",1,"d-flex"],["type","search","placeholder","Search","aria-label","Search",1,"dd","form-control","me-2",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-outline"],[1,"panier","fa-sharp","fa-solid","fa-magnifying-glass"],[1,"navbar-nav","mb-2","mb-lg-0"],["routerLink","/account","routerLinkActive","active",1,"nav-link"],["routerLink","/orders","routerLinkActive","active",1,"nav-link"],["routerLink","/panier","routerLinkActive","active",1,"nav-link"],[1,"fa-solid","fa-cart-shopping"],[3,"value"],[1,"btn","btn-outline",3,"click"]],template:function(r,i){r&1&&(b(0,"nav",0)(1,"div",1)(2,"a",2),j(3,"img",3),w(4," UNIVERSO "),E(),b(5,"button",4),j(6,"span",5),E(),b(7,"div",6)(8,"ul",7)(9,"li",8)(10,"a",9),w(11,"Home"),E()(),b(12,"li",8)(13,"a",10),w(14,"Prime"),E()(),b(15,"li",8)(16,"a",10),w(17,"Deals"),E()(),b(18,"li",8)(19,"a",10),w(20,"Customer Service"),E()()(),b(21,"div",11)(22,"div",12)(23,"select",13),fo("ngModelChange",function(o){return ho(i.selectedCategory,o)||(i.selectedCategory=o),o}),he("ngModelChange",function(){return i.onCategoryChange()}),b(24,"option",14),w(25,"All"),E(),we(26,V1,2,2,"option",15),E()(),b(27,"div",16)(28,"input",17),he("ngModelChange",function(o){return i.onSearch(o)}),fo("ngModelChange",function(o){return ho(i.searchKey,o)||(i.searchKey=o),o}),E(),b(29,"button",18),j(30,"i",19),E()()(),b(31,"ul",20),we(32,B1,3,0,"li",8)(33,U1,3,0,"li",8),b(34,"li",8)(35,"a",21),w(36," Account "),E()(),b(37,"li",8)(38,"a",22),w(39,"Orders"),E()(),b(40,"li",8)(41,"a",23),j(42,"i",24),E()()()()()()),r&2&&(V(23),uo("ngModel",i.selectedCategory),V(3),ie("ngForOf",i.categories),V(2),uo("ngModel",i.searchKey),V(4),ai(i.authService.currentUserSig()==null?32:-1),V(),ai(i.authService.currentUserSig()?33:-1))},dependencies:[St,Wi,$v,Hv,bn,dl,yr,wo,Ut,Cn,Sn],styles:[".navbar-brand[_ngcontent-%COMP%]{font-weight:700;color:#000}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#030000}.navbar-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#61c206}.navbar-nav[_ngcontent-%COMP%]   ms-auto[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.navbar-nav[_ngcontent-%COMP%]   ms-auto[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#73ff00}.categories-dropdown[_ngcontent-%COMP%]{margin-right:0}.categories-dropdown[_ngcontent-%COMP%]   .dropdown-select[_ngcontent-%COMP%]{appearance:y;border:1px solid #ced4da;padding:.5rem 1rem;font-size:16px;background-color:#fff;color:#495057;border-radius:8px;width:120px}.categories-dropdown[_ngcontent-%COMP%]   .dropdown-select[_ngcontent-%COMP%]:focus{border-color:#0a2645;outline:none;box-shadow:0 0 0 .2rem #007bff40}.form-control[_ngcontent-%COMP%]:focus{outline:none;transition:all .4s ease-in-out}.form-control[_ngcontent-%COMP%]{width:500px}"]})}return n})();var _r=(()=>{class n{email="UNIVERSO@gmail.com";static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-footer"]],standalone:!0,features:[_e],decls:40,vars:1,consts:[[1,"footer"],[1,"container"],[1,"row"],[1,"col-md-4"],[1,"footer-links"],["routerLink","/home","routerLinkActive","active"],["routerLink","/contactus","routerLinkActive","active"],["routerLink","/about","routerLinkActive","active"],[1,"social-links"],[1,"fa-brands","fa-facebook"],[1,"fa-brands","fa-square-x-twitter"],[1,"fa-brands","fa-instagram"],[1,"footer-bottom"]],template:function(r,i){r&1&&(b(0,"footer",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),w(5,"About Us"),E(),b(6,"p"),w(7," We are an online store offering a wide range of products from sports, beauty, furniture, tablets, laptops, and much more. "),E()(),b(8,"div",3)(9,"h5"),w(10,"Quick Links"),E(),b(11,"ul",4)(12,"li")(13,"a",5),w(14,"Home"),E()(),b(15,"li")(16,"a",6),w(17,"Contact Us"),E()(),b(18,"li")(19,"a",7),w(20,"About Us"),E()()()(),b(21,"div",3)(22,"h5"),w(23,"Contact Us"),E(),b(24,"p"),w(25),j(26,"br"),w(27," Phone: +212 689 802 208 "),j(28,"br"),w(29," Address: Rabat Agdal, Morocco. "),E(),b(30,"div",8)(31,"a"),j(32,"i",9),E(),b(33,"a"),j(34,"i",10),E(),b(35,"a"),j(36,"i",11),E()()()()(),b(37,"div",12)(38,"p"),w(39,"\xA9 2024 UNIVERSO. All rights reserved."),E()()()),r&2&&(V(25),le(" ",i.email," "))},dependencies:[Ut,Cn,Sn],styles:[".footer[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:40px 0;color:#333}.footer[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:700;margin-bottom:20px}.footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#6c757d}.footer-links[_ngcontent-%COMP%]{list-style:none;padding:0}.footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4bc305;text-decoration:none}.footer-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.social-links[_ngcontent-%COMP%]{margin-top:20px}.social-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:18px;color:#4bc305;margin-right:15px;transition:color .3s}.social-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#333}.footer-bottom[_ngcontent-%COMP%]{text-align:center;padding:15px 0;background-color:#e9ecef;font-size:14px;color:#6c757d}"]})}return n})();import{inspect as JP,TextEncoder as ZP,TextDecoder as a6}from"util";import{randomBytes as eN}from"crypto";var h0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},f0={};var Cr,Wd;(function(){var n;function e(_,m){function y(){}y.prototype=m.prototype,_.D=m.prototype,_.prototype=new y,_.prototype.constructor=_,_.C=function(v,h,S){for(var d=Array(arguments.length-2),f=2;f<arguments.length;f++)d[f-2]=arguments[f];return m.prototype[h].apply(v,d)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(_,m,y){y||(y=0);var v=Array(16);if(typeof m=="string")for(var h=0;16>h;++h)v[h]=m.charCodeAt(y++)|m.charCodeAt(y++)<<8|m.charCodeAt(y++)<<16|m.charCodeAt(y++)<<24;else for(h=0;16>h;++h)v[h]=m[y++]|m[y++]<<8|m[y++]<<16|m[y++]<<24;m=_.g[0],y=_.g[1],h=_.g[2];var S=_.g[3],d=m+(S^y&(h^S))+v[0]+3614090360&4294967295;m=y+(d<<7&4294967295|d>>>25),d=S+(h^m&(y^h))+v[1]+3905402710&4294967295,S=m+(d<<12&4294967295|d>>>20),d=h+(y^S&(m^y))+v[2]+606105819&4294967295,h=S+(d<<17&4294967295|d>>>15),d=y+(m^h&(S^m))+v[3]+3250441966&4294967295,y=h+(d<<22&4294967295|d>>>10),d=m+(S^y&(h^S))+v[4]+4118548399&4294967295,m=y+(d<<7&4294967295|d>>>25),d=S+(h^m&(y^h))+v[5]+1200080426&4294967295,S=m+(d<<12&4294967295|d>>>20),d=h+(y^S&(m^y))+v[6]+2821735955&4294967295,h=S+(d<<17&4294967295|d>>>15),d=y+(m^h&(S^m))+v[7]+4249261313&4294967295,y=h+(d<<22&4294967295|d>>>10),d=m+(S^y&(h^S))+v[8]+1770035416&4294967295,m=y+(d<<7&4294967295|d>>>25),d=S+(h^m&(y^h))+v[9]+2336552879&4294967295,S=m+(d<<12&4294967295|d>>>20),d=h+(y^S&(m^y))+v[10]+4294925233&4294967295,h=S+(d<<17&4294967295|d>>>15),d=y+(m^h&(S^m))+v[11]+2304563134&4294967295,y=h+(d<<22&4294967295|d>>>10),d=m+(S^y&(h^S))+v[12]+1804603682&4294967295,m=y+(d<<7&4294967295|d>>>25),d=S+(h^m&(y^h))+v[13]+4254626195&4294967295,S=m+(d<<12&4294967295|d>>>20),d=h+(y^S&(m^y))+v[14]+2792965006&4294967295,h=S+(d<<17&4294967295|d>>>15),d=y+(m^h&(S^m))+v[15]+1236535329&4294967295,y=h+(d<<22&4294967295|d>>>10),d=m+(h^S&(y^h))+v[1]+4129170786&4294967295,m=y+(d<<5&4294967295|d>>>27),d=S+(y^h&(m^y))+v[6]+3225465664&4294967295,S=m+(d<<9&4294967295|d>>>23),d=h+(m^y&(S^m))+v[11]+643717713&4294967295,h=S+(d<<14&4294967295|d>>>18),d=y+(S^m&(h^S))+v[0]+3921069994&4294967295,y=h+(d<<20&4294967295|d>>>12),d=m+(h^S&(y^h))+v[5]+3593408605&4294967295,m=y+(d<<5&4294967295|d>>>27),d=S+(y^h&(m^y))+v[10]+38016083&4294967295,S=m+(d<<9&4294967295|d>>>23),d=h+(m^y&(S^m))+v[15]+3634488961&4294967295,h=S+(d<<14&4294967295|d>>>18),d=y+(S^m&(h^S))+v[4]+3889429448&4294967295,y=h+(d<<20&4294967295|d>>>12),d=m+(h^S&(y^h))+v[9]+568446438&4294967295,m=y+(d<<5&4294967295|d>>>27),d=S+(y^h&(m^y))+v[14]+3275163606&4294967295,S=m+(d<<9&4294967295|d>>>23),d=h+(m^y&(S^m))+v[3]+4107603335&4294967295,h=S+(d<<14&4294967295|d>>>18),d=y+(S^m&(h^S))+v[8]+1163531501&4294967295,y=h+(d<<20&4294967295|d>>>12),d=m+(h^S&(y^h))+v[13]+2850285829&4294967295,m=y+(d<<5&4294967295|d>>>27),d=S+(y^h&(m^y))+v[2]+4243563512&4294967295,S=m+(d<<9&4294967295|d>>>23),d=h+(m^y&(S^m))+v[7]+1735328473&4294967295,h=S+(d<<14&4294967295|d>>>18),d=y+(S^m&(h^S))+v[12]+2368359562&4294967295,y=h+(d<<20&4294967295|d>>>12),d=m+(y^h^S)+v[5]+4294588738&4294967295,m=y+(d<<4&4294967295|d>>>28),d=S+(m^y^h)+v[8]+2272392833&4294967295,S=m+(d<<11&4294967295|d>>>21),d=h+(S^m^y)+v[11]+1839030562&4294967295,h=S+(d<<16&4294967295|d>>>16),d=y+(h^S^m)+v[14]+4259657740&4294967295,y=h+(d<<23&4294967295|d>>>9),d=m+(y^h^S)+v[1]+2763975236&4294967295,m=y+(d<<4&4294967295|d>>>28),d=S+(m^y^h)+v[4]+1272893353&4294967295,S=m+(d<<11&4294967295|d>>>21),d=h+(S^m^y)+v[7]+4139469664&4294967295,h=S+(d<<16&4294967295|d>>>16),d=y+(h^S^m)+v[10]+3200236656&4294967295,y=h+(d<<23&4294967295|d>>>9),d=m+(y^h^S)+v[13]+681279174&4294967295,m=y+(d<<4&4294967295|d>>>28),d=S+(m^y^h)+v[0]+3936430074&4294967295,S=m+(d<<11&4294967295|d>>>21),d=h+(S^m^y)+v[3]+3572445317&4294967295,h=S+(d<<16&4294967295|d>>>16),d=y+(h^S^m)+v[6]+76029189&4294967295,y=h+(d<<23&4294967295|d>>>9),d=m+(y^h^S)+v[9]+3654602809&4294967295,m=y+(d<<4&4294967295|d>>>28),d=S+(m^y^h)+v[12]+3873151461&4294967295,S=m+(d<<11&4294967295|d>>>21),d=h+(S^m^y)+v[15]+530742520&4294967295,h=S+(d<<16&4294967295|d>>>16),d=y+(h^S^m)+v[2]+3299628645&4294967295,y=h+(d<<23&4294967295|d>>>9),d=m+(h^(y|~S))+v[0]+4096336452&4294967295,m=y+(d<<6&4294967295|d>>>26),d=S+(y^(m|~h))+v[7]+1126891415&4294967295,S=m+(d<<10&4294967295|d>>>22),d=h+(m^(S|~y))+v[14]+2878612391&4294967295,h=S+(d<<15&4294967295|d>>>17),d=y+(S^(h|~m))+v[5]+4237533241&4294967295,y=h+(d<<21&4294967295|d>>>11),d=m+(h^(y|~S))+v[12]+1700485571&4294967295,m=y+(d<<6&4294967295|d>>>26),d=S+(y^(m|~h))+v[3]+2399980690&4294967295,S=m+(d<<10&4294967295|d>>>22),d=h+(m^(S|~y))+v[10]+4293915773&4294967295,h=S+(d<<15&4294967295|d>>>17),d=y+(S^(h|~m))+v[1]+2240044497&4294967295,y=h+(d<<21&4294967295|d>>>11),d=m+(h^(y|~S))+v[8]+1873313359&4294967295,m=y+(d<<6&4294967295|d>>>26),d=S+(y^(m|~h))+v[15]+4264355552&4294967295,S=m+(d<<10&4294967295|d>>>22),d=h+(m^(S|~y))+v[6]+2734768916&4294967295,h=S+(d<<15&4294967295|d>>>17),d=y+(S^(h|~m))+v[13]+1309151649&4294967295,y=h+(d<<21&4294967295|d>>>11),d=m+(h^(y|~S))+v[4]+4149444226&4294967295,m=y+(d<<6&4294967295|d>>>26),d=S+(y^(m|~h))+v[11]+3174756917&4294967295,S=m+(d<<10&4294967295|d>>>22),d=h+(m^(S|~y))+v[2]+718787259&4294967295,h=S+(d<<15&4294967295|d>>>17),d=y+(S^(h|~m))+v[9]+3951481745&4294967295,_.g[0]=_.g[0]+m&4294967295,_.g[1]=_.g[1]+(h+(d<<21&4294967295|d>>>11))&4294967295,_.g[2]=_.g[2]+h&4294967295,_.g[3]=_.g[3]+S&4294967295}r.prototype.u=function(_,m){m===void 0&&(m=_.length);for(var y=m-this.blockSize,v=this.B,h=this.h,S=0;S<m;){if(h==0)for(;S<=y;)i(this,_,S),S+=this.blockSize;if(typeof _=="string"){for(;S<m;)if(v[h++]=_.charCodeAt(S++),h==this.blockSize){i(this,v),h=0;break}}else for(;S<m;)if(v[h++]=_[S++],h==this.blockSize){i(this,v),h=0;break}}this.h=h,this.o+=m},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var m=1;m<_.length-8;++m)_[m]=0;var y=8*this.o;for(m=_.length-8;m<_.length;++m)_[m]=y&255,y/=256;for(this.u(_),_=Array(16),m=y=0;4>m;++m)for(var v=0;32>v;v+=8)_[y++]=this.g[m]>>>v&255;return _};function s(_,m){var y=a;return Object.prototype.hasOwnProperty.call(y,_)?y[_]:y[_]=m(_)}function o(_,m){this.h=m;for(var y=[],v=!0,h=_.length-1;0<=h;h--){var S=_[h]|0;v&&S==m||(y[h]=S,v=!1)}this.g=y}var a={};function l(_){return-128<=_&&128>_?s(_,function(m){return new o([m|0],0>m?-1:0)}):new o([_|0],0>_?-1:0)}function c(_){if(isNaN(_)||!isFinite(_))return p;if(0>_)return T(c(-_));for(var m=[],y=1,v=0;_>=y;v++)m[v]=_/y|0,y*=4294967296;return new o(m,0)}function u(_,m){if(_.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(_.charAt(0)=="-")return T(u(_.substring(1),m));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=c(Math.pow(m,8)),v=p,h=0;h<_.length;h+=8){var S=Math.min(8,_.length-h),d=parseInt(_.substring(h,h+S),m);8>S?(S=c(Math.pow(m,S)),v=v.j(S).add(c(d))):(v=v.j(y),v=v.add(c(d)))}return v}var p=l(0),g=l(1),C=l(16777216);n=o.prototype,n.m=function(){if(I(this))return-T(this).m();for(var _=0,m=1,y=0;y<this.g.length;y++){var v=this.i(y);_+=(0<=v?v:4294967296+v)*m,m*=4294967296}return _},n.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(A(this))return"0";if(I(this))return"-"+T(this).toString(_);for(var m=c(Math.pow(_,6)),y=this,v="";;){var h=F(y,m).g;y=P(y,h.j(m));var S=((0<y.g.length?y.g[0]:y.h)>>>0).toString(_);if(y=h,A(y))return S+v;for(;6>S.length;)S="0"+S;v=S+v}},n.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function A(_){if(_.h!=0)return!1;for(var m=0;m<_.g.length;m++)if(_.g[m]!=0)return!1;return!0}function I(_){return _.h==-1}n.l=function(_){return _=P(this,_),I(_)?-1:A(_)?0:1};function T(_){for(var m=_.g.length,y=[],v=0;v<m;v++)y[v]=~_.g[v];return new o(y,~_.h).add(g)}n.abs=function(){return I(this)?T(this):this},n.add=function(_){for(var m=Math.max(this.g.length,_.g.length),y=[],v=0,h=0;h<=m;h++){var S=v+(this.i(h)&65535)+(_.i(h)&65535),d=(S>>>16)+(this.i(h)>>>16)+(_.i(h)>>>16);v=d>>>16,S&=65535,d&=65535,y[h]=d<<16|S}return new o(y,y[y.length-1]&-2147483648?-1:0)};function P(_,m){return _.add(T(m))}n.j=function(_){if(A(this)||A(_))return p;if(I(this))return I(_)?T(this).j(T(_)):T(T(this).j(_));if(I(_))return T(this.j(T(_)));if(0>this.l(C)&&0>_.l(C))return c(this.m()*_.m());for(var m=this.g.length+_.g.length,y=[],v=0;v<2*m;v++)y[v]=0;for(v=0;v<this.g.length;v++)for(var h=0;h<_.g.length;h++){var S=this.i(v)>>>16,d=this.i(v)&65535,f=_.i(h)>>>16,U=_.i(h)&65535;y[2*v+2*h]+=d*U,x(y,2*v+2*h),y[2*v+2*h+1]+=S*U,x(y,2*v+2*h+1),y[2*v+2*h+1]+=d*f,x(y,2*v+2*h+1),y[2*v+2*h+2]+=S*f,x(y,2*v+2*h+2)}for(v=0;v<m;v++)y[v]=y[2*v+1]<<16|y[2*v];for(v=m;v<2*m;v++)y[v]=0;return new o(y,0)};function x(_,m){for(;(_[m]&65535)!=_[m];)_[m+1]+=_[m]>>>16,_[m]&=65535,m++}function N(_,m){this.g=_,this.h=m}function F(_,m){if(A(m))throw Error("division by zero");if(A(_))return new N(p,p);if(I(_))return m=F(T(_),m),new N(T(m.g),T(m.h));if(I(m))return m=F(_,T(m)),new N(T(m.g),m.h);if(30<_.g.length){if(I(_)||I(m))throw Error("slowDivide_ only works with positive integers.");for(var y=g,v=m;0>=v.l(_);)y=$(y),v=$(v);var h=X(y,1),S=X(v,1);for(v=X(v,2),y=X(y,2);!A(v);){var d=S.add(v);0>=d.l(_)&&(h=h.add(y),S=d),v=X(v,1),y=X(y,1)}return m=P(_,h.j(m)),new N(h,m)}for(h=p;0<=_.l(m);){for(y=Math.max(1,Math.floor(_.m()/m.m())),v=Math.ceil(Math.log(y)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),S=c(y),d=S.j(m);I(d)||0<d.l(_);)y-=v,S=c(y),d=S.j(m);A(S)&&(S=g),h=h.add(S),_=P(_,d)}return new N(h,_)}n.A=function(_){return F(this,_).h},n.and=function(_){for(var m=Math.max(this.g.length,_.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)&_.i(v);return new o(y,this.h&_.h)},n.or=function(_){for(var m=Math.max(this.g.length,_.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)|_.i(v);return new o(y,this.h|_.h)},n.xor=function(_){for(var m=Math.max(this.g.length,_.g.length),y=[],v=0;v<m;v++)y[v]=this.i(v)^_.i(v);return new o(y,this.h^_.h)};function $(_){for(var m=_.g.length+1,y=[],v=0;v<m;v++)y[v]=_.i(v)<<1|_.i(v-1)>>>31;return new o(y,_.h)}function X(_,m){var y=m>>5;m%=32;for(var v=_.g.length-y,h=[],S=0;S<v;S++)h[S]=0<m?_.i(S+y)>>>m|_.i(S+y+1)<<32-m:_.i(S+y);return new o(h,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wd=f0.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Cr=f0.Integer=o}).apply(typeof h0<"u"?h0:typeof self<"u"?self:typeof window<"u"?window:{});var Ti=od(Bb(),1),TE=od(zf(),1);var Ub="@firebase/firestore",qb="4.7.3";var dt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};dt.UNAUTHENTICATED=new dt(null);dt.GOOGLE_CREDENTIALS=new dt("google-credentials-uid");dt.FIRST_PARTY=new dt("first-party-uid");dt.MOCK_USER=new dt("mock-user");var tN="10.14.0";var eo=tN;function nN(n){eo=n}function rN(n){return JP(n,{depth:100})}var Ai=new Wa("@firebase/firestore");function ua(){return Ai.logLevel}function H(n,...e){if(Ai.logLevel<=Kn.DEBUG){let t=e.map(Xg);Ai.debug(`Firestore (${eo}): ${n}`,...t)}}function fn(n,...e){if(Ai.logLevel<=Kn.ERROR){let t=e.map(Xg);Ai.error(`Firestore (${eo}): ${n}`,...t)}}function ha(n,...e){if(Ai.logLevel<=Kn.WARN){let t=e.map(Xg);Ai.warn(`Firestore (${eo}): ${n}`,...t)}}function Xg(n){if(typeof n=="string")return n;try{return rN(n)}catch{return n}}function J(n="Unexpected state"){let e=`FIRESTORE (${eo}) INTERNAL ASSERTION FAILED: `+n;throw fn(e),new Error(e)}function ge(n,e){n||J()}function ee(n,e){return n}var k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},G=class extends cv{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var zn=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var _m=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Cm=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(dt.UNAUTHENTICATED))}shutdown(){}};var Sm=class{constructor(e){this.authProvider=e,this.currentUser=dt.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){ge(this.tokenListener===void 0);let r=this.tokenCounter,i=l=>this.tokenCounter!==r?(r=this.tokenCounter,t(l)):Promise.resolve(),s=new zn;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new zn,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>R(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),o())};this.authProvider.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.authProvider.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zn)}},0),o()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.tokenCounter!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ge(typeof r.accessToken=="string"),new _m(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return ge(e===null||typeof e=="string"),new dt(e)}},bm=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=dt.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},Em=class{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new bm(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(dt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},wm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Tm=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,t){ge(this.tokenListener===void 0);let r=s=>{s.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?i(s):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ge(typeof t.token=="string"),this.latestAppCheckToken=t.token,new wm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}};function iN(n){if(!n)return new Cm;switch(n.type){case"firstParty":return new Em(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new G(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function sN(n){return eN(n)}var gu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let s=sN(40);for(let o=0;o<s.length;++o)r.length<i&&s[o]<t&&(r+=e.charAt(s[o]%e.length))}return r}};function de(n,e){return n<e?-1:n>e?1:0}function Ii(n,e,t){return n.length!==e.length?!1:n.every((r,i)=>t(r,e[i]))}var zb=-62135596800,jb=1e6,rt=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new G(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new G(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zb)throw new G(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-t*1e3)*jb);return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return this.seconds*1e3+this.nanoseconds/jb}_compareTo(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-zb,t=String(e).padStart(12,"0"),r=String(this.nanoseconds).padStart(9,"0");return t+"."+r}};var te=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new rt(0,0))}static max(){return new n(new rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return this.timestamp.seconds*1e6+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Gb="__name__",yu=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&J(),r===void 0?r=e.length-t:r>e.length-t&&J(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Me=class n extends yu{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new G(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},oN=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ft=class n extends yu{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return oN.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Gb}static keyField(){return new n([Gb])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new G(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new G(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(!(l==="\\"||l==="."||l==="`"))throw new G(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a==="."&&!o?(s(),i++):(r+=a,i++)}if(s(),o)throw new G(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var Y=class n{constructor(e){this.path=e}static fromPath(e){return new n(Me.fromString(e))}static fromName(e){return new n(Me.fromString(e).popFirst(5))}static empty(){return new n(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new n(new Me(e.slice()))}};var ya=-1;function aN(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new rt(t+1,0):new rt(t,r));return new Di(i,Y.empty(),e)}function lN(n){return new Di(n.readTime,n.key,ya)}var Di=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(te.min(),Y.empty(),ya)}static max(){return new n(te.max(),Y.empty(),ya)}};function cN(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0||(t=Y.comparator(n.documentKey,e.documentKey),t!==0)?t:de(n.largestBatchId,e.largestBatchId)}var uN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Am=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Pa(n){return R(this,null,function*(){if(n.code===k.FAILED_PRECONDITION&&n.message===uN)H("LocalStore","Unexpectedly lost primary lease");else throw n})}var L=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&J(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let l=0;l<s;l++){let c=l;t(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function dN(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Na(n){return n.name==="IndexedDbTransactionError"}var d6=15*1e3,h6=60*1e3;var AE=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.setPreviousValue(i),this.writeNewSequenceNumber=i=>r.writeSequenceNumber(i))}setPreviousValue(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t}}n.INVALID=-1;return n})();var hN="remoteDocuments";var IE="owner";var DE="mutationQueues";var xE="mutations";var RE="documentMutations",fN="remoteDocumentsV14";var kE="remoteDocumentGlobal";var OE="targets";var ME="targetDocuments";var PE="targetGlobal",NE="collectionParents";var FE="clientMetadata";var LE="bundles";var VE="namedQueries";var pN="indexConfiguration";var mN="indexState";var gN="indexEntries";var BE="documentOverlays";var yN="globals";var vN=[DE,xE,RE,hN,OE,IE,PE,ME],_N=vN,CN=[..._N,FE],SN=[...CN,kE],bN=[...SN,NE],EN=[...bN,LE,VE],f6=[...EN,BE],wN=[DE,xE,RE,fN,OE,IE,PE,ME,FE,kE,NE,LE,VE,BE],TN=wN,AN=[...TN,pN,mN,gN];var p6=[...AN,yN];function $b(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function to(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function UE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Le=class n{constructor(e,t){this.comparator=e,this.root=t||fa.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,fa.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bs(this.root,e,this.comparator,!0)}},Bs=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fa=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return!t.left.isRed()&&!t.left.left.isRed()&&(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,s=this;if(r(t,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return n.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw J();let t=this.left.check();if(t!==this.right.check())throw J();return t+(this.isRed()?0:1)}}return n.EMPTY=null,n.RED=!0,n.BLACK=!1,n})(),Im=class{constructor(){this.size=0}get key(){throw J()}get value(){throw J()}get color(){throw J()}get left(){throw J()}get right(){throw J()}copy(e,t,r,i,s){return this}insert(e,t,r){return new fa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};fa.EMPTY=new Im;var ut=class n{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(t!==void 0?r=this.data.getIteratorFrom(t):r=this.data.getIterator();r.hasNext();){let i=r.getNext();if(!e(i.key))return}}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vu(this.data.getIterator())}getIteratorFrom(e){return new vu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},vu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Un=class n{constructor(e){this.fields=e,e.sort(Ft.comparator)}static empty(){return new n([])}unionWith(e){let t=new ut(Ft.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ii(this.fields,e.fields,(t,r)=>t.isEqual(r))}};function IN(n){return Buffer.from(n,"base64").toString("binary")}function DN(n){return Buffer.from(n,"binary").toString("base64")}var ht=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=IN(e);return new n(t)}static fromUint8Array(e){let t=xN(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return DN(this.binaryString)}toUint8Array(){return RN(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return de(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ht.EMPTY_BYTE_STRING=new ht("");function xN(n){let e="";for(let t=0;t<n.length;++t)e+=String.fromCharCode(n[t]);return e}function RN(n){let e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}var kN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function or(n){if(ge(!!n),typeof n=="string"){let e=0,t=kN.exec(n);if(ge(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}else{let e=Re(n.seconds),t=Re(n.nanos);return{seconds:e,nanos:t}}}function Re(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yr(n){return typeof n=="string"?ht.fromBase64String(n):ht.fromUint8Array(n)}var qE="server_timestamp",zE="__type__",jE="__previous_value__",GE="__local_write_time__";function Jg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[zE])===null||t===void 0?void 0:t.stringValue)===qE}function ON(n,e){let t={fields:{[zE]:{stringValue:qE},[GE]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return e&&Jg(e)&&(e=Zg(e)),e&&(t.fields[jE]=e),{mapValue:t}}function Zg(n){let e=n.mapValue.fields[jE];return Jg(e)?Zg(e):e}function va(n){let e=or(n.mapValue.fields[GE].timestampValue);return new rt(e.seconds,e.nanos)}var Dm=class{constructor(e,t,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},Wb="(default)",_u=class n{constructor(e,t){this.projectId=e,this.database=t||Wb}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Wb}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function MN(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new G(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _u(n.options.projectId,e)}var ey=-1;function ju(n){return n==null}function _a(n){return n===0&&1/n===-1/0}function PN(n){return typeof n=="number"&&Number.isInteger(n)&&!_a(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var ty="__type__",$E="__max__",hu={mapValue:{fields:{__type__:{stringValue:$E}}}},ny="__vector__",zs="value";function xi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Jg(n)?4:KE(n)?9007199254740991:HE(n)?10:11:J()}function hn(n,e){if(n===e)return!0;let t=xi(n),r=xi(e);if(t!==r)return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return va(n).isEqual(va(e));case 3:return NN(n,e);case 5:return n.stringValue===e.stringValue;case 6:return LN(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return FN(n,e);case 2:return VN(n,e);case 9:return Ii(n.arrayValue.values||[],e.arrayValue.values||[],hn);case 10:case 11:return BN(n,e);case 9007199254740991:return!0;default:return J()}}function NN(n,e){if(typeof n.timestampValue=="string"&&typeof e.timestampValue=="string"&&n.timestampValue.length===e.timestampValue.length)return n.timestampValue===e.timestampValue;let t=or(n.timestampValue),r=or(e.timestampValue);return t.seconds===r.seconds&&t.nanos===r.nanos}function FN(n,e){return Re(n.geoPointValue.latitude)===Re(e.geoPointValue.latitude)&&Re(n.geoPointValue.longitude)===Re(e.geoPointValue.longitude)}function LN(n,e){return Yr(n.bytesValue).isEqual(Yr(e.bytesValue))}function VN(n,e){if("integerValue"in n&&"integerValue"in e)return Re(n.integerValue)===Re(e.integerValue);if("doubleValue"in n&&"doubleValue"in e){let t=Re(n.doubleValue),r=Re(e.doubleValue);return t===r?_a(t)===_a(r):isNaN(t)&&isNaN(r)}return!1}function BN(n,e){let t=n.mapValue.fields||{},r=e.mapValue.fields||{};if($b(t)!==$b(r))return!1;for(let i in t)if(t.hasOwnProperty(i)&&(r[i]===void 0||!hn(t[i],r[i])))return!1;return!0}function Ca(n,e){return(n.values||[]).find(t=>hn(t,e))!==void 0}function js(n,e){if(n===e)return 0;let t=xi(n),r=xi(e);if(t!==r)return de(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return de(n.booleanValue,e.booleanValue);case 2:return UN(n,e);case 3:return Hb(n.timestampValue,e.timestampValue);case 4:return Hb(va(n),va(e));case 5:return de(n.stringValue,e.stringValue);case 6:return jN(n.bytesValue,e.bytesValue);case 7:return qN(n.referenceValue,e.referenceValue);case 8:return zN(n.geoPointValue,e.geoPointValue);case 9:return WE(n.arrayValue,e.arrayValue);case 10:return GN(n.mapValue,e.mapValue);case 11:return $N(n.mapValue,e.mapValue);default:throw J()}}function UN(n,e){let t=Re(n.integerValue||n.doubleValue),r=Re(e.integerValue||e.doubleValue);return t<r?-1:t>r?1:t===r?0:isNaN(t)?isNaN(r)?0:-1:1}function Hb(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return de(n,e);let t=or(n),r=or(e),i=de(t.seconds,r.seconds);return i!==0?i:de(t.nanos,r.nanos)}function qN(n,e){let t=n.split("/"),r=e.split("/");for(let i=0;i<t.length&&i<r.length;i++){let s=de(t[i],r[i]);if(s!==0)return s}return de(t.length,r.length)}function zN(n,e){let t=de(Re(n.latitude),Re(e.latitude));return t!==0?t:de(Re(n.longitude),Re(e.longitude))}function jN(n,e){let t=Yr(n),r=Yr(e);return t.compareTo(r)}function WE(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=js(t[i],r[i]);if(s)return s}return de(t.length,r.length)}function GN(n,e){var t,r,i,s;let o=n.fields||{},a=e.fields||{},l=(t=o[zs])===null||t===void 0?void 0:t.arrayValue,c=(r=a[zs])===null||r===void 0?void 0:r.arrayValue,u=de(((i=l?.values)===null||i===void 0?void 0:i.length)||0,((s=c?.values)===null||s===void 0?void 0:s.length)||0);return u!==0?u:WE(l,c)}function $N(n,e){if(n===hu.mapValue&&e===hu.mapValue)return 0;if(n===hu.mapValue)return 1;if(e===hu.mapValue)return-1;let t=n.fields||{},r=Object.keys(t),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){let a=de(r[o],s[o]);if(a!==0)return a;let l=js(t[r[o]],i[s[o]]);if(l!==0)return l}return de(r.length,s.length)}function Gs(n){return ry(n)}function ry(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?HN(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?WN(n.bytesValue):"referenceValue"in n?QN(n.referenceValue):"geoPointValue"in n?KN(n.geoPointValue):"arrayValue"in n?XN(n.arrayValue):"mapValue"in n?YN(n.mapValue):J()}function WN(n){return Yr(n).toBase64()}function HN(n){let e=or(n);return`time(${e.seconds},${e.nanos})`}function KN(n){return`geo(${n.latitude},${n.longitude})`}function QN(n){return Y.fromName(n).toString()}function YN(n){let e=Object.keys(n.fields||{}).sort(),t="{",r=!0;for(let i of e)r?r=!1:t+=",",t+=`${i}:${ry(n.fields[i])}`;return t+"}"}function XN(n){let e="[",t=!0;for(let r of n.values||[])t?t=!1:e+=",",e+=ry(r);return e+"]"}function Kb(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function xm(n){return!!n&&"integerValue"in n}function JN(n){return!!n&&"doubleValue"in n}function ZN(n){return xm(n)||JN(n)}function iy(n){return!!n&&"arrayValue"in n}function Qb(n){return!!n&&"nullValue"in n}function Yb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function pu(n){return!!n&&"mapValue"in n}function HE(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[ty])===null||t===void 0?void 0:t.stringValue)===ny}function pa(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return to(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=pa(r)),e}else if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pa(n.arrayValue.values[t]);return e}else return Object.assign({},n)}function KE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===$E}var m6={mapValue:{fields:{[ty]:{stringValue:ny},[zs]:{arrayValue:{}}}}};var dn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!pu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){let r=this.getFieldsMap(e.popLast());r[e.lastSegment()]=pa(t)}setAll(e){let t=Ft.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=pa(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());pu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];(!pu(i)||!i.mapValue.fields)&&(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){to(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(pa(this.value))}};function QE(n){let e=[];return to(n.fields,(t,r)=>{let i=new Ft([t]);if(pu(r)){let o=QE(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Un(e)}var pn=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,te.min(),te.min(),te.min(),dn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,te.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,te.min(),te.min(),dn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,te.min(),te.min(),dn.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(te.min())&&(this.documentType===2||this.documentType===0)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};function eF(n,e,t){let r=e.data.field(n),i=t.data.field(n);return r!==null&&i!==null?js(r,i):J()}var $s=class{constructor(e,t){this.position=e,this.inclusive=t}};function YE(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField())r=Y.comparator(Y.fromName(o.referenceValue),t.key);else{let a=t.data.field(s.field);r=js(o,a)}if(s.dir==="desc"&&(r=r*-1),r!==0)break}return r}function tF(n,e,t){let r=YE(n,e,t);return n.inclusive?r>=0:r>0}function nF(n,e,t){let r=YE(n,e,t);return n.inclusive?r<=0:r<0}function Xb(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++){let r=n.position[t],i=e.position[t];if(!hn(r,i))return!1}return!0}var Ws=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function rF(n){return n.field.canonicalString()+n.dir}function iF(n){return`${n.field.canonicalString()} (${n.dir})`}function sF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Cu=class{},$e=class n extends Cu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new km(e,t,r):t==="array-contains"?new Pm(e,r):t==="in"?new Nm(e,r):t==="not-in"?new Fm(e,r):t==="array-contains-any"?new Lm(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Om(e,r):new Mm(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(js(t,this.value)):t!==null&&xi(this.value)===xi(t)&&this.matchesComparison(js(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return J()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},mn=class n extends Cu{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new n(e,t)}matches(e){return XE(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.memoizedFlattenedFilters!==null?this.memoizedFlattenedFilters:(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[]),this.memoizedFlattenedFilters)}getFilters(){return Object.assign([],this.filters)}};function XE(n){return n.op==="and"}function JE(n){return oF(n)&&XE(n)}function oF(n){for(let e of n.filters)if(e instanceof mn)return!1;return!0}function Rm(n){if(n instanceof $e)return n.field.canonicalString()+n.op.toString()+Gs(n.value);if(JE(n))return n.filters.map(e=>Rm(e)).join(",");{let e=n.filters.map(t=>Rm(t)).join(",");return`${n.op}(${e})`}}function ZE(n,e){if(n instanceof $e)return aF(n,e);if(n instanceof mn)return lF(n,e);J()}function aF(n,e){return e instanceof $e&&n.op===e.op&&n.field.isEqual(e.field)&&hn(n.value,e.value)}function lF(n,e){return e instanceof mn&&n.op===e.op&&n.filters.length===e.filters.length?n.filters.reduce((r,i,s)=>r&&ZE(i,e.filters[s]),!0):!1}function ew(n){return n instanceof $e?uF(n):n instanceof mn?cF(n):"Filter"}function cF(n){return n.op.toString()+" {"+n.getFilters().map(ew).join(" ,")+"}"}function uF(n){return`${n.field.canonicalString()} ${n.op} ${Gs(n.value)}`}var km=class extends $e{constructor(e,t,r){super(e,t,r),this.key=Y.fromName(r.referenceValue)}matches(e){let t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}},Om=class extends $e{constructor(e,t){super(e,"in",t),this.keys=tw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Mm=class extends $e{constructor(e,t){super(e,"not-in",t),this.keys=tw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function tw(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Y.fromName(r.referenceValue))}var Pm=class extends $e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return iy(t)&&Ca(t.arrayValue,this.value)}},Nm=class extends $e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ca(this.value.arrayValue,t)}},Fm=class extends $e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ca(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ca(this.value.arrayValue,t)}},Lm=class extends $e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!iy(t)||!t.arrayValue.values?!1:t.arrayValue.values.some(r=>Ca(this.value.arrayValue,r))}};var Vm=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.memoizedCanonicalId=null}};function Jb(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Vm(n,e,t,r,i,s,o)}function sy(n){let e=ee(n);if(e.memoizedCanonicalId===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Rm(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>rF(r)).join(","),ju(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gs(r)).join(",")),e.memoizedCanonicalId=t}return e.memoizedCanonicalId}function dF(n){let e=n.path.canonicalString();return n.collectionGroup!==null&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>ew(t)).join(", ")}]`),ju(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>iF(t)).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>Gs(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>Gs(t)).join(",")),`Target(${e})`}function oy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ZE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup!==e.collectionGroup||!n.path.isEqual(e.path)||!Xb(n.startAt,e.startAt)?!1:Xb(n.endAt,e.endAt)}function Bm(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ri=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}};function hF(n,e,t,r,i,s,o,a){return new Ri(n,e,t,r,i,s,o,a)}function ay(n){return new Ri(n)}function fF(n,e){return new Ri(e,null,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Zb(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pF(n){let e=new ut(Ft.comparator);return n.filters.forEach(t=>{t.getFlattenedFilters().forEach(i=>{i.isInequality()&&(e=e.add(i.field))})}),e}function mF(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function nw(n){return n.collectionGroup!==null}function Sa(n){let e=ee(n);if(e.memoizedNormalizedOrderBy===null){e.memoizedNormalizedOrderBy=[];let t=new Set;for(let s of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";pF(e).forEach(s=>{!t.has(s.canonicalString())&&!s.isKeyField()&&e.memoizedNormalizedOrderBy.push(new Ws(s,r))}),t.has(Ft.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new Ws(Ft.keyField(),r))}return e.memoizedNormalizedOrderBy}function jn(n){let e=ee(n);return e.memoizedTarget||(e.memoizedTarget=gF(e,Sa(n))),e.memoizedTarget}function gF(n,e){if(n.limitType==="F")return Jb(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ws(i.field,s)});let t=n.endAt?new $s(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new $s(n.startAt.position,n.startAt.inclusive):null;return Jb(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ly(n,e){let t=n.filters.concat([e]);return new Ri(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Um(n,e,t){return new Ri(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Gu(n,e){return oy(jn(n),jn(e))&&n.limitType===e.limitType}function rw(n){return`${sy(jn(n))}|lt:${n.limitType}`}function Ls(n){return`Query(target=${dF(jn(n))}; limitType=${n.limitType})`}function $u(n,e){return e.isFoundDocument()&&yF(n,e)&&vF(n,e)&&_F(n,e)&&CF(n,e)}function yF(n,e){let t=e.key.path;return n.collectionGroup!==null?e.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(t):Y.isDocumentKey(n.path)?n.path.isEqual(t):n.path.isImmediateParentOf(t)}function vF(n,e){for(let t of Sa(n))if(!t.field.isKeyField()&&e.data.field(t.field)===null)return!1;return!0}function _F(n,e){for(let t of n.filters)if(!t.matches(e))return!1;return!0}function CF(n,e){return!(n.startAt&&!nF(n.startAt,Sa(n),e)||n.endAt&&!tF(n.endAt,Sa(n),e))}function SF(n){return n.collectionGroup||(n.path.length%2===1?n.path.lastSegment():n.path.get(n.path.length-2))}function iw(n){return(e,t)=>{let r=!1;for(let i of Sa(n)){let s=bF(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function bF(n,e,t){let r=n.field.isKeyField()?Y.comparator(e.key,t.key):eF(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return J()}}var Xr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0){this.inner[r]=[[e,t]],this.innerSize++;return}for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e)){i[s]=[e,t];return}i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){to(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return UE(this.inner)}size(){return this.innerSize}};var EF=new Le(Y.comparator);function ar(){return EF}var sw=new Le(Y.comparator);function da(...n){let e=sw;for(let t of n)e=e.insert(t.key,t);return e}function wF(){return ba()}function ow(n){let e=sw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ei(){return ba()}function aw(){return ba()}function ba(){return new Xr(n=>n.toString(),(n,e)=>n.isEqual(e))}var TF=new Le(Y.comparator);function AF(){return TF}var IF=new ut(Y.comparator);function se(...n){let e=IF;for(let t of n)e=e.add(t);return e}var DF=new ut(de);function xF(){return DF}function cy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_a(e)?"-0":e}}function lw(n){return{integerValue:""+n}}function RF(n,e){return PN(e)?lw(e):cy(n,e)}var Hs=class{constructor(){this._=void 0}};function kF(n,e,t){return n instanceof Ks?ON(t,e):n instanceof ki?uw(n,e):n instanceof Oi?dw(n,e):PF(n,e)}function OF(n,e,t){return n instanceof ki?uw(n,e):n instanceof Oi?dw(n,e):t}function cw(n,e){return n instanceof Qs?ZN(e)?e:{integerValue:0}:null}function MF(n,e){return n instanceof ki&&e instanceof ki||n instanceof Oi&&e instanceof Oi?Ii(n.elements,e.elements,hn):n instanceof Qs&&e instanceof Qs?hn(n.operand,e.operand):n instanceof Ks&&e instanceof Ks}var Ks=class extends Hs{},ki=class extends Hs{constructor(e){super(),this.elements=e}};function uw(n,e){let t=hw(e);for(let r of n.elements)t.some(i=>hn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Oi=class extends Hs{constructor(e){super(),this.elements=e}};function dw(n,e){let t=hw(e);for(let r of n.elements)t=t.filter(i=>!hn(i,r));return{arrayValue:{values:t}}}var Qs=class extends Hs{constructor(e,t){super(),this.serializer=e,this.operand=t}};function PF(n,e){let t=cw(n,e),r=eE(t)+eE(n.operand);return xm(t)&&xm(n.operand)?lw(r):cy(n.serializer,r)}function eE(n){return Re(n.integerValue||n.doubleValue)}function hw(n){return iy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function NF(n,e){return n.field.isEqual(e.field)&&MF(n.transform,e.transform)}function FF(n,e){return n===void 0&&e===void 0?!0:n&&e?Ii(n,e,(t,r)=>NF(t,r)):!1}var qm=class{constructor(e,t){this.version=e,this.transformResults=t}},Kr=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Wu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists!==void 0?n.exists===e.isFoundDocument():!0}var Ys=class{};function fw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ea(n.key,Kr.none()):new Mi(n.key,n.data,Kr.none());{let t=n.data,r=dn.empty(),i=new ut(Ft.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new lr(n.key,r,new Un(i.toArray()),Kr.none())}}function LF(n,e,t){n instanceof Mi?BF(n,e,t):n instanceof lr?qF(n,e,t):jF(n,e,t)}function ma(n,e,t,r){return n instanceof Mi?UF(n,e,t,r):n instanceof lr?zF(n,e,t,r):GF(n,e,t)}function VF(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=cw(r.transform,i||null);s!=null&&(t===null&&(t=dn.empty()),t.set(r.field,s))}return t||null}function tE(n,e){return n.type!==e.type||!n.key.isEqual(e.key)||!n.precondition.isEqual(e.precondition)||!FF(n.fieldTransforms,e.fieldTransforms)?!1:n.type===0?n.value.isEqual(e.value):n.type===1?n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask):!0}var Mi=class extends Ys{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}};function BF(n,e,t){let r=n.value.clone(),i=mw(n.fieldTransforms,e,t.transformResults);r.setAll(i),e.convertToFoundDocument(t.version,r).setHasCommittedMutations()}function UF(n,e,t,r){if(!Wu(n.precondition,e))return t;let i=n.value.clone(),s=gw(n.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}var lr=class extends Ys{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function qF(n,e,t){if(!Wu(n.precondition,e)){e.convertToUnknownDocument(t.version);return}let r=mw(n.fieldTransforms,e,t.transformResults),i=e.data;i.setAll(pw(n)),i.setAll(r),e.convertToFoundDocument(t.version,i).setHasCommittedMutations()}function zF(n,e,t,r){if(!Wu(n.precondition,e))return t;let i=gw(n.fieldTransforms,r,e),s=e.data;return s.setAll(pw(n)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),t===null?null:t.unionWith(n.fieldMask.fields).unionWith(n.fieldTransforms.map(o=>o.field))}function pw(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function mw(n,e,t){let r=new Map;ge(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,OF(o,a,t[i]))}return r}function gw(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,kF(s,o,e))}return r}var Ea=class extends Ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};function jF(n,e,t){e.convertToNoDocument(t.version).setHasCommittedMutations()}function GF(n,e,t){return Wu(n.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):t}var zm=class extends Ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var jm=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];if(s.key.isEqual(e.key)){let o=r[i];LF(s,e,o)}}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ma(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ma(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=aw();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let l=fw(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),se())}isEqual(e){return this.batchId===e.batchId&&Ii(this.mutations,e.mutations,(t,r)=>tE(t,r))&&Ii(this.baseMutations,e.baseMutations,(t,r)=>tE(t,r))}},Gm=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ge(e.mutations.length===r.length);let i=AF(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var $m=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Wm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var et=function(n){return n[n.OK=0]="OK",n[n.CANCELLED=1]="CANCELLED",n[n.UNKNOWN=2]="UNKNOWN",n[n.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",n[n.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",n[n.NOT_FOUND=5]="NOT_FOUND",n[n.ALREADY_EXISTS=6]="ALREADY_EXISTS",n[n.PERMISSION_DENIED=7]="PERMISSION_DENIED",n[n.UNAUTHENTICATED=16]="UNAUTHENTICATED",n[n.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",n[n.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",n[n.ABORTED=10]="ABORTED",n[n.OUT_OF_RANGE=11]="OUT_OF_RANGE",n[n.UNIMPLEMENTED=12]="UNIMPLEMENTED",n[n.INTERNAL=13]="INTERNAL",n[n.UNAVAILABLE=14]="UNAVAILABLE",n[n.DATA_LOSS=15]="DATA_LOSS",n}(et||{});function $F(n){switch(n){case k.OK:return J();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0;default:return J()}}function WF(n){return $F(n)&&n!==k.ABORTED}function mu(n){if(n===void 0)return fn("GRPC error has no .code"),k.UNKNOWN;switch(n){case et.OK:return k.OK;case et.CANCELLED:return k.CANCELLED;case et.UNKNOWN:return k.UNKNOWN;case et.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case et.INTERNAL:return k.INTERNAL;case et.UNAVAILABLE:return k.UNAVAILABLE;case et.UNAUTHENTICATED:return k.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case et.NOT_FOUND:return k.NOT_FOUND;case et.ALREADY_EXISTS:return k.ALREADY_EXISTS;case et.PERMISSION_DENIED:return k.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case et.ABORTED:return k.ABORTED;case et.OUT_OF_RANGE:return k.OUT_OF_RANGE;case et.UNIMPLEMENTED:return k.UNIMPLEMENTED;case et.DATA_LOSS:return k.DATA_LOSS;default:return J()}}var Hm=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var hm=null;function HF(){return new ZP}var KF=new Cr([4294967295,4294967295],0);function nE(n){let e=HF().encode(n),t=new Wd;return t.update(e),new Uint8Array(t.digest())}function rE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0),o=new Cr([t,r],0),a=new Cr([i,s],0);return[o,a]}var Km=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new wi(`Invalid padding: ${t}`);if(r<0)throw new wi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new wi(`Invalid padding when bitmap length is 0: ${t}`);this.bitCount=e.length*8-t,this.bitCountInInteger=Cr.fromNumber(this.bitCount)}getBitIndex(e,t,r){let i=e.add(t.multiply(Cr.fromNumber(r)));return i.compare(KF)===1&&(i=new Cr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.bitCountInInteger).toNumber()}isBitSet(e){let t=this.bitmap[Math.floor(e/8)],r=e%8;return(t&1<<r)!==0}mightContain(e){if(this.bitCount===0)return!1;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);if(!this.isBitSet(o))return!1}return!0}static create(e,t,r){let i=e%8===0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.bitCount===0)return;let t=nE(e),[r,i]=rE(t);for(let s=0;s<this.hashCount;s++){let o=this.getBitIndex(r,i,s);this.setBit(o)}}setBit(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},wi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Su=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,wa.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(te.min(),i,new Le(de),ar(),se())}},wa=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,se(),se(),se())}};var qs=class{constructor(e,t,r,i){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=r,this.newDoc=i}},bu=class{constructor(e,t){this.targetId=e,this.existenceFilter=t}},Eu=class{constructor(e,t,r=ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},wu=class{constructor(){this.pendingResponses=0,this.documentChanges=sE(),this._resumeToken=ht.EMPTY_BYTE_STRING,this._current=!1,this._hasPendingChanges=!0}get current(){return this._current}get resumeToken(){return this._resumeToken}get isPending(){return this.pendingResponses!==0}get hasPendingChanges(){return this._hasPendingChanges}updateResumeToken(e){e.approximateByteSize()>0&&(this._hasPendingChanges=!0,this._resumeToken=e)}toTargetChange(){let e=se(),t=se(),r=se();return this.documentChanges.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:J()}}),new wa(this._resumeToken,this._current,e,t,r)}clearPendingChanges(){this._hasPendingChanges=!1,this.documentChanges=sE()}addDocumentChange(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)}removeDocumentChange(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)}recordPendingTargetRequest(){this.pendingResponses+=1}recordTargetResponse(){this.pendingResponses-=1,ge(this.pendingResponses>=0)}markCurrent(){this._hasPendingChanges=!0,this._current=!0}},QF="WatchChangeAggregator",Qm=class{constructor(e){this.metadataProvider=e,this.targetStates=new Map,this.pendingDocumentUpdates=ar(),this.pendingDocumentTargetMapping=iE(),this.pendingTargetResets=new Le(de)}handleDocumentChange(e){for(let t of e.updatedTargetIds)e.newDoc&&e.newDoc.isFoundDocument()?this.addDocumentToTarget(t,e.newDoc):this.removeDocumentFromTarget(t,e.key,e.newDoc);for(let t of e.removedTargetIds)this.removeDocumentFromTarget(t,e.key,e.newDoc)}handleTargetChange(e){this.forEachTarget(e,t=>{let r=this.ensureTargetState(t);switch(e.state){case 0:this.isActiveTarget(t)&&r.updateResumeToken(e.resumeToken);break;case 1:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case 2:r.recordTargetResponse(),r.isPending||this.removeTarget(t);break;case 3:this.isActiveTarget(t)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case 4:this.isActiveTarget(t)&&(this.resetTarget(t),r.updateResumeToken(e.resumeToken));break;default:J()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.targetStates.forEach((r,i)=>{this.isActiveTarget(i)&&t(i)})}handleExistenceFilter(e){let t=e.targetId,r=e.existenceFilter.count,i=this.targetDataForActiveTarget(t);if(i){let s=i.target;if(Bm(s))if(r===0){let o=new Y(s.path);this.removeDocumentFromTarget(t,o,pn.newNoDocument(o,te.min()))}else ge(r===1);else{let o=this.getCurrentDocumentCountForTarget(t);if(o!==r){let a=this.parseBloomFilter(e),l=a?this.applyBloomFilter(a,e,o):1;if(l!==0){this.resetTarget(t);let c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.pendingTargetResets=this.pendingTargetResets.insert(t,c)}hm?.notifyOnExistenceFilterMismatch(YF(o,e.existenceFilter,this.metadataProvider.getDatabaseId(),a,l))}}}}parseBloomFilter(e){let t=e.existenceFilter.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o;try{o=Yr(r).toUint8Array()}catch(l){if(l instanceof Hm)return ha("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}let a;try{a=new Km(o,i,s)}catch(l){return l instanceof wi?ha("BloomFilter error: ",l):ha("Applying bloom filter failed: ",l),null}return a.bitCount===0?null:a}applyBloomFilter(e,t,r){let i=t.existenceFilter.count,s=this.filterRemovedDocuments(e,t.targetId);return i===r-s?0:2}filterRemovedDocuments(e,t){let r=this.metadataProvider.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.metadataProvider.getDatabaseId(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.removeDocumentFromTarget(t,s,null),i++)}),i}createRemoteEvent(e){let t=new Map;this.targetStates.forEach((s,o)=>{let a=this.targetDataForActiveTarget(o);if(a){if(s.current&&Bm(a.target)){let l=new Y(a.target.path);this.pendingDocumentUpdates.get(l)===null&&!this.targetContainsDocument(o,l)&&this.removeDocumentFromTarget(o,l,pn.newNoDocument(l,e))}s.hasPendingChanges&&(t.set(o,s.toTargetChange()),s.clearPendingChanges())}});let r=se();this.pendingDocumentTargetMapping.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{let c=this.targetDataForActiveTarget(l);return c&&c.purpose!=="TargetPurposeLimboResolution"?(a=!1,!1):!0}),a&&(r=r.add(s))}),this.pendingDocumentUpdates.forEach((s,o)=>o.setReadTime(e));let i=new Su(e,t,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=ar(),this.pendingDocumentTargetMapping=iE(),this.pendingTargetResets=new Le(de),i}addDocumentToTarget(e,t){if(!this.isActiveTarget(e))return;let r=this.targetContainsDocument(e,t.key)?2:0;this.ensureTargetState(e).addDocumentChange(t.key,r),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}removeDocumentFromTarget(e,t,r){if(!this.isActiveTarget(e))return;let i=this.ensureTargetState(e);this.targetContainsDocument(e,t)?i.addDocumentChange(t,1):i.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),r&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,r))}removeTarget(e){this.targetStates.delete(e)}getCurrentDocumentCountForTarget(e){let r=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}recordPendingTargetRequest(e){this.ensureTargetState(e).recordPendingTargetRequest()}ensureTargetState(e){let t=this.targetStates.get(e);return t||(t=new wu,this.targetStates.set(e,t)),t}ensureDocumentTargetMapping(e){let t=this.pendingDocumentTargetMapping.get(e);return t||(t=new ut(de),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t}isActiveTarget(e){let t=this.targetDataForActiveTarget(e)!==null;return t||H(QF,"Detected inactive target",e),t}targetDataForActiveTarget(e){let t=this.targetStates.get(e);return t&&t.isPending?null:this.metadataProvider.getTargetDataForTarget(e)}resetTarget(e){this.targetStates.set(e,new wu),this.metadataProvider.getRemoteKeysForTarget(e).forEach(r=>{this.removeDocumentFromTarget(e,r,null)})}targetContainsDocument(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)}};function iE(){return new Le(Y.comparator)}function sE(){return new Le(Y.comparator)}function YF(n,e,t,r,i){var s,o,a,l,c,u;let p={localCacheCount:n,existenceFilterCount:e.count,databaseId:t.database,projectId:t.projectId},g=e.unchangedNames;return g&&(p.bloomFilter={applied:i===0,hashCount:(s=g?.hashCount)!==null&&s!==void 0?s:0,bitmapLength:(l=(a=(o=g?.bits)===null||o===void 0?void 0:o.bitmap)===null||a===void 0?void 0:a.length)!==null&&l!==void 0?l:0,padding:(u=(c=g?.bits)===null||c===void 0?void 0:c.padding)!==null&&u!==void 0?u:0,mightContain:C=>{var A;return(A=r?.mightContain(C))!==null&&A!==void 0?A:!1}}),p}var XF=(()=>{let n={};return n.asc="ASCENDING",n.desc="DESCENDING",n})(),JF=(()=>{let n={};return n["<"]="LESS_THAN",n["<="]="LESS_THAN_OR_EQUAL",n[">"]="GREATER_THAN",n[">="]="GREATER_THAN_OR_EQUAL",n["=="]="EQUAL",n["!="]="NOT_EQUAL",n["array-contains"]="ARRAY_CONTAINS",n.in="IN",n["not-in"]="NOT_IN",n["array-contains-any"]="ARRAY_CONTAINS_ANY",n})(),ZF=(()=>{let n={};return n.and="AND",n.or="OR",n})();var Ym=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function e2(n){let e=n.code===void 0?k.UNKNOWN:mu(n.code);return new G(e,n.message||"")}function Xm(n,e){return n.useProto3Json||ju(e)?e:{value:e}}function t2(n){let e;return typeof n=="object"?e=n.value:e=n,ju(e)?null:e}function Tu(n,e){if(n.useProto3Json){let r=new Date(e.seconds*1e3).toISOString().replace(/\.\d*/,"").replace("Z",""),i=("000000000"+e.nanoseconds).slice(-9);return`${r}.${i}Z`}else return{seconds:""+e.seconds,nanos:e.nanoseconds}}function n2(n){let e=or(n);return new rt(e.seconds,e.nanos)}function yw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function r2(n,e){return n.useProto3Json?(ge(e===void 0||typeof e=="string"),ht.fromBase64String(e||"")):(ge(e===void 0||e instanceof Buffer||e instanceof Uint8Array),ht.fromUint8Array(e||new Uint8Array))}function i2(n,e){return Tu(n,e.toTimestamp())}function Gn(n){return ge(!!n),te.fromTimestamp(n2(n))}function uy(n,e){return Jm(n,e).canonicalString()}function Jm(n,e){let t=o2(n).child("documents");return e===void 0?t:t.child(e)}function vw(n){let e=Me.fromString(n);return ge(Ew(e)),e}function Zm(n,e){return uy(n.databaseId,e.path)}function fm(n,e){let t=vw(e);if(t.get(1)!==n.databaseId.projectId)throw new G(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new G(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Y(Cw(t))}function _w(n,e){return uy(n.databaseId,e)}function s2(n){let e=vw(n);return e.length===4?Me.emptyPath():Cw(e)}function eg(n){return new Me(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function o2(n){return new Me(["projects",n.projectId,"databases",n.database])}function Cw(n){return ge(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function oE(n,e,t){return{name:Zm(n,e),fields:t.value.mapValue.fields}}function a2(n,e){let t;if("targetChange"in e){e.targetChange;let r=l2(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=r2(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&e2(o);t=new Eu(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=fm(n,r.document.name),s=Gn(r.document.updateTime),o=r.document.createTime?Gn(r.document.createTime):te.min(),a=new dn({mapValue:{fields:r.document.fields}}),l=pn.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new qs(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=fm(n,r.document),s=r.readTime?Gn(r.readTime):te.min(),o=pn.newNoDocument(i,s),a=r.removedTargetIds||[];t=new qs([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=fm(n,r.document),s=r.removedTargetIds||[];t=new qs([],s,i,null)}else if("filter"in e){e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Wm(i,s),a=r.targetId;t=new bu(a,o)}else return J();return t}function l2(n){return n==="NO_CHANGE"?0:n==="ADD"?1:n==="REMOVE"?2:n==="CURRENT"?3:n==="RESET"?4:J()}function c2(n){if(!("targetChange"in n))return te.min();let e=n.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?te.min():Gn(e.readTime)}function u2(n,e){let t;if(e instanceof Mi)t={update:oE(n,e.key,e.value)};else if(e instanceof Ea)t={delete:Zm(n,e.key)};else if(e instanceof lr)t={update:oE(n,e.key,e.data),updateMask:z2(e.fieldMask)};else if(e instanceof zm)t={verify:Zm(n,e.key)};else return J();return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>p2(n,r))),e.precondition.isNone||(t.currentDocument=d2(n,e.precondition)),t}function d2(n,e){return e.updateTime!==void 0?{updateTime:i2(n,e.updateTime)}:e.exists!==void 0?{exists:e.exists}:J()}function h2(n,e){let t=n.updateTime?Gn(n.updateTime):Gn(e);return t.isEqual(te.min())&&(t=Gn(e)),new qm(t,n.transformResults||[])}function f2(n,e){return n&&n.length>0?(ge(e!==void 0),n.map(t=>h2(t,e))):[]}function p2(n,e){let t=e.transform;if(t instanceof Ks)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(t instanceof ki)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:t.elements}};if(t instanceof Oi)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:t.elements}};if(t instanceof Qs)return{fieldPath:e.field.canonicalString(),increment:t.operand};throw J()}function m2(n,e){return{documents:[_w(n,e.path)]}}function g2(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=_w(n,i);let s=S2(e.filters);s&&(t.structuredQuery.where=s);let o=E2(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=Xm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=T2(e.startAt)),e.endAt&&(t.structuredQuery.endAt=A2(e.endAt)),{queryTarget:t,parent:i}}function y2(n){let e=s2(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ge(r===1);let u=t.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=b2(t.where));let o=[];t.orderBy&&(o=w2(t.orderBy));let a=null;t.limit&&(a=t2(t.limit));let l=null;t.startAt&&(l=I2(t.startAt));let c=null;return t.endAt&&(c=D2(t.endAt)),hF(e,i,o,s,a,"F",l,c)}function v2(n,e){let t=_2(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _2(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J()}}function C2(n,e){let t,r=e.target;if(Bm(r)?t={documents:m2(n,r)}:t={query:g2(n,r).queryTarget},t.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){t.resumeToken=yw(n,e.resumeToken);let i=Xm(n,e.expectedCount);i!==null&&(t.expectedCount=i)}else if(e.snapshotVersion.compareTo(te.min())>0){t.readTime=Tu(n,e.snapshotVersion.toTimestamp());let i=Xm(n,e.expectedCount);i!==null&&(t.expectedCount=i)}return t}function S2(n){if(n.length!==0)return bw(mn.create(n,"and"))}function b2(n){let e=Sw(n);return e instanceof mn&&JE(e)?e.getFilters():[e]}function Sw(n){return n.unaryFilter!==void 0?B2(n):n.fieldFilter!==void 0?U2(n):n.compositeFilter!==void 0?q2(n):J()}function E2(n){if(n.length!==0)return n.map(e=>N2(e))}function w2(n){return n.map(e=>F2(e))}function T2(n){return{before:n.inclusive,values:n.position}}function A2(n){return{before:!n.inclusive,values:n.position}}function I2(n){let e=!!n.before,t=n.values||[];return new $s(t,e)}function D2(n){let e=!n.before,t=n.values||[];return new $s(t,e)}function x2(n){return XF[n]}function R2(n){switch(n){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function k2(n){return JF[n]}function O2(n){return ZF[n]}function M2(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return J();default:return J()}}function P2(n){switch(n){case"AND":return"and";case"OR":return"or";default:return J()}}function Vs(n){return{fieldPath:n.canonicalString()}}function Us(n){return Ft.fromServerFormat(n.fieldPath)}function N2(n){return{field:Vs(n.field),direction:x2(n.dir)}}function F2(n){return new Ws(Us(n.field),R2(n.direction))}function bw(n){return n instanceof $e?V2(n):n instanceof mn?L2(n):J()}function L2(n){let e=n.getFilters().map(t=>bw(t));return e.length===1?e[0]:{compositeFilter:{op:O2(n.op),filters:e}}}function V2(n){if(n.op==="=="){if(Yb(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NAN"}};if(Qb(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Yb(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NOT_NAN"}};if(Qb(n.value))return{unaryFilter:{field:Vs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vs(n.field),op:k2(n.op),value:n.value}}}function B2(n){switch(n.unaryFilter.op){case"IS_NAN":let e=Us(n.unaryFilter.field);return $e.create(e,"==",{doubleValue:NaN});case"IS_NULL":let t=Us(n.unaryFilter.field);return $e.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=Us(n.unaryFilter.field);return $e.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=Us(n.unaryFilter.field);return $e.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return J();default:return J()}}function U2(n){return $e.create(Us(n.fieldFilter.field),M2(n.fieldFilter.op),n.fieldFilter.value)}function q2(n){return mn.create(n.compositeFilter.filters.map(e=>Sw(e)),P2(n.compositeFilter.op))}function z2(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ew(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ta=class n{constructor(e,t,r,i,s=te.min(),o=te.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var tg=class{constructor(e){this.remoteSerializer=e}};function j2(n){let e=y2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Um(e,e.limit,"L"):e}function G2(n){return{name:n.name,query:j2(n.bundledQuery),readTime:Gn(n.readTime)}}function $2(n){return{id:n.id,version:n.version,createTime:Gn(n.createTime)}}var W2=5,H2=10,K2=13,pm=15,Q2=20,Y2=25,X2=30,J2=37,Z2=45,eL=50,tL=53,nL=55,rL=60,iL=2,Au=class{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,W2);else if("booleanValue"in e)this.writeValueTypeLabel(t,H2),t.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(t,pm),t.writeNumber(Re(e.integerValue));else if("doubleValue"in e){let r=Re(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,K2):(this.writeValueTypeLabel(t,pm),_a(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,Q2),typeof r=="string"&&(r=or(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,X2),t.writeBytes(Yr(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,Z2),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?KE(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):HE(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):J()}writeIndexString(e,t){this.writeValueTypeLabel(t,Y2),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,nL);for(let i of Object.keys(r))this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexVector(e,t){var r,i;let s=e.fields||{};this.writeValueTypeLabel(t,tL);let o=zs,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.writeValueTypeLabel(t,pm),t.writeNumber(Re(a)),this.writeIndexString(o,t),this.writeIndexValueAux(s[o],t)}writeIndexArray(e,t){let r=e.values||[];this.writeValueTypeLabel(t,eL);for(let i of r)this.writeIndexValueAux(i,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,J2),Y.fromName(e).path.forEach(i=>{this.writeValueTypeLabel(t,rL),this.writeUnlabeledIndexString(i,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(iL)}};Au.INSTANCE=new Au;var ng=class{constructor(){this.collectionParentIndex=new rg}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),L.resolve()}getCollectionParents(e,t){return L.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return L.resolve()}deleteFieldIndex(e,t){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,t){return L.resolve()}getDocumentsMatchingTarget(e,t){return L.resolve(null)}getIndexType(e,t){return L.resolve(0)}getFieldIndexes(e,t){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,t){return L.resolve(Di.min())}getMinOffsetFromCollectionGroup(e,t){return L.resolve(Di.min())}updateCollectionGroup(e,t,r){return L.resolve()}updateIndexEntries(e,t){return L.resolve()}},rg=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ut(Me.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ut(Me.comparator)).toArray()}};var g6=new Uint8Array(0);var mm=2,Aa=class n{constructor(e){this.lastId=e}next(){return this.lastId+=mm,this.lastId}static forTargetCache(){return new n(2-mm)}static forSyncEngine(){return new n(1-mm)}};var ww=-1,Tw=40*1024*1024,qn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};qn.DEFAULT_COLLECTION_PERCENTILE=10;qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;qn.DEFAULT=new qn(Tw,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);qn.DISABLED=new qn(ww,0,0);var aE=1*1024*1024,y6=1*60*1e3,v6=5*60*1e3;var ig=class{constructor(){this.changes=new Xr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?L.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var sg=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var og=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ma(r.mutation,i,Un.empty(),rt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,se()).next(()=>r))}getLocalViewOfDocuments(e,t,r=se()){let i=Ei();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=da();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Ei();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,se()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=ar(),o=ba(),a=wF();return t.forEach((l,c)=>{let u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof lr)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),ma(u.mutation,c,u.mutation.getFieldMask(),rt.now())):o.set(c.key,Un.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var p;return a.set(c,new sg(u,(p=o.get(c))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=ba(),i=new Le((o,a)=>o-a),s=se();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(l=>{let c=t.get(l);if(c===null)return;let u=r.get(l)||Un.empty();u=a.applyToLocalView(c,u),r.set(l,u);let p=(i.get(a.batchId)||se()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let l=a.getNext(),c=l.key,u=l.value,p=aw();u.forEach(g=>{if(!s.has(g)){let C=fw(t.get(g),r.get(g));C!==null&&p.set(g,C),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return L.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return mF(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):L.resolve(Ei()),a=ya,l=s;return o.next(c=>L.forEach(c,(u,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(u)?L.resolve():this.remoteDocumentCache.getEntry(e,u).next(g=>{l=l.insert(u,g)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,se())).next(u=>({batchId:a,changes:ow(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next(r=>{let i=da();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=da();return this.indexManager.getCollectionParents(e,s).next(a=>L.forEach(a,l=>{let c=fF(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(u=>{u.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,c)=>{let u=c.getKey();o.get(u)===null&&(o=o.insert(u,pn.newInvalidDocument(u)))});let a=da();return o.forEach((l,c)=>{let u=s.get(l);u!==void 0&&ma(u.mutation,c,Un.empty(),rt.now()),$u(t,c)&&(a=a.insert(l,c))}),a})}};var ag=class{constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return L.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,$2(t)),L.resolve()}getNamedQuery(e,t){return L.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,G2(t)),L.resolve()}};var lg=class{constructor(){this.overlays=new Le(Y.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return L.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Ei();return L.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.saveOverlay(e,t,s)}),L.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.overlayByBatchId.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.overlayByBatchId.delete(r)),L.resolve()}getOverlaysForCollection(e,t,r){let i=Ei(),s=t.length+1,o=new Y(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Le((c,u)=>c-u),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let g=s.get(u.largestBatchId);g===null&&(g=Ei(),s=s.insert(u.largestBatchId,g)),g.set(u.getKey(),u)}}let a=Ei(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((p,g)=>a.set(p,g)),!(a.size()>=i)););return L.resolve(a)}saveOverlay(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.overlayByBatchId.get(i.largestBatchId).delete(r.key);this.overlayByBatchId.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new $m(t,r));let s=this.overlayByBatchId.get(t);s===void 0&&(s=se(),this.overlayByBatchId.set(t,s)),this.overlayByBatchId.set(t,s.add(r.key))}};var cg=class{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,L.resolve()}};var Ia=class{constructor(){this.refsByKey=new ut(Ge.compareByKey),this.refsByTarget=new ut(Ge.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new Ge(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.removeRef(new Ge(e,t))}removeReferences(e,t){e.forEach(r=>this.removeReference(r,t))}removeReferencesForId(e){let t=new Y(new Me([])),r=new Ge(t,e),i=new Ge(t,e+1),s=[];return this.refsByTarget.forEachInRange([r,i],o=>{this.removeRef(o),s.push(o.key)}),s}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new Y(new Me([])),r=new Ge(t,e),i=new Ge(t,e+1),s=se();return this.refsByTarget.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ge(e,0),r=this.refsByKey.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ge=class{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return Y.comparator(e.key,t.key)||de(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return de(e.targetOrBatchId,t.targetOrBatchId)||Y.comparator(e.key,t.key)}};var ug=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new ut(Ge.compareByKey)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new jm(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Ge(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(o)}lookupMutationBatch(e,t){return L.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.indexOfBatchId(r),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?ey:this.nextBatchId-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ge(t,0),i=new Ge(t,Number.POSITIVE_INFINITY),s=[];return this.batchesByDocumentKey.forEachInRange([r,i],o=>{let a=this.findMutationBatch(o.targetOrBatchId);s.push(a)}),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ut(de);return t.forEach(i=>{let s=new Ge(i,0),o=new Ge(i,Number.POSITIVE_INFINITY);this.batchesByDocumentKey.forEachInRange([s,o],a=>{r=r.add(a.targetOrBatchId)})}),L.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;Y.isDocumentKey(s)||(s=s.child(""));let o=new Ge(new Y(s),0),a=new ut(de);return this.batchesByDocumentKey.forEachWhile(l=>{let c=l.key.path;return r.isPrefixOf(c)?(c.length===i&&(a=a.add(l.targetOrBatchId)),!0):!1},o),L.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(r=>{let i=this.findMutationBatch(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){let r=this.indexOfExistingBatchId(t.batchId,"removed");ge(r===0),this.mutationQueue.shift();let i=this.batchesByDocumentKey;return L.forEach(t.mutations,s=>{let o=new Ge(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.batchesByDocumentKey=i})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new Ge(t,0),i=this.batchesByDocumentKey.firstAfterOrEqual(r);return L.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){if(this.mutationQueue.length===0)return 0;let t=this.mutationQueue[0].batchId;return e-t}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};function sL(){return new Le(Y.comparator)}var dg=class{constructor(e){this.sizer=e,this.docs=sL(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return L.resolve(r?r.document.mutableCopy():pn.newInvalidDocument(t))}getEntries(e,t){let r=ar();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():pn.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=ar(),o=t.path,a=new Y(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){let{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||cN(lN(u),r)<=0||!i.has(u.key)&&!$u(t,u)||(s=s.insert(u.key,u.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(e,t,r,i){J()}forEachDocumentKey(e,t){return L.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hg(this)}getSize(e){return L.resolve(this.size)}};function oL(n){return new dg(n)}var hg=class extends ig{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.documentCache.addEntry(e,i)):this.documentCache.removeEntry(r)}),L.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}};var fg=class{constructor(e){this.persistence=e,this.targets=new Xr(t=>sy(t),oy),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Ia,this.targetCount=0,this.targetIdGenerator=Aa.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((r,i)=>t(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),L.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new Aa(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,L.resolve()}updateTargetData(e,t){return this.saveTargetData(t),L.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.targets.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.targets.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),L.waitFor(s).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return L.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),L.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),L.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),L.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return L.resolve(r)}containsKey(e,t){return L.resolve(this.references.containsKey(t))}};var aL="MemoryPersistence",pg=class{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new AE(0),this._started=!1,this._started=!0,this.globalsCache=new cg,this.referenceDelegate=e(this),this.targetCache=new fg(this);let r=i=>this.referenceDelegate.documentSize(i);this.indexManager=new ng,this.remoteDocumentCache=oL(r),this.serializer=new tg(t),this.bundleCache=new ag(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lg,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new ug(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){H(aL,"Starting transaction:",e);let i=new mg(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(s=>this.referenceDelegate.onTransactionCommitted(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}mutationQueuesContainKey(e,t){return L.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}},mg=class extends Am{constructor(e){super(),this.currentSequenceNumber=e}},gg=class n{constructor(e){this.persistence=e,this.localViewReferences=new Ia,this._orphanedDocuments=null}static factory(e){return new n(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw J()}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),L.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),L.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(s=>this.orphanedDocuments.add(s.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.orphanedDocuments.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.orphanedDocuments,i=>{let s=Y.fromPath(i);return this.isReferenced(e,s).next(o=>{o||r.removeEntry(s,te.min())})}).next(()=>(this._orphanedDocuments=null,r.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(r=>{r?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return L.or([()=>L.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}};var _6=30*60*1e3;function lL(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}var dy="LocalStore",cL=5*60*1e6,yg=class{constructor(e,t,r,i){this.persistence=e,this.queryEngine=t,this.serializer=i,this.targetDataByTarget=new Le(de),this.targetIdByTarget=new Xr(s=>sy(s),oy),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new og(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}};function uL(n,e,t,r){return new yg(n,e,t,r)}function Aw(n,e){return R(this,null,function*(){let t=ee(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.initializeUserComponents(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{let a=[],l=[],c=se();for(let u of s){a.push(u.batchId);for(let p of u.mutations)c=c.add(p.key)}for(let u of o){l.push(u.batchId);for(let p of u.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(i,c).next(u=>({affectedDocuments:u,removedBatchIds:a,addedBatchIds:l}))})})})}function dL(n,e){let t=ee(n),r=rt.now(),i=e.reduce((a,l)=>a.add(l.key),se()),s,o;return t.persistence.runTransaction("Locally write mutations","readwrite",a=>{let l=ar(),c=se();return t.remoteDocuments.getEntries(a,i).next(u=>{l=u,l.forEach((p,g)=>{g.isValidDocument()||(c=c.add(p))})}).next(()=>t.localDocuments.getOverlayedDocuments(a,l)).next(u=>{s=u;let p=[];for(let g of e){let C=VF(g,s.get(g.key).overlayedDocument);C!=null&&p.push(new lr(g.key,C,QE(C.value.mapValue),Kr.exists(!0)))}return t.mutationQueue.addMutationBatch(a,r,p,e)}).next(u=>{o=u;let p=u.applyToLocalDocumentSet(s,c);return t.documentOverlayCache.saveOverlays(a,u.batchId,p)})}).then(()=>({batchId:o.batchId,changes:ow(s)}))}function hL(n,e){let t=ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});return bL(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,fL(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function fL(n){let e=se();for(let t=0;t<n.mutationResults.length;++t)n.mutationResults[t].transformResults.length>0&&(e=e.add(n.batch.mutations[t].key));return e}function pL(n,e){let t=ee(n);return t.persistence.runTransaction("Reject batch","readwrite-primary",r=>{let i;return t.mutationQueue.lookupMutationBatch(r,e).next(s=>(ge(s!==null),i=s.keys(),t.mutationQueue.removeMutationBatch(r,s))).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,i)).next(()=>t.localDocuments.getDocuments(r,i))})}function Iw(n){let e=ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.targetCache.getLastRemoteSnapshotVersion(t))}function mL(n,e){let t=ee(n),r=e.snapshotVersion,i=t.targetDataByTarget;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.remoteDocuments.newChangeBuffer({trackRemovals:!0});i=t.targetDataByTarget;let a=[];e.targetChanges.forEach((u,p)=>{let g=i.get(p);if(!g)return;a.push(t.targetCache.removeMatchingKeys(s,u.removedDocuments,p).next(()=>t.targetCache.addMatchingKeys(s,u.addedDocuments,p)));let C=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?C=C.withResumeToken(ht.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):u.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(u.resumeToken,r)),i=i.insert(p,C),yL(g,C,u)&&a.push(t.targetCache.updateTargetData(s,C))});let l=ar(),c=se();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(gL(s,o,e.documentUpdates).next(u=>{l=u.changedDocuments,c=u.existenceChangedKeys})),!r.isEqual(te.min())){let u=t.targetCache.getLastRemoteSnapshotVersion(s).next(p=>t.targetCache.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return L.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.targetDataByTarget=i,s))}function gL(n,e,t){let r=se(),i=se();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=ar();return t.forEach((a,l)=>{let c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(te.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H(dy,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{changedDocuments:o,existenceChangedKeys:i}})}function yL(n,e,t){return n.resumeToken.approximateByteSize()===0||e.snapshotVersion.toMicroseconds()-n.snapshotVersion.toMicroseconds()>=cL?!0:t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size>0}function vL(n,e){return R(this,null,function*(){let t=ee(n);try{yield t.persistence.runTransaction("notifyLocalViewChanges","readwrite",r=>L.forEach(e,i=>L.forEach(i.addedKeys,s=>t.persistence.referenceDelegate.addReference(r,i.targetId,s)).next(()=>L.forEach(i.removedKeys,s=>t.persistence.referenceDelegate.removeReference(r,i.targetId,s)))))}catch(r){if(Na(r))H(dy,"Failed to update sequence numbers: "+r);else throw r}for(let r of e){let i=r.targetId;if(!r.fromCache){let s=t.targetDataByTarget.get(i),o=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(o);t.targetDataByTarget=t.targetDataByTarget.insert(i,a)}}})}function _L(n,e){let t=ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ey),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function CL(n,e){let t=ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.targetCache.getTargetData(r,e).next(s=>s?(i=s,L.resolve(i)):t.targetCache.allocateTargetId(r).next(o=>(i=new Ta(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.targetCache.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.targetDataByTarget.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.targetDataByTarget=t.targetDataByTarget.insert(r.targetId,r),t.targetIdByTarget.set(e,r.targetId)),r})}function SL(n,e,t){let r=ee(n),i=r.targetIdByTarget.get(t);return i!==void 0?L.resolve(r.targetDataByTarget.get(i)):r.targetCache.getTargetData(e,t)}function vg(n,e,t){return R(this,null,function*(){let r=ee(n),i=r.targetDataByTarget.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(Na(o))H(dy,`Failed to update sequence numbers for target ${e}: ${o}`);else throw o}r.targetDataByTarget=r.targetDataByTarget.remove(e),r.targetIdByTarget.delete(i.target)})}function Dw(n,e,t){let r=ee(n),i=te.min(),s=se();return r.persistence.runTransaction("Execute query","readwrite",o=>SL(r,o,jn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.targetCache.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.queryEngine.getDocumentsMatchingQuery(o,e,t?i:te.min(),t?s:se())).next(a=>(EL(r,SF(e),a),{documents:a,remoteKeys:s})))}function bL(n,e,t,r){let i=t.batch,s=i.keys(),o=L.resolve();return s.forEach(a=>{o=o.next(()=>r.getEntry(e,a)).next(l=>{let c=t.docVersions.get(a);ge(c!==null),l.version.compareTo(c)<0&&(i.applyToRemoteDocument(l,t),l.isValidDocument()&&(l.setReadTime(t.commitVersion),r.addEntry(l)))})}),o.next(()=>n.mutationQueue.removeMutationBatch(e,i))}function EL(n,e,t){let r=n.collectionGroupReadTime.get(e)||te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.collectionGroupReadTime.set(e,r)}var _g=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var wL=100;function TL(){return lv()?8:dN(av())>0?6:4}var Cg=class{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=wL,this.relativeIndexReadCostPerDocument=TL()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.performQueryUsingIndex(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.performQueryUsingRemoteKeys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new _g;return this.executeFullCollectionScan(e,t,o).next(a=>{if(s.result=a,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,o,a.size)})}).next(()=>s.result)}createCacheIndexes(e,t,r,i){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(ua()<=Kn.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",Ls(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),L.resolve()):(ua()<=Kn.DEBUG&&H("QueryEngine","Query:",Ls(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*i?(ua()<=Kn.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",Ls(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jn(t))):L.resolve())}performQueryUsingIndex(e,t){if(Zb(t))return L.resolve(null);let r=jn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Um(t,null,"F"),r=jn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=se(...s);return this.localDocumentsView.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{let c=this.applyQuery(t,a);return this.needsRefill(t,c,o,l.readTime)?this.performQueryUsingIndex(e,Um(t,null,"F")):this.appendRemainingResults(e,c,t,l)}))})))}performQueryUsingRemoteKeys(e,t,r,i){return Zb(t)||i.isEqual(te.min())?L.resolve(null):this.localDocumentsView.getDocuments(e,r).next(s=>{let o=this.applyQuery(t,s);return this.needsRefill(t,o,r,i)?L.resolve(null):(ua()<=Kn.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ls(t)),this.appendRemainingResults(e,o,t,aN(i,ya)).next(a=>a))})}applyQuery(e,t){let r=new ut(iw(e));return t.forEach((i,s)=>{$u(e,s)&&(r=r.add(s))}),r}needsRefill(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return s?s.hasPendingWrites||s.version.compareTo(i)>0:!1}executeFullCollectionScan(e,t,r){return ua()<=Kn.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",Ls(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,Di.min(),r)}appendRemainingResults(e,t,r,i){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Iu=class{constructor(){this.activeTargetIds=xF()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Sg=class{constructor(){this.localState=new Iu,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new Iu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var bg=class{addCallback(e){}shutdown(){}};var Eg=class{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}};var fu=null;function AL(){return 268435456+Math.round(2147483648*Math.random())}function gm(){return fu===null?fu=AL():fu++,"0x"+fu.toString(16)}function IL(n){return new Promise((e,t)=>{n((r,i)=>{r?t(r):e(i)})})}var DL="1.9.1",Ct="GrpcConnection",xL=`gl-node/${process.versions.node} fire/${eo} grpc/${DL}`;function ym(n,e,t,r){ge(e===null||e.type==="OAuth");let i=new Ti.Metadata;return e&&e.headers.forEach((s,o)=>i.set(o,s)),t&&t.headers.forEach((s,o)=>i.set(o,s)),r&&i.set("X-Firebase-GMPID",r),i.set("X-Goog-Api-Client",xL),i.set("Google-Cloud-Resource-Prefix",n),i.set("x-goog-request-params",n),i}var wg=class{constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}get shouldResourcePathBeIncludedInRequest(){return!0}ensureActiveStub(){if(!this.cachedStub){H(Ct,"Creating Firestore stub.");let e=this.databaseInfo.ssl?Ti.credentials.createSsl():Ti.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,i,s){let o=gm(),a=this.ensureActiveStub(),l=ym(this.databasePath,i,s,this.databaseInfo.appId),c=Object.assign({database:this.databasePath},r);return IL(u=>(H(Ct,`RPC '${e}' ${o} invoked with request:`,r),a[e](c,l,(p,g)=>{p?(H(Ct,`RPC '${e}' ${o} failed with error:`,p),u(new G(mu(p.code),p.message))):(H(Ct,`RPC '${e}' ${o} completed with response:`,g),u(void 0,g))})))}invokeStreamingRPC(e,t,r,i,s,o){let a=gm(),l=[],c=new zn;H(Ct,`RPC '${e}' ${a} invoked (streaming) with request:`,r);let u=this.ensureActiveStub(),p=ym(this.databasePath,i,s,this.databaseInfo.appId),g=Object.assign(Object.assign({},r),{database:this.databasePath}),C=u[e](g,p),A=!1;return C.on("data",I=>{H(Ct,`RPC ${e} ${a} received result:`,I),l.push(I),o!==void 0&&l.length===o&&(A=!0,c.resolve(l))}),C.on("end",()=>{H(Ct,`RPC '${e}' ${a} completed.`),A||(A=!0,c.resolve(l))}),C.on("error",I=>{H(Ct,`RPC '${e}' ${a} failed with error:`,I);let T=mu(I.code);c.reject(new G(T,I.message))}),c.promise}openStream(e,t,r){let i=gm(),s=this.ensureActiveStub(),o=ym(this.databasePath,t,r,this.databaseInfo.appId),a=s[e](o),l=!1,c=g=>{l||(l=!0,u.callOnClose(g),a.end())},u=new Eg({sendFn:g=>{if(l)H(Ct,`RPC '${e}' stream ${i} not sending because gRPC stream is closed:`,g);else{H(Ct,`RPC '${e}' stream ${i} sending:`,g);try{a.write(g)}catch(C){throw fn("Failure sending:",g),fn("Error:",C),C}}},closeFn:()=>{H(Ct,`RPC '${e}' stream ${i} closed locally via close().`),c()}}),p=!1;return a.on("data",g=>{l||(H(Ct,`RPC '${e}' stream ${i} received:`,g),p||(u.callOnConnected(),p=!0),u.callOnMessage(g))}),a.on("end",()=>{H(Ct,`RPC '${e}' stream ${i} ended.`),c()}),a.on("error",g=>{if(!l){ha(Ct,`RPC '${e}' stream ${i} error. Code:`,g.code,"Message:",g.message);let C=mu(g.code);c(new G(C,g.message))}}),H(Ct,`Opening RPC '${e}' stream ${i} to ${this.databaseInfo.host}`),setTimeout(()=>{u.callOnOpen()},0),u}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}},xw={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:72295728,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}},RL={nested:xw},kL=Object.freeze({__proto__:null,nested:xw,default:RL});var OL={longs:String,enums:String,defaults:!0,oneofs:!1};function ML(){let n=TE.fromJSON(kL,OL);return Ti.loadPackageDefinition(n)}function PL(n){let e=ML();return new wg(e,n)}function NL(){return new bg}function Hu(n){return new Ym(n,!1)}var FL="ExponentialBackoff",LL=1e3,VL=1.5,BL=60*1e3,Du=class{constructor(e,t,r=LL,i=VL,s=BL){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&H(FL,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var lE="PersistentStream",UL=60*1e3,qL=10*1e3,xu=class{constructor(e,t,r,i,s,o,a,l){this.queue=e,this.idleTimerId=r,this.healthTimerId=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new Du(e,t)}isStarted(){return this.state===1||this.state===5||this.isOpen()}isOpen(){return this.state===2||this.state===3}start(){if(this.responseCount=0,this.state===4){this.performBackoff();return}this.auth()}stop(){return R(this,null,function*(){this.isStarted()&&(yield this.close(0))})}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&this.idleTimer===null&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,UL,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}handleIdleCloseTimer(){return R(this,null,function*(){if(this.isOpen())return this.close(0)})}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}close(e,t){return R(this,null,function*(){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,e!==4?this.backoff.reset():t&&t.code===k.RESOURCE_EXHAUSTED?(fn(t.toString()),fn("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.onClose(t)})}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.closeCount===t&&this.startStream(r,i)},r=>{e(()=>{let i=new G(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.handleStreamClose(i)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,qL,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(i=>{r(()=>this.handleStreamClose(i))}),this.stream.onMessage(i=>{r(()=>++this.responseCount===1?this.onFirst(i):this.onNext(i))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(()=>R(this,null,function*(){this.state=0,this.start()}))}handleStreamClose(e){return H(lE,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(H(lE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Tg=class extends xu{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}startRpc(e,t){return this.connection.openStream("Listen",e,t)}onFirst(e){return this.onNext(e)}onNext(e){this.backoff.reset();let t=a2(this.serializer,e),r=c2(e);return this.listener.onWatchChange(t,r)}watch(e){let t={};t.database=eg(this.serializer),t.addTarget=C2(this.serializer,e);let r=v2(this.serializer,e);r&&(t.labels=r),this.sendRequest(t)}unwatch(e){let t={};t.database=eg(this.serializer),t.removeTarget=e,this.sendRequest(t)}},Ag=class extends xu{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return ge(!!e.streamToken),this.lastStreamToken=e.streamToken,ge(!e.writeResults||e.writeResults.length===0),this.listener.onHandshakeComplete()}onNext(e){ge(!!e.streamToken),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=f2(e.writeResults,e.commitTime),r=Gn(e.commitTime);return this.listener.onMutationResult(r,t)}writeHandshake(){let e={};e.database=eg(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>u2(this.serializer,r))};this.sendRequest(t)}};var Ig=class{},Dg=class extends Ig{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new G(k.FAILED_PRECONDITION,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.invokeRPC(e,Jm(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(k.UNKNOWN,s.toString())})}invokeStreamingRPC(e,t,r,i,s){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.invokeStreamingRPC(e,Jm(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(k.UNKNOWN,o.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}};function zL(n,e,t,r){return new Dg(n,e,t,r)}function jL(n,e,t){let r=ee(n);return r.verifyInitialized(),new Ag(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}function GL(n,e,t){let r=ee(n);return r.verifyInitialized(),new Tg(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,t)}var $L="OnlineStateTracker",cE=1,uE=10*1e3,xg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){this.watchStreamFailures===0&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",uE,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${uE/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){this.state==="Online"?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=cE&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${cE} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e==="Online"&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(fn(t),this.shouldWarnClientIsOffline=!1):H($L,t)}clearOnlineStateTimer(){this.onlineStateTimer!==null&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}};var Pi="RemoteStore",WL=10,Rg=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=s,this.connectivityMonitor.addCallback(o=>{r.enqueueAndForget(()=>R(this,null,function*(){Li(this)&&(H(Pi,"Restarting streams for network reachability change."),yield lV(this))}))}),this.onlineStateTracker=new xg(r,i)}};function HL(n,e,t,r,i){return new Rg(n,e,t,r,i)}function Ku(n){return R(this,null,function*(){if(Li(n))for(let e of n.onNetworkStatusChange)yield e(!0)})}function Fa(n){return R(this,null,function*(){for(let e of n.onNetworkStatusChange)yield e(!1)})}function KL(n){return R(this,null,function*(){let e=ee(n);H(Pi,"RemoteStore shutting down."),e.offlineCauses.add(5),yield Fa(e),e.connectivityMonitor.shutdown(),e.onlineStateTracker.set("Unknown")})}function Rw(n,e){let t=ee(n);t.listenTargets.has(e.targetId)||(t.listenTargets.set(e.targetId,e),my(t)?py(t):no(t).isOpen()&&fy(t,e))}function hy(n,e){let t=ee(n),r=no(t);t.listenTargets.delete(e),r.isOpen()&&kw(t,e),t.listenTargets.size===0&&(r.isOpen()?r.markIdle():Li(t)&&t.onlineStateTracker.set("Unknown"))}function fy(n,e){if(n.watchChangeAggregator.recordPendingTargetRequest(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}no(n).watch(e)}function kw(n,e){n.watchChangeAggregator.recordPendingTargetRequest(e),no(n).unwatch(e)}function py(n){n.watchChangeAggregator=new Qm({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),getTargetDataForTarget:e=>n.listenTargets.get(e)||null,getDatabaseId:()=>n.datastore.serializer.databaseId}),no(n).start(),n.onlineStateTracker.handleWatchStreamStart()}function my(n){return Li(n)&&!no(n).isStarted()&&n.listenTargets.size>0}function Li(n){return ee(n).offlineCauses.size===0}function Ow(n){n.watchChangeAggregator=void 0}function QL(n){return R(this,null,function*(){n.onlineStateTracker.set("Online")})}function YL(n){return R(this,null,function*(){n.listenTargets.forEach((e,t)=>{fy(n,e)})})}function XL(n,e){return R(this,null,function*(){Ow(n),my(n)?(n.onlineStateTracker.handleWatchStreamFailure(e),py(n)):n.onlineStateTracker.set("Unknown")})}function JL(n,e,t){return R(this,null,function*(){if(n.onlineStateTracker.set("Online"),e instanceof Eu&&e.state===2&&e.cause){try{yield eV(n,e)}catch(r){H(Pi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ru(n,r)}return}if(e instanceof qs?n.watchChangeAggregator.handleDocumentChange(e):e instanceof bu?n.watchChangeAggregator.handleExistenceFilter(e):n.watchChangeAggregator.handleTargetChange(e),!t.isEqual(te.min()))try{let r=yield Iw(n.localStore);t.compareTo(r)>=0&&(yield ZL(n,t))}catch(r){H(Pi,"Failed to raise snapshot:",r),yield Ru(n,r)}})}function Ru(n,e,t){return R(this,null,function*(){if(Na(e))n.offlineCauses.add(1),yield Fa(n),n.onlineStateTracker.set("Offline"),t||(t=()=>Iw(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){H(Pi,"Retrying IndexedDB access"),yield t(),n.offlineCauses.delete(1),yield Ku(n)}));else throw e})}function Mw(n,e){return e().catch(t=>Ru(n,t,e))}function ZL(n,e){let t=n.watchChangeAggregator.createRemoteEvent(e);return t.targetChanges.forEach((r,i)=>{if(r.resumeToken.approximateByteSize()>0){let s=n.listenTargets.get(i);s&&n.listenTargets.set(i,s.withResumeToken(r.resumeToken,e))}}),t.targetMismatches.forEach((r,i)=>{let s=n.listenTargets.get(r);if(!s)return;n.listenTargets.set(r,s.withResumeToken(ht.EMPTY_BYTE_STRING,s.snapshotVersion)),kw(n,r);let o=new Ta(s.target,r,i,s.sequenceNumber);fy(n,o)}),n.remoteSyncer.applyRemoteEvent(t)}function eV(n,e){return R(this,null,function*(){let t=e.cause;for(let r of e.targetIds)n.listenTargets.has(r)&&(yield n.remoteSyncer.rejectListen(r,t),n.listenTargets.delete(r),n.watchChangeAggregator.removeTarget(r))})}function Qu(n){return R(this,null,function*(){let e=ee(n),t=Zr(e),r=e.writePipeline.length>0?e.writePipeline[e.writePipeline.length-1].batchId:ey;for(;tV(e);)try{let i=yield _L(e.localStore,r);if(i===null){e.writePipeline.length===0&&t.markIdle();break}else r=i.batchId,nV(e,i)}catch(i){yield Ru(e,i)}Pw(e)&&Nw(e)})}function tV(n){return Li(n)&&n.writePipeline.length<WL}function nV(n,e){n.writePipeline.push(e);let t=Zr(n);t.isOpen()&&t.handshakeComplete&&t.writeMutations(e.mutations)}function Pw(n){return Li(n)&&!Zr(n).isStarted()&&n.writePipeline.length>0}function Nw(n){Zr(n).start()}function rV(n){return R(this,null,function*(){Zr(n).writeHandshake()})}function iV(n){return R(this,null,function*(){let e=Zr(n);for(let t of n.writePipeline)e.writeMutations(t.mutations)})}function sV(n,e,t){return R(this,null,function*(){let r=n.writePipeline.shift(),i=Gm.from(r,e,t);yield Mw(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Qu(n)})}function oV(n,e){return R(this,null,function*(){e&&Zr(n).handshakeComplete&&(yield aV(n,e)),Pw(n)&&Nw(n)})}function aV(n,e){return R(this,null,function*(){if(WF(e.code)){let t=n.writePipeline.shift();Zr(n).inhibitBackoff(),yield Mw(n,()=>n.remoteSyncer.rejectFailedWrite(t.batchId,e)),yield Qu(n)}})}function lV(n){return R(this,null,function*(){let e=ee(n);e.offlineCauses.add(4),yield Fa(e),e.onlineStateTracker.set("Unknown"),e.offlineCauses.delete(4),yield Ku(e)})}function dE(n,e){return R(this,null,function*(){let t=ee(n);t.asyncQueue.verifyOperationInProgress(),H(Pi,"RemoteStore received new credentials");let r=Li(t);t.offlineCauses.add(3),yield Fa(t),r&&t.onlineStateTracker.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.offlineCauses.delete(3),yield Ku(t)})}function cV(n,e){return R(this,null,function*(){let t=ee(n);e?(t.offlineCauses.delete(2),yield Ku(t)):e||(t.offlineCauses.add(2),yield Fa(t),t.onlineStateTracker.set("Unknown"))})}function no(n){return n.watchStream||(n.watchStream=GL(n.datastore,n.asyncQueue,{onConnected:QL.bind(null,n),onOpen:YL.bind(null,n),onClose:XL.bind(null,n),onWatchChange:JL.bind(null,n)}),n.onNetworkStatusChange.push(e=>R(this,null,function*(){e?(n.watchStream.inhibitBackoff(),my(n)?py(n):n.onlineStateTracker.set("Unknown")):(yield n.watchStream.stop(),Ow(n))}))),n.watchStream}function Zr(n){return n.writeStream||(n.writeStream=jL(n.datastore,n.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:rV.bind(null,n),onClose:oV.bind(null,n),onHandshakeComplete:iV.bind(null,n),onMutationResult:sV.bind(null,n)}),n.onNetworkStatusChange.push(e=>R(this,null,function*(){e?(n.writeStream.inhibitBackoff(),yield Qu(n)):(yield n.writeStream.stop(),n.writePipeline.length>0&&(H(Pi,`Stopping write stream with ${n.writePipeline.length} pending writes`),n.writePipeline=[]))}))),n.writeStream}var uV="AsyncQueue",kg=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function gy(n,e){if(fn(uV,`${e}: ${n}`),Na(n))return new G(k.UNAVAILABLE,`${e}: ${n}`);throw n}var ku=class n{constructor(e){e?this.comparator=(t,r)=>e(t,r)||Y.comparator(t.key,r.key):this.comparator=(t,r)=>Y.comparator(t.key,r.key),this.keyedMap=da(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ou=class{constructor(){this.changeMap=new Le(Y.comparator)}track(e){let t=e.doc.key,r=this.changeMap.get(t);if(!r){this.changeMap=this.changeMap.insert(t,e);return}e.type!==0&&r.type===3?this.changeMap=this.changeMap.insert(t,e):e.type===3&&r.type!==1?this.changeMap=this.changeMap.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.changeMap=this.changeMap.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.changeMap=this.changeMap.remove(t):e.type===1&&r.type===2?this.changeMap=this.changeMap.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.changeMap=this.changeMap.insert(t,{type:2,doc:e.doc}):J()}getChanges(){let e=[];return this.changeMap.inorderTraversal((t,r)=>{e.push(r)}),e}},Xs=class n{constructor(e,t,r,i,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,ku.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(this.fromCache!==e.fromCache||this.hasCachedResults!==e.hasCachedResults||this.syncStateChanged!==e.syncStateChanged||!this.mutatedKeys.isEqual(e.mutatedKeys)||!Gu(this.query,e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Og=class{constructor(){this.viewSnap=void 0,this.listeners=[]}hasRemoteListeners(){return this.listeners.some(e=>e.listensToRemoteStore())}};function dV(){return new Mg}var Mg=class{constructor(){this.queries=Fw(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){yV(this,new G(k.ABORTED,"Firestore shutting down"))}};function Fw(){return new Xr(n=>rw(n),Gu)}function hV(n,e){return R(this,null,function*(){let t=ee(n),r=3,i=e.query,s=t.queries.get(i);s?!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(r=2):(s=new Og,r=e.listensToRemoteStore()?0:1);try{switch(r){case 0:s.viewSnap=yield t.onListen(i,!0);break;case 1:s.viewSnap=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i);break;default:break}}catch(o){let a=gy(o,`Initialization of query '${Ls(e.query)}' failed`);e.onError(a);return}t.queries.set(i,s),s.listeners.push(e),e.applyOnlineStateChange(t.onlineState),s.viewSnap&&e.onViewSnapshot(s.viewSnap)&&yy(t)})}function fV(n,e){return R(this,null,function*(){let t=ee(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),s.listeners.length===0?i=e.listensToRemoteStore()?0:1:!s.hasRemoteListeners()&&e.listensToRemoteStore()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function pV(n,e){let t=ee(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.onViewSnapshot(i)&&(r=!0);o.viewSnap=i}}r&&yy(t)}function mV(n,e,t){let r=ee(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function gV(n,e){let t=ee(n);t.onlineState=e;let r=!1;t.queries.forEach((i,s)=>{for(let o of s.listeners)o.applyOnlineStateChange(e)&&(r=!0)}),r&&yy(t)}function yV(n,e){let t=ee(n),r=t.queries;t.queries=Fw(),r.forEach((i,s)=>{for(let o of s.listeners)o.onError(e)})}function yy(n){n.snapshotsInSyncListeners.forEach(e=>{e.next()})}var Lw=function(n){return n.Default="default",n.Cache="cache",n}(Lw||{}),Pg=class{constructor(e,t,r){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.snap=null,this.onlineState="Unknown",this.options=r||{}}onViewSnapshot(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Xs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.raisedInitialEvent?this.shouldRaiseEvent(e)&&(this.queryObserver.next(e),t=!0):this.shouldRaiseInitialEvent(e,this.onlineState)&&(this.raiseInitialEvent(e),t=!0),this.snap=e,t}onError(e){this.queryObserver.error(e)}applyOnlineStateChange(e){this.onlineState=e;let t=!1;return this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&(this.raiseInitialEvent(this.snap),t=!0),t}shouldRaiseInitialEvent(e,t){if(!e.fromCache||!this.listensToRemoteStore())return!0;let r=t!=="Offline";return this.options.waitForSyncWhenOnline&&r?!1:!e.docs.isEmpty()||e.hasCachedResults||t==="Offline"}shouldRaiseEvent(e){if(e.docChanges.length>0)return!0;let t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return e.syncStateChanged||t?this.options.includeMetadataChanges===!0:!1}raiseInitialEvent(e){e=Xs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.raisedInitialEvent=!0,this.queryObserver.next(e)}listensToRemoteStore(){return this.options.source!==Lw.Cache}};var Ng=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=i}static fromSnapshot(e,t){let r=se(),i=se();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key);break}return new n(e,t.fromCache,r,i)}};var Mu=class{constructor(e){this.key=e}},Pu=class{constructor(e){this.key=e}},Fg=class{constructor(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.hasCachedResults=!1,this.current=!1,this.limboDocuments=se(),this.mutatedKeys=se(),this.docComparator=iw(e),this.documentSet=new ku(this.docComparator)}get syncedDocuments(){return this._syncedDocuments}computeDocChanges(e,t){let r=t?t.changeSet:new Ou,i=t?t.documentSet:this.documentSet,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,p)=>{let g=i.get(u),C=$u(this.query,p)?p:null,A=g?this.mutatedKeys.has(g.key):!1,I=C?C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations:!1,T=!1;g&&C?g.data.isEqual(C.data)?A!==I&&(r.track({type:3,doc:C}),T=!0):this.shouldWaitForSyncedDocument(g,C)||(r.track({type:2,doc:C}),T=!0,(l&&this.docComparator(C,l)>0||c&&this.docComparator(C,c)<0)&&(a=!0)):!g&&C?(r.track({type:0,doc:C}),T=!0):g&&!C&&(r.track({type:1,doc:g}),T=!0,(l||c)&&(a=!0)),T&&(C?(o=o.add(C),I?s=s.add(u):s=s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{documentSet:o,changeSet:r,needsRefill:a,mutatedKeys:s}}shouldWaitForSyncedDocument(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;let o=e.changeSet.getChanges();o.sort((p,g)=>vV(p.type,g.type)||this.docComparator(p.doc,g.doc)),this.applyTargetChange(r),i=i??!1;let a=t&&!i?this.updateLimboDocuments():[],c=this.limboDocuments.size===0&&this.current&&!i?1:0,u=c!==this.syncState;return this.syncState=c,o.length===0&&!u?{limboChanges:a}:{snapshot:new Xs(this.query,e.documentSet,s,o,e.mutatedKeys,c===0,u,!1,r?r.resumeToken.approximateByteSize()>0:!1),limboChanges:a}}applyOnlineStateChange(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Ou,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}}shouldBeInLimbo(e){return!(this._syncedDocuments.has(e)||!this.documentSet.has(e)||this.documentSet.get(e).hasLocalMutations)}applyTargetChange(e){e&&(e.addedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._syncedDocuments=this._syncedDocuments.delete(t)),this.current=e.current)}updateLimboDocuments(){if(!this.current)return[];let e=this.limboDocuments;this.limboDocuments=se(),this.documentSet.forEach(r=>{this.shouldBeInLimbo(r.key)&&(this.limboDocuments=this.limboDocuments.add(r.key))});let t=[];return e.forEach(r=>{this.limboDocuments.has(r)||t.push(new Pu(r))}),this.limboDocuments.forEach(r=>{e.has(r)||t.push(new Mu(r))}),t}synchronizeWithPersistedState(e){this._syncedDocuments=e.remoteKeys,this.limboDocuments=se();let t=this.computeDocChanges(e.documents);return this.applyChanges(t,!0)}computeInitialSnapshot(){return Xs.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===0,this.hasCachedResults)}};function vV(n,e){let t=r=>{switch(r){case 0:return 1;case 2:return 2;case 3:return 2;case 1:return 0;default:return J()}};return t(n)-t(e)}var vy="SyncEngine",Lg=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Vg=class{constructor(e){this.key=e,this.receivedDocument=!1}},Bg=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.syncEngineListener={},this.queryViewsByQuery=new Xr(a=>rw(a),Gu),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new Le(Y.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new Ia,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=Aa.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return this._isPrimaryClient===!0}};function _V(n,e,t,r,i,s,o){let a=new Bg(n,e,t,r,i,s);return o&&(a._isPrimaryClient=!0),a}function CV(n,e,t=!0){return R(this,null,function*(){let r=Gw(n),i,s=r.queryViewsByQuery.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.computeInitialSnapshot()):i=yield Vw(r,e,t,!0),i})}function SV(n,e){return R(this,null,function*(){let t=Gw(n);yield Vw(t,e,!0,!1)})}function Vw(n,e,t,r){return R(this,null,function*(){let i=yield CL(n.localStore,jn(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=yield bV(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Rw(n.remoteStore,i),a})}function bV(n,e,t,r,i){return R(this,null,function*(){n.applyDocChanges=(p,g,C)=>OV(n,p,g,C);let s=yield Dw(n.localStore,e,!0),o=new Fg(e,s.remoteKeys),a=o.computeDocChanges(s.documents),l=wa.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);jw(n,t,c.limboChanges);let u=new Lg(e,t,o);return n.queryViewsByQuery.set(e,u),n.queriesByTarget.has(t)?n.queriesByTarget.get(t).push(e):n.queriesByTarget.set(t,[e]),c.snapshot})}function EV(n,e,t){return R(this,null,function*(){let r=ee(n),i=r.queryViewsByQuery.get(e),s=r.queriesByTarget.get(i.targetId);if(s.length>1){r.queriesByTarget.set(i.targetId,s.filter(o=>!Gu(o,e))),r.queryViewsByQuery.delete(e);return}r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield vg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&hy(r.remoteStore,i.targetId),Ug(r,i.targetId)}).catch(Pa))):(Ug(r,i.targetId),yield vg(r.localStore,i.targetId,!0))})}function wV(n,e){return R(this,null,function*(){let t=ee(n),r=t.queryViewsByQuery.get(e),i=t.queriesByTarget.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),hy(t.remoteStore,r.targetId))})}function TV(n,e,t){return R(this,null,function*(){let r=NV(n);try{let i=yield dL(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),RV(r,i.batchId,t),yield La(r,i.changes),yield Qu(r.remoteStore)}catch(i){let s=gy(i,"Failed to persist write");t.reject(s)}})}function Bw(n,e){return R(this,null,function*(){let t=ee(n);try{let r=yield mL(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.activeLimboResolutionsByTarget.get(s);o&&(ge(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.receivedDocument=!0:i.modifiedDocuments.size>0?ge(o.receivedDocument):i.removedDocuments.size>0&&(ge(o.receivedDocument),o.receivedDocument=!1))}),yield La(t,r,e)}catch(r){yield Pa(r)}})}function hE(n,e,t){let r=ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.queryViewsByQuery.forEach((s,o)=>{let a=o.view.applyOnlineStateChange(e);a.snapshot&&i.push(a.snapshot)}),gV(r.eventManager,e),i.length&&r.syncEngineListener.onWatchChange(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function AV(n,e,t){return R(this,null,function*(){let r=ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.activeLimboResolutionsByTarget.get(e),s=i&&i.key;if(s){let o=new Le(Y.comparator);o=o.insert(s,pn.newNoDocument(s,te.min()));let a=se().add(s),l=new Su(te.min(),new Map,new Le(de),o,a);yield Bw(r,l),r.activeLimboTargetsByKey=r.activeLimboTargetsByKey.remove(s),r.activeLimboResolutionsByTarget.delete(e),_y(r)}else yield vg(r.localStore,e,!1).then(()=>Ug(r,e,t)).catch(Pa)})}function IV(n,e){return R(this,null,function*(){let t=ee(n),r=e.batch.batchId;try{let i=yield hL(t.localStore,e);qw(t,r,null),Uw(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield La(t,i)}catch(i){yield Pa(i)}})}function DV(n,e,t){return R(this,null,function*(){let r=ee(n);try{let i=yield pL(r.localStore,e);qw(r,e,t),Uw(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield La(r,i)}catch(i){yield Pa(i)}})}function Uw(n,e){(n.pendingWritesCallbacks.get(e)||[]).forEach(t=>{t.resolve()}),n.pendingWritesCallbacks.delete(e)}function xV(n,e){n.pendingWritesCallbacks.forEach(t=>{t.forEach(r=>{r.reject(new G(k.CANCELLED,e))})}),n.pendingWritesCallbacks.clear()}function RV(n,e,t){let r=n.mutationUserCallbacks[n.currentUser.toKey()];r||(r=new Le(de)),r=r.insert(e,t),n.mutationUserCallbacks[n.currentUser.toKey()]=r}function qw(n,e,t){let r=ee(n),i=r.mutationUserCallbacks[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.mutationUserCallbacks[r.currentUser.toKey()]=i}}function Ug(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.queriesByTarget.get(e))n.queryViewsByQuery.delete(r),t&&n.syncEngineListener.onWatchError(r,t);n.queriesByTarget.delete(e),n.isPrimaryClient&&n.limboDocumentRefs.removeReferencesForId(e).forEach(i=>{n.limboDocumentRefs.containsKey(i)||zw(n,i)})}function zw(n,e){n.enqueuedLimboResolutions.delete(e.path.canonicalString());let t=n.activeLimboTargetsByKey.get(e);t!==null&&(hy(n.remoteStore,t),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.remove(e),n.activeLimboResolutionsByTarget.delete(t),_y(n))}function jw(n,e,t){for(let r of t)r instanceof Mu?(n.limboDocumentRefs.addReference(r.key,e),kV(n,r)):r instanceof Pu?(H(vy,"Document no longer in limbo: "+r.key),n.limboDocumentRefs.removeReference(r.key,e),n.limboDocumentRefs.containsKey(r.key)||zw(n,r.key)):J()}function kV(n,e){let t=e.key,r=t.path.canonicalString();!n.activeLimboTargetsByKey.get(t)&&!n.enqueuedLimboResolutions.has(r)&&(H(vy,"New document in limbo: "+t),n.enqueuedLimboResolutions.add(r),_y(n))}function _y(n){for(;n.enqueuedLimboResolutions.size>0&&n.activeLimboTargetsByKey.size<n.maxConcurrentLimboResolutions;){let e=n.enqueuedLimboResolutions.values().next().value;n.enqueuedLimboResolutions.delete(e);let t=new Y(Me.fromString(e)),r=n.limboTargetIdGenerator.next();n.activeLimboResolutionsByTarget.set(r,new Vg(t)),n.activeLimboTargetsByKey=n.activeLimboTargetsByKey.insert(t,r),Rw(n.remoteStore,new Ta(jn(ay(t.path)),r,"TargetPurposeLimboResolution",AE.INVALID))}}function La(n,e,t){return R(this,null,function*(){let r=ee(n),i=[],s=[],o=[];r.queryViewsByQuery.isEmpty()||(r.queryViewsByQuery.forEach((a,l)=>{o.push(r.applyDocChanges(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){let p=c?!c.fromCache:(u=t?.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(c){i.push(c);let p=Ng.fromSnapshot(l.targetId,c);s.push(p)}}))}),yield Promise.all(o),r.syncEngineListener.onWatchChange(i),yield vL(r.localStore,s))})}function OV(n,e,t,r){return R(this,null,function*(){let i=e.view.computeDocChanges(t);i.needsRefill&&(i=yield Dw(n.localStore,e.query,!1).then(({documents:l})=>e.view.computeDocChanges(l,i)));let s=r&&r.targetChanges.get(e.targetId),o=r&&r.targetMismatches.get(e.targetId)!=null,a=e.view.applyChanges(i,n.isPrimaryClient,s,o);return jw(n,e.targetId,a.limboChanges),a.snapshot})}function MV(n,e){return R(this,null,function*(){let t=ee(n);if(!t.currentUser.isEqual(e)){H(vy,"User change. New user:",e.toKey());let i=yield Aw(t.localStore,e);t.currentUser=e,xV(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield La(t,i.affectedDocuments)}})}function PV(n,e){let t=ee(n),r=t.activeLimboResolutionsByTarget.get(e);if(r&&r.receivedDocument)return se().add(r.key);{let i=se(),s=t.queriesByTarget.get(e);if(!s)return i;for(let o of s){let a=t.queryViewsByQuery.get(o);i=i.unionWith(a.view.syncedDocuments)}return i}}function Gw(n){let e=ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AV.bind(null,e),e.syncEngineListener.onWatchChange=pV.bind(null,e.eventManager),e.syncEngineListener.onWatchError=mV.bind(null,e.eventManager),e}function NV(n){let e=ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DV.bind(null,e),e}var fE=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return R(this,null,function*(){this.serializer=Hu(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return uL(this.persistence,new Cg,t.initialUser,this.serializer)}createPersistence(t){return new pg(gg.factory,this.serializer)}createSharedClientState(t){return new Sg}terminate(){return R(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var FV=(()=>{class n{initialize(t,r){return R(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>hE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=MV.bind(null,this.syncEngine),yield cV(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return dV()}createDatastore(t){let r=Hu(t.databaseInfo.databaseId),i=PL(t.databaseInfo);return zL(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return HL(this.localStore,this.datastore,t.asyncQueue,r=>hE(this.syncEngine,r,0),NL())}createSyncEngine(t,r){return _V(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return R(this,null,function*(){var t,r;yield KL(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}n.provider={build:()=>new n};return n})();function $w(n,e,t){if(!t)throw new G(k.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function LV(n,e,t,r){if(e===!0&&r===!0)throw new G(k.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pE(n){if(!Y.isDocumentKey(n))throw new G(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mE(n){if(Y.isDocumentKey(n))throw new G(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VV(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Yu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=BV(n);return e?`a custom ${e} object`:"an object"}}else return typeof n=="function"?"a function":J()}function BV(n){return n.constructor?n.constructor.name:null}function ga(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new G(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Yu(n);throw new G(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var qg=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.scheduleEvent(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.scheduleEvent(this.observer.error,e):fn("Uncaught Error in snapshot listener:",e.toString()))}mute(){this.muted=!0}scheduleEvent(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Jr="FirestoreClient",UV=100,qV=11,zV=20,jV=22,zg=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=dt.UNAUTHENTICATED,this.clientId=gu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>R(this,null,function*(){H(Jr,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(H(Jr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:UV}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=gy(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function vm(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),H(Jr,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield Aw(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function gE(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield $V(n);H(Jr,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>dE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>dE(e.remoteStore,i)),n._onlineComponents=e})}function GV(n){return n.name==="FirebaseError"?n.code===k.FAILED_PRECONDITION||n.code===k.UNIMPLEMENTED:typeof DOMException<"u"&&n instanceof DOMException?n.code===jV||n.code===zV||n.code===qV:!0}function $V(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){H(Jr,"Using user provided OfflineComponentProvider");try{yield vm(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!GV(t))throw t;ha("Error using user provided cache. Falling back to memory cache: "+t),yield vm(n,new fE)}}else H(Jr,"Using default OfflineComponentProvider"),yield vm(n,new fE);return n._offlineComponents})}function Ww(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(H(Jr,"Using user provided OnlineComponentProvider"),yield gE(n,n._uninitializedComponentsProvider._online)):(H(Jr,"Using default OnlineComponentProvider"),yield gE(n,new FV))),n._onlineComponents})}function WV(n){return Ww(n).then(e=>e.syncEngine)}function yE(n){return R(this,null,function*(){let e=yield Ww(n),t=e.eventManager;return t.onListen=CV.bind(null,e.syncEngine),t.onUnlisten=EV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=SV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=wV.bind(null,e.syncEngine),t})}function HV(n,e,t,r){let i=new qg(r),s=new Pg(e,i,t);return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let o=yield yE(n);return hV(o,s)})),()=>{i.mute(),n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let o=yield yE(n);return fV(o,s)}))}}function KV(n,e){let t=new zn;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let r=yield WV(n);return TV(r,e,t)})),t.promise}function QV(n,e){return n.timeoutSeconds===e.timeoutSeconds}function Hw(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var YV="ComponentProvider",vE=new Map;function XV(n){let e=vE.get(n);e&&(H(YV,"Removing Datastore"),vE.delete(n),e.terminate())}function JV(n,e,t,r){return new Dm(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Hw(r.experimentalLongPollingOptions),r.useFetchStreams)}var ZV="firestore.googleapis.com",_E=!0,CE=5,SE=30,eB=!0,Nu=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ZV,this.ssl=_E}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:_E;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Tw;else{if(e.cacheSizeBytes!==ww&&e.cacheSizeBytes<aE)throw new G(k.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${aE}`);this.cacheSizeBytes=e.cacheSizeBytes}LV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=eB:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),tB(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&QV(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function tB(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new G(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<CE)throw new G(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is ${CE})`);if(n.timeoutSeconds>SE)throw new G(k.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is ${SE})`)}}var Da=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nu({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nu(e),e.credentials!==void 0&&(this._authCredentials=iN(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return R(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return XV(this),Promise.resolve()}};var Js=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Nt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Qr=class n extends Js{constructor(e,t,r){super(e,t,ay(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Y(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Kw(n,e,...t){if(n=Hn(n),$w("collection","path",e),n instanceof Da){let r=Me.fromString(e,...t);return mE(r),new Qr(n,null,r)}else{if(!(n instanceof Nt)&&!(n instanceof Qr))throw new G(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Me.fromString(e,...t));return mE(r),new Qr(n.firestore,null,r)}}function Cy(n,e,...t){if(n=Hn(n),arguments.length===1&&(e=gu.newId()),$w("doc","path",e),n instanceof Da){let r=Me.fromString(e,...t);return pE(r),new Nt(n,null,new Y(r))}else{if(!(n instanceof Nt)&&!(n instanceof Qr))throw new G(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Me.fromString(e,...t));return pE(r),new Nt(n.firestore,n instanceof Qr?n.converter:null,new Y(r))}}var nB="AsyncQueue",Fu=class{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new Du(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new zn;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return R(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(Na(e))H(nB,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(r=>{this.failure=r,this.operationInProgress=!1;let i=rB(r);throw fn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.operationInProgress=!1,r))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=kg.createAndSchedule(this,e,t,r,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&J()}verifyOperationInProgress(){}drain(){return R(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.delayedOperations)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}};function rB(n){let e=n.message||"";return n.stack&&(n.stack.includes(n.message)?e=n.stack:e=n.message+`
`+n.stack),e}var Ni=class extends Da{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Fu,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return R(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Fu(e),this._firestoreClient=void 0,yield e}})}};function Qw(n){if(n._terminated)throw new G(k.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||iB(n),n._firestoreClient}function iB(n){var e,t,r;let i=n._freezeSettings(),s=JV(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new zg(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&sB(n._componentsProvider))}function sB(n){let e=n?._online.build();return{_offline:n?._offline.build(e),_online:e}}function oB(n,e=!0){nN(dv),yo(new go("firestore",(t,{instanceIdentifier:r,options:i})=>{let s=t.getProvider("app").getImmediate(),o=new Ni(new Sm(t.getProvider("auth-internal")),new Tm(t.getProvider("app-check-internal")),MN(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),He(Ub,qb,n),He(Ub,qb,"esm2017")}var xa=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ht.fromBase64String(e))}catch(t){throw new G(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Ra=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new G(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Lu=class{constructor(e){this._methodName=e}};var ka=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new G(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new G(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return de(this._lat,e._lat)||de(this._long,e._long)}};var Oa=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return lL(this._values,e._values)}};var aB=/^__.*__$/,jg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new lr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mi(e,this.data,t,this.fieldTransforms)}};function Yw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J()}}var Gg=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.contextWith({path:r,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.contextWith({path:r,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Vu(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Yw(this.dataSource)&&aB.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},$g=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Hu(e)}createContext(e,t,r,i=!1){return new Gg({dataSource:e,methodName:t,targetDoc:r,path:Ft.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Xw(n){let e=n._freezeSettings(),t=Hu(n._databaseId);return new $g(n._databaseId,!!e.ignoreUndefinedProperties,t)}function lB(n,e,t,r,i,s={}){let o=n.createContext(s.merge||s.mergeFields?2:0,e,t,i);eT("Data must be an object, but it was:",o,r);let a=Jw(r,o),l,c;if(s.merge)l=new Un(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let u=[];for(let p of s.mergeFields){let g=pB(e,p,t);if(!o.contains(g))throw new G(k.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);gB(u,g)||u.push(g)}l=new Un(u),c=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,c=o.fieldTransforms;return new jg(new dn(a),l,c)}function cB(n,e,t,r=!1){let i=n.createContext(r?4:3,e);return Sy(t,i)}function Sy(n,e){if(n=Hn(n),Zw(n))return eT("Unsupported field value:",e,n),Jw(n,e);if(n instanceof Lu)return dB(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return uB(n,e)}else return hB(n,e)}function Jw(n,e){let t={};return UE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):to(n,(r,i)=>{let s=Sy(i,e.childContextForField(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function uB(n,e){let t=[],r=0;for(let i of n){let s=Sy(i,e.childContextForArray(r));s==null&&(s={nullValue:"NULL_VALUE"}),t.push(s),r++}return{arrayValue:{values:t}}}function dB(n,e){if(!Yw(e.dataSource))throw e.createError(`${n._methodName}() can only be used with update() and set()`);if(!e.path)throw e.createError(`${n._methodName}() is not currently supported inside arrays`);let t=n._toFieldTransform(e);t&&e.fieldTransforms.push(t)}function hB(n,e){if(n=Hn(n),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return RF(e.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let t=rt.fromDate(n);return{timestampValue:Tu(e.serializer,t)}}else if(n instanceof rt){let t=new rt(n.seconds,Math.floor(n.nanoseconds/1e3)*1e3);return{timestampValue:Tu(e.serializer,t)}}else{if(n instanceof ka)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xa)return{bytesValue:yw(e.serializer,n._byteString)};if(n instanceof Nt){let t=e.databaseId,r=n.firestore._databaseId;if(!r.isEqual(t))throw e.createError(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${t.projectId}/${t.database}`);return{referenceValue:uy(n.firestore._databaseId||e.databaseId,n._key.path)}}else{if(n instanceof Oa)return fB(n,e);throw e.createError(`Unsupported field value: ${Yu(n)}`)}}}function fB(n,e){return{mapValue:{fields:{[ty]:{stringValue:ny},[zs]:{arrayValue:{values:n.toArray().map(r=>{if(typeof r!="number")throw e.createError("VectorValues must only contain numeric values.");return cy(e.serializer,r)})}}}}}}function Zw(n){return typeof n=="object"&&n!==null&&!(n instanceof Array)&&!(n instanceof Date)&&!(n instanceof rt)&&!(n instanceof ka)&&!(n instanceof xa)&&!(n instanceof Nt)&&!(n instanceof Lu)&&!(n instanceof Oa)}function eT(n,e,t){if(!Zw(t)||!VV(t)){let r=Yu(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function pB(n,e,t){if(e=Hn(e),e instanceof Ra)return e._internalPath;if(typeof e=="string")return tT(n,e);throw Vu("Field path arguments must be of type string or ",n,!1,void 0,t)}var mB=new RegExp("[~\\*/\\[\\]]");function tT(n,e,t){if(e.search(mB)>=0)throw Vu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ra(...e.split("."))._internalPath}catch{throw Vu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Vu(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new G(k.INVALID_ARGUMENT,a+n+l)}function gB(n,e){return n.some(t=>t.isEqual(e))}var Bu=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document)if(this._converter){let e=new Wg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}else return this._userDataWriter.convertValue(this._document.data.value);else return}get(e){if(this._document){let t=this._document.data.field(by("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Wg=class extends Bu{data(){return super.data()}};function by(n,e){return typeof e=="string"?tT(n,e):e instanceof Ra?e._internalPath:e._delegate._internalPath}function yB(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new G(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ma=class{},Hg=class extends Ma{};function nT(n,e,...t){let r=[];e instanceof Ma&&r.push(e),r=r.concat(t),bB(r);for(let i of r)n=i._apply(n);return n}var Uu=class n extends Hg{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return iT(e._query,t),new Js(e.firestore,e.converter,ly(e._query,t))}_parse(e){let t=Xw(e.firestore);return vB(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function rT(n,e,t){let r=e,i=by("where",n);return Uu._create(i,r,t)}var Kg=class n extends Ma{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:mn.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(CB(e._query,t),new Js(e.firestore,e.converter,ly(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function vB(n,e,t,r,i,s,o){let a;if(i.isKeyField()){if(s==="array-contains"||s==="array-contains-any")throw new G(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if(s==="in"||s==="not-in"){EE(o,s);let c=[];for(let u of o)c.push(bE(r,n,u));a={arrayValue:{values:c}}}else a=bE(r,n,o)}else(s==="in"||s==="not-in"||s==="array-contains-any")&&EE(o,s),a=cB(t,e,o,s==="in"||s==="not-in");return $e.create(i,s,a)}function bE(n,e,t){if(t=Hn(t),typeof t=="string"){if(t==="")throw new G(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nw(e)&&t.indexOf("/")!==-1)throw new G(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Me.fromString(t));if(!Y.isDocumentKey(r))throw new G(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Kb(n,new Y(r))}else{if(t instanceof Nt)return Kb(n,t._key);throw new G(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yu(t)}.`)}}function EE(n,e){if(!Array.isArray(n)||n.length===0)throw new G(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _B(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}function iT(n,e){let t=SB(n.filters,_B(e.op));if(t!==null)throw t===e.op?new G(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function CB(n,e){let t=n,r=e.getFlattenedFilters();for(let i of r)iT(t,i),t=ly(t,i)}function SB(n,e){for(let t of n)for(let r of t.getFlattenedFilters())if(e.indexOf(r.op)>=0)return r.op;return null}function bB(n){let e=n.filter(r=>r instanceof Kg).length,t=n.filter(r=>r instanceof Uu).length;if(e>1||e>0&&t>0)throw new G(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}var Qg=class{convertValue(e,t="none"){switch(xi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw J()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return to(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[zs].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Re(o.doubleValue));return new Oa(s)}convertGeoPoint(e){return new ka(Re(e.latitude),Re(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Zg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(va(e));default:return null}}convertTimestamp(e){let t=or(e);return new rt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Me.fromString(e);ge(Ew(r));let i=new _u(r.get(1),r.get(3)),s=new Y(r.popFirst(5));return i.isEqual(t)||fn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function EB(n,e,t){let r;return n?t&&(t.merge||t.mergeFields)?r=n.toFirestore(e,t):r=n.toFirestore(e):r=e,r}function wE(n){return wB(n,["next","error","complete"])}function wB(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Fi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},qu=class extends Bu{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document)if(this._converter){let t=new Zs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}else return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);else return}get(e,t={}){if(this._document){let r=this._document.data.field(by("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Zs=class extends qu{data(e={}){return super.data(e)}},Yg=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Zs(this._firestore,this._userDataWriter,r.key,r,new Fi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new G(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return(!this._cachedChanges||this._cachedChangesIncludeMetadataChanges!==t)&&(this._cachedChanges=TB(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function TB(n,e){if(n._snapshot.oldDocs.isEmpty()){let t=0;return n._snapshot.docChanges.map(r=>{let i=new Zs(n._firestore,n._userDataWriter,r.doc.key,r.doc,new Fi(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}else{let t=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(r=>e||r.type!==3).map(r=>{let i=new Zs(n._firestore,n._userDataWriter,r.doc.key,r.doc,new Fi(n._snapshot.mutatedKeys.has(r.doc.key),n._snapshot.fromCache),n.query.converter),s=-1,o=-1;return r.type!==0&&(s=t.indexOf(r.doc.key),t=t.delete(r.doc.key)),r.type!==1&&(t=t.add(r.doc),o=t.indexOf(r.doc.key)),{type:AB(r.type),doc:i,oldIndex:s,newIndex:o}})}}function AB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J()}}var zu=class extends Qg{constructor(e){super(),this.firestore=e}convertBytes(e){return new xa(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,t)}};function sT(n){let e=ga(n.firestore,Ni),t=[new Ea(n._key,Kr.none())];return aT(e,t)}function oT(n,e){let t=ga(n.firestore,Ni),r=Cy(n),i=EB(n.converter,e),s=Xw(n.firestore),a=lB(s,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Kr.exists(!1));return aT(t,[a]).then(()=>r)}function Ey(n,...e){var t,r,i;n=Hn(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]=="object"&&!wE(e[o])&&(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(wE(e[o])){let g=e[o];e[o]=(t=g.next)===null||t===void 0?void 0:t.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let l,c,u;if(n instanceof Nt)c=ga(n.firestore,Ni),u=ay(n._key.path),l={next:g=>{e[o]&&e[o](IB(c,n,g))},error:e[o+1],complete:e[o+2]};else{let g=ga(n,Js);c=ga(g.firestore,Ni),u=g._query;let C=new zu(c);l={next:A=>{e[o]&&e[o](new Yg(c,C,g,A))},error:e[o+1],complete:e[o+2]},yB(n._query)}let p=Qw(c);return HV(p,u,a,l)}function aT(n,e){let t=Qw(n);return KV(t,e)}function IB(n,e,t){let r=t.docs.get(e._key),i=new zu(n);return new qu(n,i,e._key,r,new Fi(t.hasPendingWrites,t.fromCache),e.converter)}oB("node");var Xu=function(){return Xu=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Xu.apply(this,arguments)};var RB={includeMetadataChanges:!1};function lT(n,e){return e===void 0&&(e=RB),new yn(function(t){var r=Ey(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function cT(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Xu(Xu({},r),(t={},t[e.idField]=n.id,t))}function uT(n){return lT(n,{includeMetadataChanges:!0}).pipe(Wn(function(e){return e.docs}))}function dT(n,e){return e===void 0&&(e={}),uT(n).pipe(Wn(function(t){return t.map(function(r){return cT(r,e)})}))}var ro=class{constructor(e){return e}},hT="firestore",wy=class{constructor(){return Do(hT)}};var fT=new Oe("angularfire2.firestore-instances");function kB(n,e){let t=gl(hT,n,e);return t&&new ro(t)}var OB={provide:wy,deps:[[new Vt,fT]]},MB={provide:ro,useFactory:kB,deps:[[new Vt,fT],Yn]},pT=(()=>{class n{constructor(){He("angularfire",bt.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Bt({type:n});static \u0275inj=Lt({providers:[MB,OB]})}return n})();var mT=nt(dT,!0);var gT=nt(oT,!0);var Ty=nt(Kw,!0);var yT=nt(sT,!0);var vT=nt(Cy,!0);var _T=nt(nT,!0);var CT=nt(rT,!0);var Ju=class{id;produit;qte=0;constructor(e,t){this.produit=e,this.qte=t}};var ei=(()=>{class n{productCartSubject=new ni([]);constructor(){}addProductToCart(t){let r=this.productCartSubject.getValue(),i=r.find(s=>s.produit.id===t.id);i?i.qte++:r.push(new Ju(t,1)),this.productCartSubject.next(r),console.log("Product added to cart:",r)}getAllCartProducts(){return this.productCartSubject.asObservable()}increaseQte(t){let r=this.productCartSubject.getValue(),i=r.find(s=>s.produit.id===t.id);i&&i.qte++,this.productCartSubject.next(r)}decreaseQte(t){let r=this.productCartSubject.getValue(),i=r.find(s=>s.produit.id===t.id);i&&(i.qte===1?this.removeProductFromCart(t):(i.qte--,this.productCartSubject.next(r)))}removeProductFromCart(t){let r=this.productCartSubject.getValue();r=r.filter(i=>i.produit.id!==t.id),this.productCartSubject.next(r)}removeAllProducts(){this.productCartSubject.getValue().forEach(r=>{this.removeProductFromCart(r.produit)})}static \u0275fac=function(r){return new(r||n)};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var io=(()=>{class n{panier;authService;orderSubject=new ni([]);constructor(t,r){this.panier=t,this.authService=r}fireStore=Ne(ro);allOrders=[];cart=[];createCommande(t,r){return R(this,null,function*(){let i=t.map(l=>({productId:l.produit.id,productName:l.produit.title,quantity:l.qte})),o={userid:yield this.authService.getUserId(),montant:r,dateCommande:new Date,details:i};console.log(o);let a=Ty(this.fireStore,"orders");yield gT(a,o).then(()=>console.log("Commande created successfully!",o)).catch(l=>console.error("Error creating commande:",l))})}getCurrentCart(){this.panier.getAllCartProducts().subscribe(t=>{this.cart=t})}deleteOrder(t){let r=vT(this.fireStore,"orders",t);yT(r).then(()=>console.log("data deleted !")).catch(i=>console.log(i))}getAllOrdersByUserId(){return Rt(this.authService.getUserId()).pipe(Jt(t=>{if(!t)return console.error("User ID is not available"),$n([]);let r=Ty(this.fireStore,"orders"),i=_T(r,CT("userid","==",t));return mT(i,{idField:"id"})}),zy(t=>(console.error("Error fetching orders:",t),$n([]))))}static \u0275fac=function(r){return new(r||n)(Se(ei),Se(Et))};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function PB(n,e){if(n&1&&(b(0,"tr")(1,"td",23)(2,"h3")(3,"a",24),w(4,"OrderID "),E(),b(5,"p",25),w(6),E()(),b(7,"p",25),w(8),E(),b(9,"p",25),w(10),E(),b(11,"div",18)(12,"a",26),j(13,"i",27),w(14," View Details"),E()()(),b(15,"td")(16,"span"),w(17," Status:"),E(),b(18,"h4"),w(19,"Not delivered Yet "),E()(),b(20,"td")(21,"span"),w(22,"Total:"),E(),b(23,"h4"),w(24),E()(),b(25,"td",28)(26,"button",20),j(27,"i",29),w(28," Track Order "),E()()()),n&2){let t=e.$implicit;V(6),le("",t.id," "),V(2),le("Placed on: ",t.dateCommande,""),V(2),le("Items: ",t.details.length,""),V(14),We(t.montant)}}var bT=(()=>{class n{orderService;route;userOrders=[];constructor(t,r){this.orderService=t,this.route=r}ngOnInit(){this.orderService.getAllOrdersByUserId().subscribe(t=>{this.userOrders=t.map(r=>xt(mt({},r),{dateCommande:r.dateCommande?r.dateCommande.toDate():null}))})}calculateTotal(t){return t.productCart.reduce((r,i)=>r+i.qte*i.produit.price,0)}continueShopping(){this.route.navigate(["/products"])}static \u0275fac=function(r){return new(r||n)(Q(io),Q(Ye))};static \u0275cmp=ve({type:n,selectors:[["app-myorders"]],standalone:!0,features:[_e],decls:45,vars:3,consts:[[1,"container"],[1,"wrapper","wrapper-content","animated","fadeInRight"],[1,"row"],[1,"col-md-9"],[1,"ibox"],[1,"ibox-title"],[1,"pull-right"],[1,"ibox-content"],[1,"table-responsive"],[1,"table","shoping-cart-table"],[4,"ngFor","ngForOf"],[1,"btn","btn-white"],[1,"fa","fa-arrow-left"],[1,"btn","btn-white","pull-right"],[1,"fa","fa-arrow-right"],[1,"col-md-3"],[1,"font-bold"],[1,"text-muted","small"],[1,"m-t-sm"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",2,"background-color","#b8fc04","border-width","0px","border-radius","6px"],[1,"fa","fa-list"],[1,"ok",2,"height","30vh"],[1,"desc"],[1,"text-navy"],[1,"small"],[1,"text-muted"],[1,"fa","fa-eye"],["width","150"],[1,"fa","fa-truck"]],template:function(r,i){r&1&&(b(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),w(7,"("),b(8,"strong"),w(9),E(),w(10,") Mes Commandes : "),E(),b(11,"h5"),w(12,"Order History"),E()(),b(13,"div",7)(14,"div",8)(15,"table",9)(16,"tbody"),we(17,PB,29,4,"tr",10),E()()()(),b(18,"div",7)(19,"button",11),j(20,"i",12),w(21," Previous "),E(),b(22,"button",13),w(23," Next "),j(24,"i",14),E()()()(),b(25,"div",15)(26,"div",4)(27,"div",5)(28,"h5"),w(29,"Summary"),E()(),b(30,"div",7)(31,"span"),w(32,"Total Orders:"),E(),b(33,"h2",16),w(34),E(),j(35,"hr"),b(36,"span",17),w(37," Review your order history "),E(),b(38,"div",18)(39,"div",19)(40,"button",20),j(41,"i",21),w(42," View All Orders"),E()()()()()()()()(),j(43,"div",22)(44,"app-footer")),r&2&&(V(9),We(i.userOrders.length),V(8),ie("ngForOf",i.userOrders),V(17),We(i.userOrders.length))},dependencies:[St,_r]})}return n})();var ET=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-root"]],standalone:!0,features:[_e],decls:2,vars:0,consts:[[2,"margin-top","7rem"]],template:function(r,i){r&1&&j(0,"app-navbar")(1,"router-outlet",0)},dependencies:[sv,d0]})}return n})();var wT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-pagenotfound"]],standalone:!0,features:[_e],decls:4,vars:0,consts:[["routerLink","/","routerLinkActive","active"]],template:function(r,i){r&1&&(b(0,"p"),w(1," Go BACK HOME "),E(),b(2,"button",0),w(3,` Home
`),E())},dependencies:[Cn,Ut,Sn]})}return n})();var NB=()=>[1,2,3,4,5],FB=(n,e)=>({"fa-star":n,"fa-star-o":e});function LB(n,e){if(n&1&&j(0,"i",9),n&2){let t=e.$implicit,r=Ie();ie("ngClass",Ga(1,FB,t<=r.product.rating,t>r.product.rating))}}function VB(n,e){if(n&1){let t=en();b(0,"div")(1,"button",10),he("click",function(){gt(t);let i=Ie();return yt(i.AddtoCart())}),w(2,"Ajouter au panier"),E()()}}function BB(n,e){n&1&&(b(0,"div"),w(1," Non Disponible "),E())}var TT=(()=>{class n{panier;route;product;constructor(t,r){this.panier=t,this.route=r}AddtoCart(){this.panier.addProductToCart(this.product)}goToProductDetails(t){this.route.navigate(["/product",t])}static \u0275fac=function(r){return new(r||n)(Q(ei),Q(Ye))};static \u0275cmp=ve({type:n,selectors:[["app-productitem"]],inputs:{product:"product"},standalone:!0,features:[_e],decls:14,vars:8,consts:[[1,"product-card"],[1,"card-img-top",3,"click","src"],[1,"card-body"],[1,"card-title"],[3,"click"],["class","fa","style","color: rgb(240, 255, 71);",3,"ngClass",4,"ngFor","ngForOf"],[1,"card-text"],[1,"card-footer"],[4,"ngIf"],[1,"fa",2,"color","rgb(240, 255, 71)",3,"ngClass"],[1,"btn","btn-primary",3,"click"]],template:function(r,i){r&1&&(b(0,"div",0)(1,"img",1),he("click",function(){return i.goToProductDetails(i.product.id)}),E(),b(2,"div",2)(3,"h5",3)(4,"a",4),he("click",function(){return i.goToProductDetails(i.product.id)}),w(5),E()(),we(6,LB,1,4,"i",5),b(7,"p",6),w(8),E(),b(9,"p",6),w(10),E()(),b(11,"div",7),we(12,VB,3,0,"div",8)(13,BB,2,0,"div",8),E()()),r&2&&(V(),ie("src",i.product.images[0],dr),V(4),le(" ",i.product.title," "),V(),ie("ngForOf",ja(7,NB)),V(2),le("Price: ",i.product.price," USD"),V(2),We(i.product.description),V(2),ie("ngIf",i.product.stock>0),V(),ie("ngIf",i.product.stock==0))},dependencies:[fr,$a,St],styles:[".container[_ngcontent-%COMP%]{margin-top:20px}.product-card[_ngcontent-%COMP%]{width:220px;height:400px;margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;border-radius:10px;transition:transform .3s ease,box-shadow .3s ease}.product-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 15px #00000026;transform:translateY(-5px)}.product-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:150px;object-fit:cover;border-radius:10px 10px 0 0;transition:transform .3s ease}.product-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.card-body[_ngcontent-%COMP%]{background-color:transparent;padding:15px;max-height:200px;overflow-y:auto;-ms-overflow-style:none;scrollbar-width:none}[_ngcontent-%COMP%]:scope::-webkit-scrollbar{display:none}:is()   .card-title[_ngcontent-%COMP%]{font-weight:700;color:#4bc305;margin-bottom:10px}:is()   .card-text[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:10px;flex-grow:1}.card-footer[_ngcontent-%COMP%]{background-color:transparent;text-align:center;padding:10px 0;color:red;text-decoration:line-through}.card-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background-color:#000;border:none;border-radius:30px;color:#fff;padding:8px 15px;font-size:18px;transition:background-color .3s ease}.card-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{background-color:#4dff00ec}.card-title[_ngcontent-%COMP%]{color:#0f0f11ec}"]})}return n})();function UB(n,e){if(n&1&&(b(0,"div",5),j(1,"app-productitem",6),E()),n&2){let t=e.$implicit;V(),ie("product",t)}}function qB(n,e){if(n&1&&(b(0,"div")(1,"div",3),we(2,UB,2,1,"div",4),E()()),n&2){let t=Ie();V(2),ie("ngForOf",t.filtredproducts)}}function zB(n,e){n&1&&(b(0,"div",0)(1,"div",7),j(2,"img",8),b(3,"h3"),w(4,"We are sorry "),E(),b(5,"h5"),w(6,"What are you Looking for is not Available "),E(),b(7,"h5"),w(8,"You can Always search again "),E()()())}var AT=(()=>{class n{productsService;searchService;route;filtredproducts=[];constructor(t,r,i){this.productsService=t,this.searchService=r,this.route=i}ngOnInit(){qa([this.searchService.searchTerm$,this.searchService.category$]).subscribe(([t,r])=>{t||r?this.searchService.searchProducts(t,r).subscribe(i=>{this.filtredproducts=i.products}):this.productsService.getProducts().subscribe(i=>{this.filtredproducts=i.products})})}static \u0275fac=function(r){return new(r||n)(Q(Qi),Q(Yi),Q(Ye))};static \u0275cmp=ve({type:n,selectors:[["app-listproducts"]],standalone:!0,features:[_e],decls:4,vars:2,consts:[[1,"container"],[4,"ngIf"],["class","container",4,"ngIf"],[1,"row"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[3,"product"],[1,"not-avaliable"],["src","unv.png"]],template:function(r,i){r&1&&(b(0,"div",0),we(1,qB,3,1,"div",1),E(),we(2,zB,9,0,"div",2),j(3,"app-footer")),r&2&&(V(),ie("ngIf",i.filtredproducts.length>0),V(),ie("ngIf",i.filtredproducts.length==0))},dependencies:[TT,Zy,St,fr,_r],styles:[".not-avaliable[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.not-avaliable[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;height:200px;border-radius:50%}.not-avaliable[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .not-avaliable[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:#333;margin:10px 0}"]})}return n})();function jB(n,e){if(n&1){let t=en();b(0,"div",3)(1,"h2"),w(2,"Your UNIVERSO Cart is Empty"),E(),b(3,"div"),j(4,"i",4),E(),b(5,"div",5)(6,"button",6),he("click",function(){gt(t);let i=Ie();return yt(i.continueShopping())}),w(7,"Shop now"),E()()()}}function GB(n,e){if(n&1){let t=en();b(0,"tr")(1,"td",31)(2,"div",32),j(3,"img",33),E()(),b(4,"td",34)(5,"h3")(6,"a",35),w(7),E()(),b(8,"p",36),w(9),E(),b(10,"div",25)(11,"a",37),he("click",function(){let i=gt(t).$implicit,s=Ie(2);return yt(s.deleteProduct(i.produit))}),j(12,"i",38),w(13," Remove item"),E()()(),b(14,"td"),w(15),b(16,"s",39),w(17),E()(),b(18,"td",40)(19,"input",41),fo("ngModelChange",function(i){let s=gt(t).$implicit;return ho(s.qte,i)||(s.qte=i),yt(i)}),E()(),b(20,"td")(21,"h4"),w(22),E()()()}if(n&2){let t=e.$implicit;V(3),qi("alt",t.produit.title),ie("src",t.produit.images[0],dr),V(4),We(t.produit.title),V(2),We(t.produit.description),V(6),le(" ",t.produit.price," "),V(2),We(t.produit.price+t.produit.price*32/100),V(2),uo("ngModel",t.qte),V(3),We(t.produit.price*t.qte)}}function $B(n,e){if(n&1){let t=en();b(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12)(6,"span",13),w(7,"("),b(8,"strong"),w(9),E(),w(10,") item "),E(),b(11,"h5"),w(12,"UNIVERSO Carte "),E()(),b(13,"div",14)(14,"div",15)(15,"table",16)(16,"tbody"),we(17,GB,23,8,"tr",17),E()()()(),b(18,"div",14)(19,"button",18),he("click",function(){gt(t);let i=Ie();return yt(i.Acheter())}),j(20,"i",19),w(21," Acheter "),E(),b(22,"button",20),he("click",function(){gt(t);let i=Ie();return yt(i.continueShopping())}),j(23,"i",21),w(24," Continue l'achat "),E()()()(),b(25,"div",22)(26,"div",11)(27,"div",12)(28,"h5"),w(29,"Cart Summary"),E()(),b(30,"div",14)(31,"span"),w(32,"Total"),E(),b(33,"h2",23),w(34),E(),j(35,"hr")(36,"span",24),b(37,"div",25)(38,"div",26)(39,"button",27),he("click",function(){gt(t);let i=Ie();return yt(i.Acheter())}),j(40,"i",28),w(41,"Acheter "),E(),b(42,"button",29),he("click",function(){gt(t);let i=Ie();return yt(i.cancel())}),j(43,"i",30),w(44," Cancel "),E()()()()()()()()()}if(n&2){let t=Ie();V(9),We(t.productCart.length),V(8),ie("ngForOf",t.productCart),V(17),We(t.calculateTotal())}}var IT=(()=>{class n{panier;route;orderservice;authService;productCart=[];constructor(t,r,i,s){this.panier=t,this.route=r,this.orderservice=i,this.authService=s}ngOnInit(){this.panier.getAllCartProducts().subscribe(t=>{this.productCart=t})}increaseQte(t){this.panier.increaseQte(t)}decreaseQte(t){this.panier.decreaseQte(t)}deleteProduct(t){this.panier.removeProductFromCart(t)}calculateTotal(){return this.productCart.reduce((t,r)=>t+r.qte*r.produit.price,0)}cancel(){this.productCart=[]}Acheter(){this.authService.currentUserSig()?confirm("Vous voulez continuer ?")&&(this.orderservice.createCommande(this.productCart,this.calculateTotal()),this.route.navigateByUrl("/orders"),this.productCart=[],this.panier.removeAllProducts()):(alert("Se Conncter D'abord "),this.route.navigateByUrl("/signin"))}continueShopping(){this.route.navigate(["/products"])}static \u0275fac=function(r){return new(r||n)(Q(ei),Q(Ye),Q(io),Q(Et))};static \u0275cmp=ve({type:n,selectors:[["app-panier"]],standalone:!0,features:[_e],decls:4,vars:2,consts:[["href",Wy`https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css`,"rel","stylesheet"],["class","empty-cart-container",4,"ngIf"],["class","container",4,"ngIf"],[1,"empty-cart-container"],[1,"fa-solid","fa-cart-shopping"],[1,"continueShopping"],[1,"btn","btn-primary",3,"click"],[1,"container"],[1,"wrapper","wrapper-content","animated","fadeInRight"],[1,"row"],[1,"col-md-9"],[1,"ibox"],[1,"ibox-title"],[1,"pull-right"],[1,"ibox-content"],[1,"table-responsive"],[1,"table","shoping-cart-table"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","pull-right",2,"background-color","#b8fc04","border-width","0px","border-radius","6px",3,"click"],[1,"fa","fa","fa-shopping-cart"],[1,"btn","btn-white",3,"click"],[1,"fa","fa-arrow-left"],[1,"col-md-3"],[1,"font-bold"],[1,"text-muted","small"],[1,"m-t-sm"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm",2,"background-color","#b8fc04","border-width","0px","border-radius","6px",3,"click"],[1,"fa","fa-shopping-cart"],[1,"btn","btn-white","btn-sm",3,"click"],[1,"fa","fa-times"],["width","90"],[1,"cart-product-imitation"],[3,"src","alt"],[1,"desc"],["href","#",1,"text-navy"],[1,"small"],[1,"text-muted","btn","btn-outline",3,"click"],[1,"fa","fa-trash"],[1,"small","text-muted"],["width","65"],["type","number","min","1",1,"form-control",3,"ngModelChange","ngModel"]],template:function(r,i){r&1&&(j(0,"link",0),we(1,jB,8,0,"div",1)(2,$B,45,3,"div",2),j(3,"app-footer")),r&2&&(V(),ie("ngIf",i.productCart.length==0),V(),ie("ngIf",i.productCart.length>0))},dependencies:[St,fr,Wi,bn,Nd,yr,Fd,wo,_r],styles:["body[_ngcontent-%COMP%]{margin-top:20px;background:#eee}h3[_ngcontent-%COMP%]{font-size:16px}.text-navy[_ngcontent-%COMP%]{color:#1ab394}.cart-product-imitation[_ngcontent-%COMP%]{text-align:center;padding-top:30px;height:80px;width:80px;background-color:#f8f8f9}.cart-product-imitation[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:80px;object-fit:contain;display:block}.product-imitation.xl[_ngcontent-%COMP%]{padding:120px 0}.product-desc[_ngcontent-%COMP%]{padding:20px;position:relative}.ecommerce[_ngcontent-%COMP%]   .tag-list[_ngcontent-%COMP%]{padding:0}.ecommerce[_ngcontent-%COMP%]   .fa-star[_ngcontent-%COMP%]{color:#d1dade}.ecommerce[_ngcontent-%COMP%]   .fa-star.active[_ngcontent-%COMP%]{color:#f8ac59}.ecommerce[_ngcontent-%COMP%]   .note-editor[_ngcontent-%COMP%]{border:1px solid #e7eaec}table.shoping-cart-table[_ngcontent-%COMP%]{margin-bottom:0}table.shoping-cart-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;text-align:right}table.shoping-cart-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.desc[_ngcontent-%COMP%], table.shoping-cart-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{text-align:left}table.shoping-cart-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{width:80px}.ibox[_ngcontent-%COMP%]{clear:both;margin-bottom:25px;margin-top:0;padding:0}.ibox.collapsed[_ngcontent-%COMP%]   .ibox-content[_ngcontent-%COMP%]{display:none}.ibox[_ngcontent-%COMP%]:after, .ibox[_ngcontent-%COMP%]:before{display:table}.ibox-title[_ngcontent-%COMP%]{-moz-border-bottom-colors:none;-moz-border-left-colors:none;-moz-border-right-colors:none;-moz-border-top-colors:none;background-color:#fff;border-color:#e7eaec;border-image:none;border-style:solid solid none;border-width:3px 0 0;color:inherit;margin-bottom:0;padding:14px 15px 7px;min-height:48px}.empty-cart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:70vh;text-align:center;color:#333}.empty-cart-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:20px;color:#000}.empty-cart-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:5rem;color:#000;margin-bottom:20px}.continueShopping[_ngcontent-%COMP%]{margin-top:20px}.continueShopping[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#000;border-width:0px;border-radius:6px;padding:10px 20px;font-size:1.2rem;color:#fff;transition:background-color .3s ease;cursor:pointer}.continueShopping[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#5eff00}"]})}return n})();function WB(n,e){if(n&1&&(b(0,"div"),w(1),E()),n&2){let t=Ie();V(),le(" ",t.errorMessage," ")}}var DT=(()=>{class n{fb=Ne(hl);http=Ne(pr);router=Ne(Ye);authService=Ne(Et);form=this.fb.nonNullable.group({username:["",Qn.required],email:["",Qn.required],password:["",Qn.required]});errorMessage=null;onSubmit(){let t=this.form.getRawValue();this.authService.register(t.email,t.username,t.password).subscribe({next:()=>{this.router.navigateByUrl("/signin")},error:r=>{this.errorMessage=r.code}})}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-signup"]],standalone:!0,features:[_e],decls:34,vars:2,consts:[[1,"amazon-logo"],["src","unv.png","alt","Universo Logo"],[1,"sign-in-container"],[3,"ngSubmit","formGroup"],["for","name"],["type","text","id","name","name","name","formControlName","username","required",""],["for","email"],["type","text","id","email","name","email","formControlName","email","required",""],["for","password"],["type","password","id","password","name","password","formControlName","password","required",""],["type","submit"],["href","#"],["routerLink","/signin","routerLinkActive","active",1,"nav-link"],[1,"okk",2,"height","1vh"]],template:function(r,i){r&1&&(b(0,"div",0),j(1,"img",1),E(),b(2,"div",2)(3,"h2"),w(4,"Create account"),E(),we(5,WB,2,1,"div"),b(6,"form",3),he("ngSubmit",function(){return i.onSubmit()}),b(7,"label",4),w(8,"Your name"),E(),j(9,"input",5),b(10,"label",6),w(11,"Email"),E(),j(12,"input",7),b(13,"label",8),w(14,"Password"),E(),j(15,"input",9),b(16,"button",10),w(17,"Create your Universo account"),E()(),b(18,"p"),w(19,"By creating an account, you agree to Universo's "),b(20,"a",11),w(21,"Conditions of Use & Sale"),E(),w(22,". Please see our "),b(23,"a",11),w(24,"Privacy Notice"),E(),w(25,", and "),b(26,"a",11),w(27,"Cookies Notice"),E(),w(28,". "),E(),b(29,"p"),w(30,"Already have an account? "),b(31,"a",12),w(32,"Sign in"),E()()(),j(33,"div",13)),r&2&&(V(5),ai(i.errorMessage?5:-1),V(),ie("formGroup",i.form))},dependencies:[fl,ul,bn,yr,ol,Io,To,Ao,Ut,Cn,Sn],styles:[".sign-in-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding:30px;border:1px #000000;border-radius:15px;box-shadow:0 4px 10px #0000001a;text-align:center;background-color:#fff;position:relative}.amazon-logo[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:140px;opacity:.9;transition:opacity .3s ease}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:1}form[_ngcontent-%COMP%]{margin-bottom:16px;pad:10px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:700;font-size:14px;color:#000;text-align:left}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ccc;border-radius:3px;margin-bottom:10px;font-size:16px;background-color:#fff;transition:border-color .3s ease}button[_ngcontent-%COMP%]{padding:12px 25px;background-color:#b8fc04;color:#000;border:none;border-radius:5px;font-size:16px;cursor:pointer;transition:background-color .3s ease;width:100%}button[_ngcontent-%COMP%]:hover{background-color:#000}button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:focus{background-color:#000;outline:none}p[_ngcontent-%COMP%]{margin-bottom:15px;color:#666;font-size:14px}a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none;transition:color .3s ease}a[_ngcontent-%COMP%]:hover{color:#0056b3;text-decoration:underline}.sign-in-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#b8fc04}.sign-in-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child:hover{background-color:#b8fc04}@media (max-width: 500px){.sign-in-container[_ngcontent-%COMP%]{padding:20px}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px}button[_ngcontent-%COMP%]{padding:11px 2px;font-size:13px}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{padding:10px;font-size:14px}}.new[_ngcontent-%COMP%]{text-align:center}.sign-in-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000}"]})}return n})();function HB(n,e){if(n&1&&(b(0,"div"),w(1),E()),n&2){let t=Ie();V(),le(" ",t.errorMessage," ")}}var xT=(()=>{class n{fb=Ne(hl);http=Ne(pr);router=Ne(Ye);authService=Ne(Et);errorMessage=null;form=this.fb.nonNullable.group({email:["",Qn.required],password:["",Qn.required]});onSubmit(){let t=this.form.getRawValue();this.authService.login(t.email,t.password).subscribe({next:()=>{this.router.navigateByUrl("/")},error:r=>{this.errorMessage=r.code}})}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-signin"]],standalone:!0,features:[_e],decls:40,vars:2,consts:[[1,"amazon-logo"],["src","unv.png","alt","Universo Logo"],[1,"sign-in-container"],[3,"ngSubmit","formGroup"],["for","email"],["type","text","id","email","name","email","formControlName","email","required",""],["type","password","id","password","name","password","formControlName","password","required",""],["type","submit"],["href","#"],["routerLink","/signup","routerLinkActive","active"],[1,"okk",2,"height","1vh"],[1,"new"],[1,"okk",2,"height","0.1vh"],["id","okk",1,"sign-in-container"],[1,"okk",2,"height","10vh"]],template:function(r,i){r&1&&(b(0,"div",0),j(1,"img",1),E(),b(2,"div",2),we(3,HB,2,1,"div"),b(4,"h2"),w(5,"Sign in"),E(),b(6,"form",3),he("ngSubmit",function(){return i.onSubmit()}),b(7,"label",4),w(8,"Email "),E(),j(9,"input",5),b(10,"label",4),w(11,"Password "),E(),j(12,"input",6),b(13,"button",7),w(14,"Continue"),E()(),b(15,"p"),w(16,"By continuing, you agree to Universo's "),b(17,"a",8),w(18,"Conditions of Use & Sale"),E(),w(19,". Please see our "),b(20,"a",8),w(21,"Privacy Notice"),E(),w(22,", our "),b(23,"a",8),w(24,"Cookies Notice"),E(),w(25,". "),E(),b(26,"p")(27,"a",8),w(28,"Forget password ?"),E()(),b(29,"button",9),w(30,"Create your Universo account"),E()(),j(31,"div",10),b(32,"div",11)(33,"p"),w(34,"New to Universo?"),E()(),j(35,"div",12),b(36,"div",13)(37,"a",9),w(38," Create your account ? "),E()(),j(39,"div",14)),r&2&&(V(3),ai(i.errorMessage?3:-1),V(3),ie("formGroup",i.form))},dependencies:[fl,ul,bn,yr,ol,Io,To,Ao,Ut,Cn,Sn,Wi],styles:[".sign-in-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding:30px;border:1px #000000;border-radius:15px;box-shadow:0 4px 10px #0000001a;text-align:center;background-color:#fff;position:relative}.amazon-logo[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:140px;opacity:.9;transition:opacity .3s ease}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{opacity:1}form[_ngcontent-%COMP%]{margin-bottom:16px;pad:10px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:700;font-size:14px;color:#000;text-align:left}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ccc;border-radius:3px;margin-bottom:10px;font-size:16px;background-color:#fff;transition:border-color .3s ease}button[_ngcontent-%COMP%]{padding:12px 25px;background-color:#b8fc04;color:#000;border:none;border-radius:5px;font-size:16px;cursor:pointer;transition:background-color .3s ease;width:100%}button[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:active{background-color:#000}button[_ngcontent-%COMP%]:focus{outline:none}p[_ngcontent-%COMP%]{margin-bottom:15px;color:#666;font-size:14px}a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none;transition:color .3s ease}a[_ngcontent-%COMP%]:hover{color:#0056b3;text-decoration:underline}.sign-in-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#b8fc04}.sign-in-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child:hover{background-color:#b8fc04}.sign-in-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child:active{background-color:#b8fc04}@media (max-width: 500px){.sign-in-container[_ngcontent-%COMP%]{padding:20px}.amazon-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:120px}button[_ngcontent-%COMP%]{padding:11px 2px;font-size:13px}input[type=text][_ngcontent-%COMP%]{padding:10px;font-size:14px}}.new[_ngcontent-%COMP%]{text-align:center}.sign-in-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000}"]})}return n})();function KB(n,e){if(n&1){let t=en();b(0,"div",7)(1,"div",8)(2,"div",9)(3,"img",10),he("click",function(){let i=gt(t).$implicit,s=Ie();return yt(s.goTothisproducts(i.title))}),E()(),b(4,"div",11)(5,"h3",12),w(6),E()()()()}if(n&2){let t=e.$implicit;V(3),qi("alt",t.title),ie("src",t.src,dr),V(3),We(t.title)}}var RT=(()=>{class n{route;searchservice;constructor(t,r){this.route=t,this.searchservice=r}images=[{title:"sports-accessories",src:"basket.jpg",alt:"Sports Products"},{title:"beauty",src:"beauty.jpg",alt:"Beauty"},{title:"furniture",src:"frach.jpg",alt:"Furniture"},{title:"tablets",src:"tablet.jpg",alt:"Tablets"},{title:"Laptops",src:"pc.jpg",alt:"Laptops"},{title:"Clothing",src:"clothes.jpg",alt:"Clothing"},{title:"vehicle",src:"car.jpg",alt:"Cars"},{title:"motorcycle",src:"motor.jpg",alt:"motor"},{title:"Fragnances",src:"fragnances.jpg",alt:"Rway7"},{title:"groceries",src:"groceries.jpg",alt:"**"},{title:"home-decoration",src:"home-decoration.jpg",alt:"**"},{title:"kitchen-accessories",src:"kitchen-accessories.jpg",alt:"***"},{title:"mens-shirts",src:"mens-shirts.jpg",alt:"***"},{title:"mens-shoes",src:"mens-shoes.jpg",alt:"***"},{title:"mens-watches",src:"mens-watches.jpg",alt:"***"},{title:"mobile-accessories",src:"mobile-accesoires.jpg",alt:"***"},{title:"skin-care",src:"skin-care.jpg",alt:"***"},{title:"smartphones",src:"smart.jpg",alt:"***"},{title:"mens-shirts",src:"mens-shirts.jpg",alt:"***"},{title:"sunglasses",src:"sunglace.jpg",alt:"***"},{title:"womens-watches",src:"womems-watches.jpg",alt:"***"},{title:"women-bags",src:"women-bags.jpg",alt:"***"},{title:"women-jewellery",src:"women-jewelries.jpg",alt:"***"},{title:"women-shoes",src:"women-shoes.jpg",alt:"***"}];goTothisproducts(t){this.searchservice.setCategory(t),this.goToProducts()}goToProducts(){this.route.navigate(["/products"])}static \u0275fac=function(r){return new(r||n)(Q(Ye),Q(Yi))};static \u0275cmp=ve({type:n,selectors:[["app-home"]],standalone:!0,features:[_e],decls:18,vars:1,consts:[[1,"home-container"],[1,"banner"],[1,"shop-now-btn",3,"click"],[1,"container"],[1,"fa-solid","fa-down-long"],[1,"row"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"product-card"],[1,"image"],[1,"category-image",3,"click","src","alt"],[1,"card-body"],[1,"card-title"]],template:function(r,i){r&1&&(b(0,"div",0)(1,"div",1)(2,"h1"),w(3,"Welcome to Our Shop!"),E(),b(4,"p"),w(5,"Discover the best products at unbeatable prices"),E(),b(6,"button",2),he("click",function(){return i.goToProducts()}),w(7,"Shop Now"),E()(),b(8,"div",3)(9,"h2"),w(10,"Shop now"),j(11,"br"),w(12,"Delivery guy is next to your house"),j(13,"br")(14,"i",4),E(),b(15,"div",5),we(16,KB,7,3,"div",6),E()()(),j(17,"app-footer")),r&2&&(V(16),ie("ngForOf",i.images))},dependencies:[Ut,St,_r],styles:[".home-container[_ngcontent-%COMP%]{padding:20px;font-family:Arial,sans-serif}.banner[_ngcontent-%COMP%]{background-image:url(/banner.png);background-size:cover;background-position:center;color:#000;font-family:Courier New;text-align:center;padding:220px 20px;border-radius:10px}.banner[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:10px}.banner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:20px}.shop-now-btn[_ngcontent-%COMP%]{background-color:#000;color:#fff;border:none;padding:15px 30px;font-size:1.2rem;cursor:pointer;border-radius:5px;transition:background-color .3s}.shop-now-btn[_ngcontent-%COMP%]:hover{background-color:#59ff00}.container[_ngcontent-%COMP%]{margin-top:20px}.container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;font-family:Georgia,;font-size:30px}.product-card[_ngcontent-%COMP%]{width:220px;height:200px;margin:0 10px;display:flex;flex-direction:column;justify-content:space-between;border-radius:10px;transition:transform .3s ease,box-shadow .3s ease}.product-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 15px #00000026;transform:translateY(-5px)}.product-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;border-radius:10px;transition:transform .3s ease}.product-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05);border-radius:10px}.card-body[_ngcontent-%COMP%]{background-color:transparent;padding:15px;max-height:50px;overflow-y:auto;-ms-overflow-style:none;scrollbar-width:none}.card-body[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.card-title[_ngcontent-%COMP%]{font-weight:700;color:#fff;font-size:small;margin-bottom:3px}.card-text[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:10px;flex-grow:1}.card-footer[_ngcontent-%COMP%]{background-color:transparent;text-align:center;padding:10px 0;color:red;text-decoration:line-through;max-height:10px}.btn-primary[_ngcontent-%COMP%]{background-color:#000;border:none;border-radius:30px;color:#fff;padding:8px 15px;font-size:18px;transition:background-color .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#4dff00ec}.image[_ngcontent-%COMP%]{max-height:40px}"]})}return n})();var Ay=(n,e)=>{let t=Ne(Et),r=Ne(Ye);return t.currentUserSig()==null?(r.navigate(["/signin"]),!1):!0};var QB=()=>[1,2,3,4,5],YB=n=>({"out-of-stock":n}),XB=(n,e)=>({"fa-star":n,"fa-star-o":e});function JB(n,e){if(n&1&&j(0,"i",21),n&2){let t=e.$implicit,r=Ie();ie("ngClass",Ga(1,XB,t<=r.product.rating,t>r.product.rating))}}function ZB(n,e){if(n&1&&(b(0,"span",22),w(1),E()),n&2){let t=e.$implicit;V(),We(t)}}function e3(n,e){if(n&1&&(b(0,"div",23)(1,"div",24)(2,"div",25)(3,"span",26),w(4),E(),b(5,"span",27),w(6),E()(),b(7,"div",28)(8,"p"),w(9),E()(),b(10,"div",29)(11,"button"),w(12,"R\xE9pondre"),E(),b(13,"button"),w(14,"Signaler"),E()()()()),n&2){let t=e.$implicit;V(4),le("",t.reviewerName," "),V(2),le(" ",t.date," "),V(3),le(" ",t.comment," ")}}function t3(n,e){n&1&&(b(0,"p",30),w(1,"No reviews available for this product."),E())}var kT=(()=>{class n{route;productService;panier;product;reviews;constructor(t,r,i){this.route=t,this.productService=r,this.panier=i}ngOnInit(){let t=+this.route.snapshot.paramMap.get("id");this.productService.getProductById(t).subscribe(r=>{this.product=r,this.reviews=r.reviews})}addToCart(){this.panier.addProductToCart(this.product)}static \u0275fac=function(r){return new(r||n)(Q(iv),Q(Qi),Q(ei))};static \u0275cmp=ve({type:n,selectors:[["app-productdetails"]],standalone:!0,features:[_e],decls:56,vars:25,consts:[[1,"product-detail"],[1,"product-main"],[1,"product-image"],[3,"src","alt"],[1,"product-info"],[1,"product-title"],[1,"product-sku"],[1,"product-category","text-navy"],[1,"rating"],["class","fa",3,"ngClass",4,"ngFor","ngForOf"],[1,"product-price"],[1,"product-discount"],[1,"product-stock",3,"ngClass"],[1,"btn-add-to-cart",3,"click","disabled"],[1,"product-details"],["class","product-tag",4,"ngFor","ngForOf"],[1,"product-description"],[1,"product-reviews"],[1,"btn","btn-outline",2,"background-color","black","color","rgb(255, 255, 255)"],["class","review-item",4,"ngFor","ngForOf"],["class","no-reviews",4,"ngIf"],[1,"fa",3,"ngClass"],[1,"product-tag"],[1,"review-item"],[1,"comment"],[1,"comment-header"],[1,"author"],[1,"date"],[1,"comment-body"],[1,"comment-actions"],[1,"no-reviews"]],template:function(r,i){r&1&&(b(0,"div",0)(1,"div",1)(2,"div",2),j(3,"img",3),E(),b(4,"div",4)(5,"h1",5),w(6),E(),b(7,"p",6),w(8),E(),b(9,"p",7),w(10),E(),b(11,"div",8),w(12," Rating: "),we(13,JB,1,4,"i",9),w(14),E(),b(15,"p",10),w(16),E(),b(17,"p",11),w(18),E(),b(19,"p",12),w(20),E(),b(21,"button",13),he("click",function(){return i.addToCart()}),w(22," Add to Cart "),E()()(),b(23,"div",14)(24,"h2"),w(25,"Product Details"),E(),b(26,"p")(27,"strong"),w(28,"Brand:"),E(),w(29),E(),b(30,"p")(31,"strong"),w(32,"Tags:"),E(),we(33,ZB,2,1,"span",15),E(),b(34,"p")(35,"strong"),w(36,"Dimensions:"),E(),w(37),E(),b(38,"p")(39,"strong"),w(40,"Weight:"),E(),w(41),E(),b(42,"p")(43,"strong"),w(44,"Return Policy:"),E(),w(45),E(),b(46,"p",16),w(47),E()(),b(48,"div",14)(49,"div",17)(50,"h2"),w(51,"Customer Reviews"),E(),b(52,"button",18),w(53,"Commenter"),E(),we(54,e3,15,3,"div",19)(55,t3,2,0,"p",20),E()()()),r&2&&(V(3),qi("alt",i.product.title),ie("src",i.product.images[0],dr),V(3),We(i.product.title),V(2),le("SKU: ",i.product.sku,""),V(2),le("Category: ",i.product.category,""),V(3),ie("ngForOf",ja(22,QB)),V(),le(" (",i.product.rating," stars) "),V(2),le("Price: $",i.product.price.toFixed(2),""),V(2),le("Discount: ",i.product.discountPercentage,"%"),V(),ie("ngClass",Ky(23,YB,i.product.stock===0)),V(),le(" Stock: ",i.product.stock>0?i.product.stock+" Available":"Out of stock"," "),V(),ie("disabled",i.product.stock===0),V(8),le(" ",i.product.brand,""),V(4),ie("ngForOf",i.product.tags),V(4),Hy(" ",i.product.dimensions.width," cm (W) x ",i.product.dimensions.height," cm (H) x ",i.product.dimensions.depth," cm (D)"),V(4),le(" ",i.product.weight," Kg"),V(4),le(" ",i.product.returnPolicy,""),V(2),We(i.product.description),V(7),ie("ngForOf",i.reviews),V(),ie("ngIf",!i.product.reviews||i.product.reviews.length===0))},dependencies:[$a,fr,St],styles:[".product-detail[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;max-width:1200px;margin:0 auto;padding:20px;font-family:Arial,sans-serif;color:#000}.product-main[_ngcontent-%COMP%], .product-details[_ngcontent-%COMP%]{flex:1 1 48%;margin:10px}.product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:8px;box-shadow:0 4px 8px #0003}.product-info[_ngcontent-%COMP%]{padding:15px;border-radius:8px;background-color:#fff;box-shadow:0 4px 8px #0000001a}.product-title[_ngcontent-%COMP%]{font-size:1.8em;color:#000;margin-bottom:5px}.product-sku[_ngcontent-%COMP%], .product-category[_ngcontent-%COMP%], .product-price[_ngcontent-%COMP%], .product-discount[_ngcontent-%COMP%], .product-stock[_ngcontent-%COMP%], .product-description[_ngcontent-%COMP%]{margin:8px 0;font-size:1em}.text-navy[_ngcontent-%COMP%]{color:#000}.rating[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#b9ff2d}.rating[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.product-stock[_ngcontent-%COMP%]{font-weight:700;font-size:1.1em}.out-of-stock[_ngcontent-%COMP%]{color:#ff1900}.product-details[_ngcontent-%COMP%]{background-color:#fff;padding:15px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.product-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6em;color:#000;border-bottom:2px solid #000000;padding-bottom:5px;margin-bottom:15px}.product-tag[_ngcontent-%COMP%]{background-color:transparent;color:#fff;padding:5px 10px;margin-right:5px;border-radius:12px;font-size:.9em}.btn-add-to-cart[_ngcontent-%COMP%]{background-color:#000;color:#fff;padding:12px 20px;border:none;border-radius:10px;font-size:1em;cursor:pointer;transition:background-color .3s ease;display:inline-block}.btn-add-to-cart[_ngcontent-%COMP%]:disabled{background-color:#fff;cursor:not-allowed}.btn-add-to-cart[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#fffc53}.product-reviews[_ngcontent-%COMP%]{margin-top:20px}.product-reviews[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6em;color:#000;border-bottom:2px solid #ffffff;padding-bottom:5px;margin-bottom:15px}.review-item[_ngcontent-%COMP%]{background-color:transparent;padding:10px;border-radius:5px;margin-bottom:10px}.review-text[_ngcontent-%COMP%]{margin:5px 0}.no-reviews[_ngcontent-%COMP%]{color:transparent;font-style:italic;font-size:.9em}.comment[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;padding:10px}.comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.comment-author[_ngcontent-%COMP%]{font-weight:700}.comment-date[_ngcontent-%COMP%]{color:#888;font-size:.8em}.comment-body[_ngcontent-%COMP%]{margin-bottom:10px}.comment-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.comment-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:5px;padding:5px 10px;border:none;background-color:#f0f0f0;border-radius:3px;cursor:pointer}"]})}return n})();var OT=(()=>{class n{authService=Ne(Et);userName;userEmail;ngOnInit(){this.userName=this.authService.currentUserSig()?.username,this.userEmail=this.authService.currentUserSig()?.email}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-account"]],standalone:!0,features:[_e],decls:8,vars:2,consts:[[1,"account-container"],[1,"profile-photo"],["src","anonyme.png","alt","Profile Photo"],[1,"account-details"],[1,"name"],[1,"email"]],template:function(r,i){r&1&&(b(0,"div",0)(1,"div",1),j(2,"img",2),E(),b(3,"div",3)(4,"h2",4),w(5),E(),b(6,"p",5),w(7),E()()()),r&2&&(V(5),le("Nom Complet : ",i.userName,""),V(2),le("Email : ",i.userEmail,""))},styles:[".account-container[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;background-color:#f9f9f9;border-radius:8px;box-shadow:0 4px 8px #0000001a;max-width:400px;margin:0 auto}.profile-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;object-fit:cover;margin-right:16px}.account-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.name[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700;margin:0}.email[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin:4px 0 0}"]})}return n})();var MT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=ve({type:n,selectors:[["app-future"]],standalone:!0,features:[_e],decls:2,vars:0,template:function(r,i){r&1&&(b(0,"h4"),w(1,"not implemented yet"),E())}})}return n})();var Iy=[{path:"",component:RT},{path:"products",component:AT},{path:"panier",component:IT},{path:"signup",component:DT},{path:"signin",component:xT},{path:"orders",component:bT,canActivate:[Ay]},{path:"product/:id",component:kT},{path:"***",component:wT},{path:"account",component:OT,canActivate:[Ay]},{path:"future",component:MT}];var n3=new Map,r3={activated:!1,tokenObservers:[]},i3={initialized:!1,enabled:!1};function gn(n){return n3.get(n)||Object.assign({},r3)}function VT(){return i3}var s3="https://content-firebaseappcheck.googleapis.com/v1";var o3="exchangeDebugToken",PT={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},RG=24*60*60*1e3;var xy=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return R(this,null,function*(){this.stop();try{this.pending=new vd,this.pending.promise.catch(t=>{}),yield a3(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new vd,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function a3(n){return new Promise(e=>{setTimeout(e,n)})}var l3={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ti=new uv("appCheck","AppCheck",l3);function BT(n){if(!gn(n).activated)throw ti.create("use-before-activation",{appName:n.name})}function UT(r,i){return R(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let C=yield o.getHeartbeatsHeader();C&&(s["X-Firebase-Client"]=C)}let a={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,a)}catch(C){throw ti.create("fetch-network-error",{originalErrorMessage:C?.message})}if(l.status!==200)throw ti.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(C){throw ti.create("fetch-parse-error",{originalErrorMessage:C?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw ti.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let p=Number(u[1])*1e3,g=Date.now();return{token:c.token,expireTimeMillis:g+p,issuedAtTimeMillis:g}})}function qT(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${s3}/projects/${t}/apps/${r}:${o3}?key=${i}`,body:{debug_token:e}}}var c3="firebase-app-check-database",u3=1,Ry="firebase-app-check-store";var ed=null;function d3(){return ed||(ed=new Promise((n,e)=>{try{let t=indexedDB.open(c3,u3);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(ti.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ry,{keyPath:"compositeKey"})}}}catch(t){e(ti.create("storage-open",{originalErrorMessage:t?.message}))}}),ed)}function h3(n,e){return f3(p3(n),e)}function f3(n,e){return R(this,null,function*(){let r=(yield d3()).transaction(Ry,"readwrite"),s=r.objectStore(Ry).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},r.onerror=l=>{var c;a(ti.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function p3(n){return`${n.options.appId}-${n.name}`}var ky=new Wa("@firebase/app-check");function Dy(n,e){return _d()?h3(n,e).catch(t=>{ky.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function zT(){return VT().enabled}function jT(){return R(this,null,function*(){let n=VT();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var m3={error:"UNKNOWN_ERROR"};function g3(n){return ov.encodeString(JSON.stringify(n),!1)}function Oy(n,e=!1){return R(this,null,function*(){let t=n.app;BT(t);let r=gn(t),i=r.token,s;if(i&&!Va(i)&&(r.token=void 0,i=void 0),!i){let l=yield r.cachedTokenPromise;l&&(Va(l)?i=l:yield Dy(t,void 0))}if(!e&&i&&Va(i))return{token:i.token};let o=!1;if(zT()){r.exchangeTokenPromise||(r.exchangeTokenPromise=UT(qT(t,yield jT()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let l=yield r.exchangeTokenPromise;return yield Dy(t,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield gn(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?ky.warn(l.message):ky.error(l),s=l}let a;return i?s?Va(i)?a={token:i.token,internalError:s}:a=FT(s):(a={token:i.token},r.token=i,yield Dy(t,i)):a=FT(s),o&&C3(t,a),a})}function y3(n){return R(this,null,function*(){let e=n.app;BT(e);let{provider:t}=gn(e);if(zT()){let r=yield jT(),{token:i}=yield UT(qT(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function v3(n,e,t,r){let{app:i}=n,s=gn(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Va(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),NT(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>NT(n))}function GT(n,e){let t=gn(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function NT(n){let{app:e}=n,t=gn(e),r=t.tokenRefresher;r||(r=_3(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function _3(n){let{app:e}=n;return new xy(()=>R(this,null,function*(){let t=gn(e),r;if(t.token?r=yield Oy(n,!0):r=yield Oy(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=gn(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},PT.RETRIAL_MIN_WAIT,PT.RETRIAL_MAX_WAIT)}function C3(n,e){let t=gn(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Va(n){return n.expireTimeMillis-Date.now()>0}function FT(n){return{token:g3(m3),error:n}}var My=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=gn(this.app);for(let t of e)GT(this.app,t.next);return Promise.resolve()}};function S3(n,e){return new My(n,e)}function b3(n){return{getToken:e=>Oy(n,e),getLimitedUseToken:()=>y3(n),addTokenListener:e=>v3(n,"INTERNAL",e),removeTokenListener:e=>GT(n.app,e)}}var E3="@firebase/app-check",w3="0.8.8";var T3="app-check",LT="app-check-internal";function A3(){yo(new go(T3,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return S3(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(LT).initialize()})),yo(new go(LT,n=>{let e=n.getProvider("app-check").getImmediate();return b3(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),He(E3,w3)}A3();var I3=["localhost","0.0.0.0","127.0.0.1"],zG=typeof window<"u"&&I3.includes(window.location.hostname);var x3="firebase",R3="10.14.1";tn.registerVersion(x3,R3,"app-compat");var k3=["ngOnDestroy"],WT=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(k3.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let l=a?.[s];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>t.run(()=>c)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,c)=>o.then(u=>{let p=u?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,p),p})})})});var td=class{constructor(e){return e}},nd=new Oe("angularfire2.app.options"),rd=new Oe("angularfire2.app.name");function Py(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=tn.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>tn.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;O3("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new td(o)}var O3=(n,...e)=>{fd()&&typeof console<"u"&&console[n](...e)},M3={provide:td,useFactory:Py,deps:[nd,Zt,[new Vt,rd]]},Ny=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:nd,useValue:t},{provide:rd,useValue:r}]}}constructor(t){tn.registerVersion("angularfire",bt.full,"core"),tn.registerVersion("angularfire",bt.full,"app-compat"),tn.registerVersion("angular",po.full,t.toString())}static \u0275fac=function(r){return new(r||n)(Se(si))};static \u0275mod=Bt({type:n});static \u0275inj=Lt({providers:[M3]})}return n})();function HT(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return P3(i,o)||($T("error",`${e} was already initialized on the ${t} Firebase App with different settings.${N3?" You may need to reload as Firebase is not HMR aware.":""}`),$T("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function P3(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var N3=typeof module<"u"&&!!module.hot,$T=(n,...e)=>{fd()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var F3=new Oe("angularfire2.auth.use-emulator"),L3=new Oe("angularfire2.auth.settings"),V3=new Oe("angularfire2.auth.tenant-id"),B3=new Oe("angularfire2.auth.langugage-code"),U3=new Oe("angularfire2.auth.use-device-language"),q3=new Oe("angularfire.auth.persistence"),z3=(n,e,t,r,i,s,o,a)=>HT(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),r&&(l.tenantId=r),l.languageCode=i,s&&l.useDeviceLanguage(),o)for(let[c,u]of Object.entries(o))l.settings[c]=u;return a&&l.setPersistence(a),l},[t,r,i,s,o,a]),Fy=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,l,c,u,p,g,C){let A=new Ua,I=$n(void 0).pipe(ur(o.outsideAngular),Jt(()=>s.runOutsideAngular(()=>import("./chunk-F4YATEO2.mjs"))),Wn(()=>Py(t,s,r)),Wn(T=>z3(T,s,a,c,u,p,l,g)),ld({bufferSize:1,refCount:!1}));if(ev(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=$n(null);else{I.pipe(Gy()).subscribe();let T=I.pipe(Jt(N=>N.getRedirectResult().then(F=>F,()=>null)),Vd,ld({bufferSize:1,refCount:!1})),P=I.pipe(Jt(N=>new yn(F=>({unsubscribe:s.runOutsideAngular(()=>N.onAuthStateChanged($=>F.next($),$=>F.error($),()=>F.complete()))})))),x=I.pipe(Jt(N=>new yn(F=>({unsubscribe:s.runOutsideAngular(()=>N.onIdTokenChanged($=>F.next($),$=>F.error($),()=>F.complete()))}))));this.authState=T.pipe(cd(P),ri(o.outsideAngular),ur(o.insideAngular)),this.user=T.pipe(cd(x),ri(o.outsideAngular),ur(o.insideAngular)),this.idToken=this.user.pipe(Jt(N=>N?Rt(N.getIdToken()):$n(null))),this.idTokenResult=this.user.pipe(Jt(N=>N?Rt(N.getIdTokenResult()):$n(null))),this.credential=qy(T,A,this.authState.pipe(ad(N=>!N))).pipe(Wn(N=>N?.user?N:null),ri(o.outsideAngular),ur(o.insideAngular))}return WT(this,I,s,{spy:{apply:(T,P,x)=>{(T.startsWith("signIn")||T.startsWith("createUser"))&&x.then(N=>A.next(N))}}})}static \u0275fac=function(r){return new(r||n)(Se(nd),Se(rd,8),Se(si),Se(Zt),Se(di),Se(F3,8),Se(L3,8),Se(V3,8),Se(B3,8),Se(U3,8),Se(q3,8),Se(vr,8))};static \u0275prov=st({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Ly=(()=>{class n{constructor(){tn.registerVersion("angularfire",bt.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Bt({type:n});static \u0275inj=Lt({providers:[Fy]})}return n})();var id={apiKey:"AIzaSyBRSAjljFn3J_Lpk_CD10_a3tb2tYz4kQw",authDomain:"shopforemi.firebaseapp.com",projectId:"shopforemi",storageBucket:"shopforemi.firebasestorage.app",messagingSenderId:"181782064973",appId:"1:181782064973:web:0193f057d46b9b38a99104",measurementId:"G-YFRW93XMFZ"};oo(Ny.initializeApp(id));oo(Fy);oo(Ly);var KT={providers:[Yy({eventCoalescing:!0}),nv(),yd(Iy),gd(),Ud(()=>qd(id)),r0(()=>o0()),yd(Iy),io,Ud(()=>qd(id)),gd(),oo(Ny.initializeApp(id),Ly,pT,Jv)]};var j3={providers:[rv()]},QT=Jy(KT,j3);var G3=()=>tv(ET,QT),N5=G3;export{N5 as a};
